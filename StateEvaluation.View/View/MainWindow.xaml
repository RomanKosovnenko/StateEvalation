<Window x:Class="StateEvaluation.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:helpers="clr-namespace:StateEvaluation.View.Helpers"
        xmlns:biocolorhelpers="clr-namespace:StateEvaluation.BioColor.Helpers;assembly=StateEvaluation.Biocolor"
        xmlns:p="clr-namespace:StateEvaluation.Properties"
        xmlns:repository="clr-namespace:StateEvaluation.Repository.Providers;assembly=StateEvaluation.Repository"
        xmlns:sys="clr-namespace:System;assembly=mscorlib"
        xmlns:viewModel="clr-namespace:StateEvaluation.Common.ViewModel;assembly=StateEvaluation.Common"
        xmlns:comment="Tag to add comments"
        mc:Ignorable="d comment"
        ContentRendered="WindowRendered_Click"
        Title="Оценка состояния" Height="768" Width="1366" WindowState="Maximized">
    <Window.Resources>
        <ObjectDataProvider x:Key="GetPeople" ObjectType="{x:Type repository:DataRepository}" MethodName="GetPeople"></ObjectDataProvider>
        <ObjectDataProvider x:Key="GetPreferences" ObjectType="{x:Type repository:DataRepository}" MethodName="GetPreferenceTests"></ObjectDataProvider>
        <ObjectDataProvider x:Key="GetFeelings" ObjectType="{x:Type repository:DataRepository}" MethodName="GetSubjecriveFeelings"></ObjectDataProvider>
        <ObjectDataProvider x:Key="GetCodesForInsert" ObjectType="{x:Type repository:DataRepository}" MethodName="GetUserIds"></ObjectDataProvider>
        <ObjectDataProvider x:Key="GetCodesForFilter" ObjectType="{x:Type repository:DataRepository}" MethodName="GetUserIdsFilter"></ObjectDataProvider>
        <ObjectDataProvider x:Key="GetPreferencesList" ObjectType="{x:Type repository:DataRepository}" MethodName="PreferencesFilters"></ObjectDataProvider>
        <ObjectDataProvider x:Key="GetProfessionsList" ObjectType="{x:Type repository:DataRepository}" MethodName="GetProfessionsFilter"></ObjectDataProvider>


        <!--here defined resourses' name for exact model-->
        <viewModel:PeopleFilterVM x:Key="peopleFilterVM" />
        <viewModel:SubjectiveFeelingVM x:Key="subjectiveFeelingVM" />
        <viewModel:PeopleVM x:Key="peopleVM" />
        <viewModel:PreferenceVM x:Key="preferenceVM" />
        <viewModel:PreferenceFilterVM x:Key="preferenceFilterVM"/>
        <viewModel:SubjectiveFeelingFilterVM x:Key="subjectiveFeelingFilterVM"/>
        <!---->

        <ObjectDataProvider x:Key="GetPeopleCodes" ObjectType="{x:Type repository:DataRepository}" MethodName="GetPeopleNumbersFilter"></ObjectDataProvider>
        <ObjectDataProvider x:Key="GetExpeditionCodes" ObjectType="{x:Type repository:DataRepository}" MethodName="GetExpeditionCodesFilter"></ObjectDataProvider>
        <ObjectDataProvider x:Key="GetShortColorsNumbersList" ObjectType="{x:Type repository:DataRepository}" MethodName="GetShortColorsNumbersFilters"></ObjectDataProvider>
        <ObjectDataProvider x:Key="GetColorsNumbersList" ObjectType="{x:Type repository:DataRepository}" MethodName="GetColorsNumbersFilters"></ObjectDataProvider>
        <BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter"/>
        <helpers:StringToListConverter x:Key="StringToListConverter" />
        <biocolorhelpers:NameToBrushConverter x:Key="NameToBrushConverter" />
        <helpers:NameToImageConverter x:Key="NameToImageConverter" />
        <helpers:DateToSin x:Key="DateToSin" />
        <helpers:BooleanToChecker x:Key="BooleanToChecker" />
        <helpers:NumberToRelax1Converter x:Key="NumberToRelax1Converter" />
        <helpers:NumberToRelax2Converter x:Key="NumberToRelax2Converter" />
        <biocolorhelpers:NameToMultiBrushConverter x:Key="NameToMultiBrushConverter" />
        <helpers:PreferenceSameAsRelax x:Key="PreferenceSameAsRelax" />
        <helpers:PreferenceToBrushConverter x:Key="PreferenceToBrushConverter" />
        <helpers:ButtonToVisibilityConverter x:Key="ButtonToVisibilityConverter" />
        <helpers:BooleanToNOTVisibilityConverter x:Key="BooleanToNOTVisibilityConverter" />
        <helpers:TextColorNumberToBrushConverter x:Key="TextColorNumberToBrushConverter"/>
    </Window.Resources>
    
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="115"/>
            <RowDefinition/>
        </Grid.RowDefinitions>
        <TabControl x:Name="tabControl" Height="150" VerticalAlignment="Top">
            <!--<TabItem Header="{x:Static p:Resources.AddDataHeader}">
                <Grid Background="#FFE5E5E5"/>
            </TabItem>-->
            <TabItem x:Name="tabItem" IsSelected="True" DataContext="{StaticResource peopleVM}" Header="Люди" Margin="-2,-2,-2,0">
                <Grid x:Name="PersonAddFormGrid" Background="#FFE5E5E5" Margin="0,0,0,0">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="119"/>
                    </Grid.RowDefinitions>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition/>
                    </Grid.ColumnDefinitions>
                    
                    <Label Content="Имя" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Margin="10,11,0,82" HorizontalAlignment="Left" Width="193"/>
                    <Label Content="Фамилия" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Margin="186,11,0,82" HorizontalAlignment="Left" Width="193"/>
                    <Label Content="Отчество" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Margin="367,4,0,82" HorizontalAlignment="Left" Width="193"/>
                    <Label Content="День рождения" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Margin="537,11,0,82" HorizontalAlignment="Left" Width="193"/>
                    <Label Content="Профессия" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Margin="719,11,0,82" HorizontalAlignment="Left" Width="193"/>
                    <Label Content="Експедиция" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Margin="916,11,0,0" HorizontalAlignment="Left" Width="75" Height="26" VerticalAlignment="Top"/>
                    <Label Content="Номер" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Margin="996,11,0,0" HorizontalAlignment="Left" Width="77" Height="26" VerticalAlignment="Top"/>
                    <TextBox Text="{Binding Id}" Visibility="Hidden" Margin="0,0,0,0"/>
                    <TextBox Text="{Binding FirstName}" TextWrapping="Wrap" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Margin="33,42,0,52" HorizontalAlignment="Left" Width="150"/>
                    <TextBox Text="{Binding LastName}" TextWrapping="Wrap" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Margin="197,42,0,52" HorizontalAlignment="Left" Width="170"/>
                    <TextBox Text="{Binding MiddleName}" TextWrapping="Wrap" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Margin="381,42,0,52" HorizontalAlignment="Left" Width="167"/>
                    <DatePicker SelectedDate="{Binding Birthday}" Margin="563,42,0,52" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" HorizontalAlignment="Left" Width="149"/>
                    <TextBox Text="{Binding Workposition}" TextWrapping="Wrap" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Margin="730,42,0,52" HorizontalAlignment="Left" Width="165"/>
                    <TextBox Text="{Binding Expedition}" TextWrapping="Wrap" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Margin="921,42,0,52" HorizontalAlignment="Left" Width="60"/>
                    <TextBox Text="{Binding PersonNumber}" TextWrapping="Wrap" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Margin="1008,42,0,52" HorizontalAlignment="Left" Width="59"/>
                    <Button x:Name="AddPersonBtn" Content="Добавить" Margin="1086,22,0,76" Click="CreatePerson_Click" HorizontalAlignment="Left" Width="105"/>
                    <Button x:Name="UpdatePersonBtn" Content="Сохранить" Margin="1209,33,0,65" Click="UpdatePerson_Click" Visibility="Hidden" HorizontalAlignment="Left" Width="105" />
                    <Button Content="Сброс" Margin="1086,48,0,50" Visibility="Visible" HorizontalAlignment="Left" Click="ClearInputs_Click" Width="105" Height="21" />
                </Grid>
            </TabItem>
            <TabItem x:Name="tabItem1" DataContext="{StaticResource preferenceVM}" Header="Преференции">
                <Grid Background="#FFE5E5E5" Margin="0,0,0,32">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="62" />
                        <ColumnDefinition Width="205"/>
                        <ColumnDefinition Width="0" />
                        <ColumnDefinition Width="auto" MinWidth="45" />
                        <ColumnDefinition Width="5" />
                        <ColumnDefinition Width="auto" />
                        <ColumnDefinition Width="5" />
                        <ColumnDefinition Width="auto" />
                        <ColumnDefinition Width="5" />
                        <ColumnDefinition Width="auto" />
                        <ColumnDefinition Width="5" />
                        <ColumnDefinition Width="auto" />
                        <ColumnDefinition Width="5" />
                        <ColumnDefinition Width="auto" />
                        <ColumnDefinition Width="5" />
                        <ColumnDefinition Width="auto" />
                        <ColumnDefinition Width="5" />
                        <ColumnDefinition Width="auto" />
                        <ColumnDefinition Width="5" />
                        <ColumnDefinition Width="auto" />
                        <ColumnDefinition Width="5" />
                        <ColumnDefinition Width="auto" />
                        <ColumnDefinition Width="5" />
                        <ColumnDefinition Width="auto" />
                        <ColumnDefinition Width="5" />
                        <ColumnDefinition Width="auto" />
                        <ColumnDefinition Width="5" />
                        <ColumnDefinition Width="auto" />
                        <ColumnDefinition Width="5" />
                        <ColumnDefinition Width="auto" />
                        <ColumnDefinition Width="5" />
                        <ColumnDefinition Width="auto" />
                        <ColumnDefinition Width="5" />
                        <ColumnDefinition Width="auto" />
                        <ColumnDefinition Width="5" />
                        <ColumnDefinition Width="400" />
                    </Grid.ColumnDefinitions>

                    <Grid.RowDefinitions>
                        <RowDefinition Height="73" />
                    </Grid.RowDefinitions>
                    <TextBlock
                                   Grid.Column="0"
                                   HorizontalAlignment="Center"
                                   Text="Код" Margin="28,7,0,48" Width="34" RenderTransformOrigin="-1.5,0.474" />
                    <TextBlock
                                   HorizontalAlignment="Center"
                                   Text="Дата" Margin="59,7,118,48" Width="28" RenderTransformOrigin="0.571,1.947" Grid.Column="1" />
                    <TextBlock
                                   Grid.Column="2"
                                   HorizontalAlignment="Center"
                                   Text="1" Margin="20,1,19,54" Width="6" Grid.ColumnSpan="2" />
                    <TextBlock
                                   Grid.Column="5"
                                   HorizontalAlignment="Center"
                                   Text="2" Margin="17,1,17,54" Width="6" />
                    <TextBlock
                                   Grid.Column="7"
                                   HorizontalAlignment="Center"
                                   Text="3" Margin="17,1,17,54" Width="6" />
                    <TextBlock
                                   Grid.Column="11"
                                   HorizontalAlignment="Center"
                                   Text="1" Margin="17,1,17,54" Width="6" />
                    <TextBlock
                                   Grid.Column="13"
                                   HorizontalAlignment="Center"
                                   Text="2" Margin="17,1,17,54" Width="6" />
                    <TextBlock
                                   Grid.Column="15"
                                   HorizontalAlignment="Center"
                                   Text="3" Margin="17,1,17,54" Width="6" />
                    <TextBlock
                                   Grid.Column="17"
                                   HorizontalAlignment="Center"
                                   Text="4" Margin="17,1,17,54" Width="6" />
                    <TextBlock
                                   Grid.Column="19"
                                   HorizontalAlignment="Center"
                                   Text="5" Margin="17,1,17,54" Width="6" />
                    <TextBlock
                                   Grid.Column="21"
                                   HorizontalAlignment="Center"
                                   Text="6" Margin="17,1,17,54" Width="6" />
                    <TextBlock
                                   Grid.Column="23"
                                   HorizontalAlignment="Center"
                                   Text="7" Margin="17,1,17,54" Width="6" />
                    <TextBlock
                                   Grid.Column="25"
                                   HorizontalAlignment="Center"
                                   Text="8" Margin="17,1,17,54" Width="6" />
                    <TextBlock
                                   Grid.Column="27"
                                   HorizontalAlignment="Center"
                                   Text="9" Margin="17,1,17,54" Width="6" />
                    <TextBlock
                                   Grid.Column="29"
                                   HorizontalAlignment="Center"
                                   Text="10" Margin="14,1,14,54" Width="12" />
                    <TextBlock
                                   Grid.Column="31"
                                   HorizontalAlignment="Center"
                                   Text="11" Margin="13,1,13,54" Width="14" />
                    <TextBlock
                                   Grid.Column="33"
                                   HorizontalAlignment="Center"
                                   Text="12" Margin="14,1,14,54" Width="12" />
                    <TextBlock
                                   Grid.Column="35"
                                   HorizontalAlignment="Center"
                                   Text="Красная" Width="45" Margin="13,1,342,54" />
                    <TextBlock
                                   Grid.Column="35"
                                   HorizontalAlignment="Center"
                                   Text="Желтая" Width="40" Margin="63,1,297,54" />
                    <TextBlock
                                   Grid.Column="35"
                                   HorizontalAlignment="Center"
                                   Text="Синяя" Width="33" Margin="108,1,259,54" />
                    <TextBlock
                                   Grid.Column="35"
                                   HorizontalAlignment="Center"
                                   Text="Смешанная" Width="64" Margin="146,1,190,54" />
                    <TextBlock
                                   Grid.Column="35"
                                   HorizontalAlignment="Center"
                                   Text="Релакс" Margin="221,1,135,54" Width="44" />

                    <ComboBox x:Name="UserIdsInsertPreferenceCB"
                                  Grid.Column="0"
                                  Width="75"
                                  HorizontalAlignment="Left"
                                  VerticalAlignment="Top"
                                  ItemsSource="{Binding Source={StaticResource GetCodesForInsert}}"
                                  SelectedValue="{Binding UserId}" Height="22" Margin="5,29,0,0" Grid.ColumnSpan="2" />
                    <DatePicker x:Name="dateTimeForTest"
                                    VerticalAlignment="Top"
                                    SelectedDate="{Binding TestDate}" Height="24" HorizontalAlignment="Left" Width="100" Margin="28,29,0,0" Grid.Column="1" />
                    <TextBlock x:Name="TestID"
                                    VerticalAlignment="Top"
                                   Text="{Binding Id}"
                                    Height="24" HorizontalAlignment="Left" Width="100"
                                   Visibility="Hidden" Margin="23,46,0,0" Grid.Column="1"/>
                    <!-- Bio1 - 3 -->
                    <ComboBox x:Name="selectorC1in3"
                                  Grid.Column="2"
                                  SelectedValue="{Binding Color1in3}"
                                  ItemsSource="{Binding Source={StaticResource GetShortColorsNumbersList}}" Margin="0,18,0,29" Grid.ColumnSpan="2"
                                  />
                    <ComboBox x:Name="selectorC2in3"
                                  Grid.Column="5"
                                  SelectedValue="{Binding Color2in3}"
                                  ItemsSource="{Binding Source={StaticResource GetShortColorsNumbersList}}" Margin="0,18,0,29"
                                  />
                    <ComboBox x:Name="selectorC3in3"
                                  Grid.Column="7"
                                  SelectedValue="{Binding Color3in3}"
                                  ItemsSource="{Binding Source={StaticResource GetShortColorsNumbersList}}" Margin="0,18,0,29"
                                />

                    <!-- Bio1 - 12 -->
                    <ComboBox x:Name="selectorC1in12"
                                  Grid.Column="11"
                                  ItemsSource="{Binding Source={StaticResource GetColorsNumbersList}}"
                                  SelectedValue="{Binding Color1in12}" Margin="0,18,0,29" />
                    <ComboBox x:Name="selectorC2in12"
                                  Grid.Column="13"
                                  ItemsSource="{Binding Source={StaticResource GetColorsNumbersList}}"
                                  SelectedValue="{Binding Color2in12}" Margin="0,18,0,29" />
                    <ComboBox x:Name="selectorC3in12"
                                  Grid.Column="15"
                                  ItemsSource="{Binding Source={StaticResource GetColorsNumbersList}}"
                                  SelectedValue="{Binding Color3in12}" Margin="0,18,0,29" />
                    <ComboBox x:Name="selectorC4in12"
                                  Grid.Column="17"
                                  ItemsSource="{Binding Source={StaticResource GetColorsNumbersList}}"
                                  SelectedValue="{Binding Color4in12}" Margin="0,18,0,29" />
                    <ComboBox x:Name="selectorC5in12"
                                  Grid.Column="19"
                                  ItemsSource="{Binding Source={StaticResource GetColorsNumbersList}}"
                                  SelectedValue="{Binding Color5in12}" Margin="0,18,0,29" />
                    <ComboBox x:Name="selectorC6in12"
                                  Grid.Column="21"
                                  ItemsSource="{Binding Source={StaticResource GetColorsNumbersList}}"
                                  SelectedValue="{Binding Color6in12}" Margin="0,18,0,29" />
                    <ComboBox x:Name="selectorC7in12"
                                  Grid.Column="23"
                                  ItemsSource="{Binding Source={StaticResource GetColorsNumbersList}}"
                                  SelectedValue="{Binding Color7in12}" Margin="0,18,0,29" />
                    <ComboBox x:Name="selectorC8in12"
                                  Grid.Column="25"
                                  ItemsSource="{Binding Source={StaticResource GetColorsNumbersList}}"
                                  SelectedValue="{Binding Color8in12}" Margin="0,18,0,29" />
                    <ComboBox x:Name="selectorC9in12"
                                  Grid.Column="27"
                                  ItemsSource="{Binding Source={StaticResource GetColorsNumbersList}}"
                                  SelectedValue="{Binding Color9in12}" Margin="0,18,0,29" />
                    <ComboBox x:Name="selectorC10in12"
                                  Grid.Column="29"
                                  ItemsSource="{Binding Source={StaticResource GetColorsNumbersList}}"
                                  SelectedValue="{Binding Color10in12}" Margin="0,18,0,29" />
                    <ComboBox x:Name="selectorC11in12"
                                  Grid.Column="31"
                                  ItemsSource="{Binding Source={StaticResource GetColorsNumbersList}}"
                                  SelectedValue="{Binding Color11in12}" Margin="0,18,0,29" />
                    <ComboBox x:Name="selectorC12in12"
                                  Grid.Column="33"
                                  ItemsSource="{Binding Source={StaticResource GetColorsNumbersList}}"
                                  SelectedValue="{Binding Color12in12}" Margin="0,18,0,29"/>
                    <!-- Bio1 - Pref -->
                    <RadioButton x:Name="RedStat"
                                 Grid.Column="35"
                                 GroupName="Pref1" Margin="21,22,349,19"
                                 IsChecked="{Binding Preference1Red}"/>
                    <RadioButton x:Name="YellowStat"
                                 Grid.Column="35"
                                 GroupName="Pref1" Margin="69,22,301,19" 
                                 IsChecked="{Binding Preference1Yellow}"/>
                    <RadioButton x:Name="BlueStat"
                                 Grid.Column="35"
                                 GroupName="Pref1" Margin="111,22,259,19" 
                                 IsChecked="{Binding Preference1Blue}"/>
                    <RadioButton x:Name="GrayStat"
                                 Grid.Column="35"
                                 GroupName="Pref1" Margin="164,22,206,19"
                                 IsChecked="{Binding Preference1Grey}"/>
                    <!-- Bio1 - R -->
                    <ComboBox x:Name="selectorRelax1"
                                  Grid.Column="35"
                                  ItemsSource="{Binding Source={StaticResource GetColorsNumbersList}}"
                                  SelectedValue="{Binding ColorRelax1}" Margin="220,18,140,29"/>

                    <!-- Bio2 - 3 -->
                    <ComboBox x:Name="selectorC21in3"
                                  Grid.Column="2"
                                  SelectedValue="{Binding Color21in3}"
                                  ItemsSource="{Binding Source={StaticResource GetShortColorsNumbersList}}" Margin="0,46,0,0" Grid.ColumnSpan="2"
                                  />
                    <ComboBox x:Name="selectorC22in3"
                                  Grid.Column="5"
                                  SelectedValue="{Binding Color22in3}"
                                  ItemsSource="{Binding Source={StaticResource GetShortColorsNumbersList}}" Margin="0,46,0,0"
                                  />
                    <ComboBox x:Name="selectorC23in3"
                                  Grid.Column="7"
                                  SelectedValue="{Binding Color23in3}"
                                  ItemsSource="{Binding Source={StaticResource GetShortColorsNumbersList}}" Margin="0,46,0,0"
                                />

                    <!-- Bio2 - 12 -->
                    <ComboBox x:Name="selectorC21in12"
                                  Grid.Column="11"
                                  ItemsSource="{Binding Source={StaticResource GetColorsNumbersList}}"
                                  SelectedValue="{Binding Color21in12}" Margin="0,46,0,0" />
                    <ComboBox x:Name="selectorC22in12"
                                  Grid.Column="13"
                                  ItemsSource="{Binding Source={StaticResource GetColorsNumbersList}}"
                                  SelectedValue="{Binding Color22in12}" Margin="0,46,0,0" />
                    <ComboBox x:Name="selectorC23in12"
                                  Grid.Column="15"
                                  ItemsSource="{Binding Source={StaticResource GetColorsNumbersList}}"
                                  SelectedValue="{Binding Color23in12}" Margin="0,46,0,0" />
                    <ComboBox x:Name="selectorC24in12"
                                  Grid.Column="17"
                                  ItemsSource="{Binding Source={StaticResource GetColorsNumbersList}}"
                                  SelectedValue="{Binding Color24in12}" Margin="0,46,0,0" />
                    <ComboBox x:Name="selectorC25in12"
                                  Grid.Column="19"
                                  ItemsSource="{Binding Source={StaticResource GetColorsNumbersList}}"
                                  SelectedValue="{Binding Color25in12}" Margin="0,46,0,0" />
                    <ComboBox x:Name="selectorC26in12"
                                  Grid.Column="21"
                                  ItemsSource="{Binding Source={StaticResource GetColorsNumbersList}}"
                                  SelectedValue="{Binding Color26in12}" Margin="0,46,0,0" />
                    <ComboBox x:Name="selectorC27in12"
                                  Grid.Column="23"
                                  ItemsSource="{Binding Source={StaticResource GetColorsNumbersList}}"
                                  SelectedValue="{Binding Color27in12}" Margin="0,46,0,0" />
                    <ComboBox x:Name="selectorC28in12"
                                  Grid.Column="25"
                                  ItemsSource="{Binding Source={StaticResource GetColorsNumbersList}}"
                                  SelectedValue="{Binding Color28in12}" Margin="0,46,0,0" />
                    <ComboBox x:Name="selectorC29in12"
                                  Grid.Column="27"
                                  ItemsSource="{Binding Source={StaticResource GetColorsNumbersList}}"
                                  SelectedValue="{Binding Color29in12}" Margin="0,46,0,0" />
                    <ComboBox x:Name="selectorC210in12"
                                  Grid.Column="29"
                                  ItemsSource="{Binding Source={StaticResource GetColorsNumbersList}}"
                                  SelectedValue="{Binding Color210in12}" Margin="0,46,0,0" />
                    <ComboBox x:Name="selectorC211in12"
                                  Grid.Column="31"
                                  ItemsSource="{Binding Source={StaticResource GetColorsNumbersList}}"
                                  SelectedValue="{Binding Color211in12}" Margin="0,46,0,0" />
                    <ComboBox x:Name="selectorC212in12"
                                  Grid.Column="33"
                                  ItemsSource="{Binding Source={StaticResource GetColorsNumbersList}}"
                                  SelectedValue="{Binding Color212in12}" Margin="0,46,0,0" />
                    <!-- Bio2 - Pref -->
                    <RadioButton x:Name="Red2Stat"
                                 Grid.Column="35"
                                 GroupName="Pref2" Margin="21,50,349,-4"
                                 IsChecked="{Binding Preference2Red}"/>
                    <RadioButton x:Name="Yellow2Stat"
                                 Grid.Column="35"
                                 GroupName="Pref2" Margin="69,50,301,-4"
                                 IsChecked="{Binding Preference2Yellow}"/>
                    <RadioButton x:Name="Blue2Stat"
                                 Grid.Column="35"
                                 GroupName="Pref2" Margin="111,50,259,-4" 
                                 IsChecked="{Binding Preference2Blue}"/>
                    <RadioButton x:Name="Gray2Stat"
                                 Grid.Column="35"
                                 GroupName="Pref2" Margin="164,50,206,-4"
                                 IsChecked="{Binding Preference2Grey}"/>
                    <!-- Bio2 - R -->
                    <ComboBox x:Name="selectorRelax2"
                                  Grid.Column="35"
                                  ItemsSource="{Binding Source={StaticResource GetColorsNumbersList}}"
                                  SelectedValue="{Binding ColorRelax2}" Margin="220,46,140,0"/>
                    <!-- End -->
                    <Button
                                Grid.Column="35"
                                Margin="0,1,291,22"
                                Visibility="Hidden"
                                Command="{Binding ChangeColors}"
                                Content="Сменить раскраску" />

                    <Button
                                Grid.Column="35"
                                Margin="281,9,10,42"
                                Click="CreatePreferense_Click"
                                Content="Добавить запись" />

                    <Button
                                Grid.Column="35"
                                Margin="281,34,10,16"
                                Click="ClearPreferenceInputs_Click"
                                Content="Сброс выбора"  />
                    <TextBlock
                            HorizontalAlignment="Center"
                            Text="Биоколор 1" Margin="137,24,42,30" Width="71" Grid.Column="1" Grid.ColumnSpan="3" />
                    <TextBlock
                            HorizontalAlignment="Center"
                            Margin="137,50,2,-7" Width="66" Text="Биоколор 2" Grid.Column="1" />
                    <Button x:Name="UpdatePrefernceBtn"
                            Grid.Column="35"
                            Margin="281,60,10,-8"
                            Click="UpdatePreference_Click"
                            Content="Применить"
                            Visibility="Hidden"/>
                </Grid>
            </TabItem>
            <TabItem x:Name="tabItem2" DataContext="{StaticResource subjectiveFeelingVM}" Header="Субъективные ощущения">
            <Grid x:Name="DataFridSubjectiveFeelings" Background="#FFE5E5E5" Margin="0,0,0,31">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="1352" />
                </Grid.ColumnDefinitions>
                <Grid.RowDefinitions>
                    <RowDefinition Height="122" />
                </Grid.RowDefinitions>
                <Button
                                Margin="932,37,311,61"
                                Click="CreateSubjectiveFeeling_Click"
                                Content="Добавить запись" />
                <Button
                            x:Name="UpdateSubjectiveFeelingBtn"
                                Margin="1161,37,81,61"
                                Click="UpdateSubjectiveFeeling_Click"
                                Content="Применить" 
                            Visibility="Hidden"/>

                <TextBlock Grid.Row="0"
                                   Grid.Column="0"
                                   HorizontalAlignment="Center"
                                   Text="Код" Margin="66,17,1266,88" />
                <TextBlock
                                   HorizontalAlignment="Center"
                                   Text="Дата" Margin="177,14,1149,83" />
                <TextBlock
                                   HorizontalAlignment="Center"
                                   Text="Общая слабость" Margin="279,14,983,83" />
                <TextBlock
                                   HorizontalAlignment="Center"
                                   Text="Плохой аппетит" Margin="379,14,885,83" />
                <TextBlock
                                   HorizontalAlignment="Center"
                                   Text="Плохой сон" Margin="477,14,810,83" />
                <TextBlock
                                   HorizontalAlignment="Center"
                                   Text="Плохое настроение" Margin="551,14,692,83" />
                <TextBlock
                                   HorizontalAlignment="Center"
                                   Text="Тяжесть в голове" Margin="669,14,588,83" />
                <TextBlock
                                   HorizontalAlignment="Center"
                                   Text="Замедленное мышление" Margin="774,14,441,83" />

                <ComboBox x:Name="UserIdsInsertSubjFeelCB"
                                  Grid.Column="0"
                                  Width="80"
                                  HorizontalAlignment="Left"
                                  VerticalAlignment="Top"
                                  ItemsSource="{Binding Source={StaticResource GetCodesForInsert}}"
                                  SelectedValue="{Binding UserId}" Margin="36,39,0,0"/>


                <DatePicker
                                    HorizontalAlignment="Left"
                                    VerticalAlignment="Top"
                                    x:Name="selectedDateInSubjectiveFeeling"
                                    SelectedDate="{Binding Date}" Margin="145,37,0,0" />
                <CheckBox
                                  HorizontalAlignment="Center"
                                  VerticalAlignment="Center"
                                  x:Name="markGeneralWeakness"
                                  IsChecked="{Binding GeneralWeaknes}" Margin="316,44,1020,63" />
                <CheckBox
                                  HorizontalAlignment="Center"
                                  VerticalAlignment="Center"
                                  x:Name="markBadAppetite"
                                  IsChecked="{Binding PoorAppetite}" Margin="415,44,921,63" />
                <CheckBox
                                  HorizontalAlignment="Center"
                                  VerticalAlignment="Center"
                                  x:Name="markBadDream"
                                  IsChecked="{Binding PoorSleep}" Margin="501,44,835,63" />
                <CheckBox
                                  HorizontalAlignment="Center"
                                  VerticalAlignment="Center"
                                  x:Name="markBadMood"
                                  IsChecked="{Binding BadMood}" Margin="597,44,739,63" />
                <CheckBox
                                  HorizontalAlignment="Center"
                                  VerticalAlignment="Center"
                                  x:Name="markHeavyHead"
                                  IsChecked="{Binding HeavyHead}" Margin="709,44,627,63" />
                <CheckBox
                                  HorizontalAlignment="Center"
                                  VerticalAlignment="Center"
                                  x:Name="markSlowThink"
                                  IsChecked="{Binding SlowThink}" Margin="834,44,502,63" />

                <TextBox Text="{Binding Id}"
                                 HorizontalAlignment="Center"
                                 VerticalAlignment="Center"
                                 Visibility="Hidden" Margin="837,57,505,47"/>
                <Button
                            Margin="1046,37,196,61"
                            Content="Сброс" 
                            Visibility="Visible"
                            Click="ClearSubjectiveFeelingInputs_Click"/>
            </Grid>
        </TabItem>
            <TabItem x:Name="tabItem3" Header="Биоколор">
            <Grid Background="#FFE5E5E5">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="0*"/>
                    <ColumnDefinition Width="7*"/>
                    <ColumnDefinition Width="331*"/>
                </Grid.ColumnDefinitions>
                <Label  Height="25" VerticalAlignment="Top" Width="150" HorizontalAlignment="Left" Margin="26,10,0,0" Grid.ColumnSpan="3" Content="Дата рождения"/>
                <DatePicker Height="25" Width="111" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="26,34,0,0" Name="Date"     VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Grid.ColumnSpan="3"/>
                <Label   Height="25" Width="150" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="133,10,0,0" Content="Дата расчета" Grid.Column="2"/>

                <Button   Height="25" Width="75" VerticalAlignment="Top" HorizontalAlignment="Left" Click = "Prew_Click" Margin="541,34,0,0" Content="Назад" Grid.Column="2" />
                <Button   Height="25" Width="75" VerticalAlignment="Top" HorizontalAlignment="Left" Click = "Next_Click" Margin="630,34,0,0" Content="Вперед" Grid.Column="2" />

                <DatePicker Height="25" Width="102" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="133,34,0,0" Name="DateNow" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" SelectedDate="{x:Static sys:DateTime.Now}" Grid.Column="2"/>
                <Button  Height="25" Width="150" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="351,34,0,0" Click="DrawGraphs_Click" Grid.Column="2">Построить графики</Button>
                <Button  Height="25" Width="150" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="998,26,0,0" Click="Generate_Click" Visibility="Hidden" Grid.Column="2">Создать изображение</Button>
            </Grid>
        </TabItem>
            <TabItem x:Name="ColorSettingsTab" Header="Цвета"/>
        </TabControl>
        
        <Grid Margin="0" Grid.Row="1">
            <Grid.ColumnDefinitions>
                <ColumnDefinition/>
                <ColumnDefinition MaxWidth="250" Width="250"/>
            </Grid.ColumnDefinitions>

            <DataGrid x:Name="PeopleDataGrid" CanUserAddRows="False" CanUserDeleteRows="False" ItemsSource="{Binding Source={StaticResource GetPeople}}" IsSynchronizedWithCurrentItem="True" AutoGenerateColumns="False">
                <DataGrid.Columns>
                    <DataGridTextColumn Binding="{Binding Id}" Visibility="Hidden"/>
                    <DataGridTextColumn Width="auto" Header="Код" Binding="{Binding UserId}"  ClipboardContentBinding="{x:Null}"/>
                    <DataGridTextColumn Width="auto" Header="Имя" Binding="{Binding Firstname}" ClipboardContentBinding="{x:Null}"/>
                    <DataGridTextColumn Width="auto" Header="Фамилия" Binding="{Binding Lastname}" ClipboardContentBinding="{x:Null}"/>
                    <DataGridTextColumn Width="auto" Header="Отчество" Binding="{Binding Middlename}" ClipboardContentBinding="{x:Null}"/>
                    <DataGridTextColumn Width="auto" Header="День рождения" Binding="{Binding Birthday, StringFormat=\{0:d\}}" ClipboardContentBinding="{x:Null}"/>
                    <DataGridTextColumn Width="auto" Header="Профессия" Binding="{Binding Workposition, UpdateSourceTrigger=PropertyChanged}" ClipboardContentBinding="{x:Null}"/>
                    <DataGridTextColumn Width="auto" Header="Експедиция" Binding="{Binding Expedition}" ClipboardContentBinding="{x:Null}"/>
                    <DataGridTextColumn Width="auto" Header="Номер" Binding="{Binding Number}" ClipboardContentBinding="{x:Null}"/>
                    <DataGridTemplateColumn ClipboardContentBinding="{x:Null}">
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>
                                <Button x:Name="EditPersonBtn" Content="&#xE70F;" FontFamily="Segoe MDL2 Assets" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Width="Auto" BorderBrush="White" Background="White" Foreground="Black" FontSize="14" Click="BindPersonInForm_Click" Tag="{Binding Id}"/>
                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>
                    </DataGridTemplateColumn>
                    <DataGridTemplateColumn ClipboardContentBinding="{x:Null}">
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>
                                <Button x:Name="RemovePersonBtn" Content="&#xE107;" FontFamily="Segoe MDL2 Assets" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Width="Auto" BorderBrush="White" Background="White" Foreground="Red" FontSize="14" Click="RemovePerson_Click"/>
                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>
                    </DataGridTemplateColumn>
                </DataGrid.Columns>
            </DataGrid>

            <DataGrid x:Name="PreferencesDataGrid" CanUserAddRows="False" ItemsSource="{Binding Source={StaticResource GetPreferences}}" IsSynchronizedWithCurrentItem="True" AutoGenerateColumns="False" Visibility="{Binding IsSelected, Converter={StaticResource BooleanToVisibilityConverter}, ElementName=tabItem1}">
                <DataGrid.Columns>
                    <DataGridTemplateColumn Header="График" Width="auto" ClipboardContentBinding="{x:Null}">
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>
                                <Button
                                Command="{Binding MakeIndividualChartCommand}"
                                Content="&#xE929;"
                                FontFamily="Segoe MDL2 Assets"
                                ToolTip="{x:Static p:Resources.MakeChartToolTip}" Click="BuildInduvidualChart_Click" />
                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>
                    </DataGridTemplateColumn>
                    <DataGridTextColumn Binding="{Binding Id}" Visibility="Hidden"/>
                    <DataGridTextColumn Header="Код" Width="auto" Binding="{Binding UserId}" ClipboardContentBinding="{x:Null}" FontSize="14"/>
                    <DataGridTextColumn Header="Дата" Width="auto" Binding="{Binding Date, StringFormat=\{0:d\}, ConverterCulture=uk-UA}" ClipboardContentBinding="{x:Null}"/>
                    <!-- BioColor I START -->
                    <!-- BioColor I (Three) -->
                    <DataGridTemplateColumn Header="Короткий 1" Width="auto" ClipboardContentBinding="{x:Null}"
                                                 Visibility="{Binding Path=IsChecked, Source={x:Reference BioColorIHide}, Converter={StaticResource BooleanToNOTVisibilityConverter}}">
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>
                                <ListView ItemsSource="{Binding ShortOder1, Converter={StaticResource StringToListConverter}}">
                                    <ListView.ItemTemplate>
                                        <DataTemplate>
                                            <Label Content="{Binding}" Foreground="{Binding Content, Converter={StaticResource TextColorNumberToBrushConverter}, RelativeSource={RelativeSource Self}}"  Background="{Binding Content,Converter={StaticResource NameToBrushConverter}, IsAsync=True, NotifyOnTargetUpdated=True, NotifyOnSourceUpdated=True, NotifyOnValidationError=True, RelativeSource={RelativeSource Self}, ValidatesOnNotifyDataErrors=False}" BorderBrush="Black" BorderThickness="1" Width="25" MinWidth="25"></Label>
                                        </DataTemplate>
                                    </ListView.ItemTemplate>
                                    <ListView.ItemsPanel>
                                        <ItemsPanelTemplate>
                                            <StackPanel Orientation="Horizontal"></StackPanel>
                                        </ItemsPanelTemplate>
                                    </ListView.ItemsPanel>
                                </ListView>
                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>
                    </DataGridTemplateColumn>

                    <DataGridTemplateColumn ClipboardContentBinding="{x:Null}"/>
                    <!-- BioColor I (ThreeColor) -->
                    <DataGridTemplateColumn Header="Биоколор 1" Width="auto" ClipboardContentBinding="{x:Null}" MinWidth="280"
                                                 Visibility="{Binding Path=IsChecked, Source={x:Reference BioColorIThree}, Converter={StaticResource BooleanToVisibilityConverter}}">
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>
                                <ListView ItemsSource="{Binding Oder1, Converter={StaticResource StringToListConverter}}" Padding="-4,0,0,0" Margin="0" Width="Auto" HorizontalAlignment="Left" MinWidth="270">
                                    <ListView.ItemTemplate>
                                        <DataTemplate>
                                            <Label Content="{Binding}" Foreground="{Binding Content, Converter={StaticResource TextColorNumberToBrushConverter}, RelativeSource={RelativeSource Self}}" Background="{Binding Content,Converter={StaticResource NameToBrushConverter}, IsAsync=True, NotifyOnTargetUpdated=True, NotifyOnSourceUpdated=True, NotifyOnValidationError=True, RelativeSource={RelativeSource Self}, ValidatesOnNotifyDataErrors=False}" BorderBrush="Black" BorderThickness="1" MinWidth="25"></Label>
                                        </DataTemplate>
                                    </ListView.ItemTemplate>
                                    <ListView.ItemsPanel>
                                        <ItemsPanelTemplate>
                                            <StackPanel Orientation="Horizontal"></StackPanel>
                                        </ItemsPanelTemplate>
                                    </ListView.ItemsPanel>
                                </ListView>
                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>
                    </DataGridTemplateColumn>

                    <!-- BioColor I (TwelveColor) -->
                    <DataGridTemplateColumn Header="Биоколор 2" Width="auto" ClipboardContentBinding="{x:Null}" MinWidth="280"
                                             Visibility="{Binding Path=IsChecked, Source={x:Reference BioColorITwelve}, Converter={StaticResource BooleanToVisibilityConverter}}">
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>
                                <ListView ItemsSource="{Binding Oder1, Converter={StaticResource StringToListConverter}}" Padding="-4,0,0,0" Margin="0" Width="Auto" HorizontalAlignment="Left" MinWidth="270">
                                    <ListView.ItemTemplate>
                                        <DataTemplate>
                                            <Label Content="{Binding}" Foreground="{Binding Content, Converter={StaticResource TextColorNumberToBrushConverter}, RelativeSource={RelativeSource Self}}" 
											Background="{Binding Content,Converter={StaticResource NameToMultiBrushConverter}, IsAsync=True, NotifyOnTargetUpdated=True, NotifyOnSourceUpdated=True, NotifyOnValidationError=True, RelativeSource={RelativeSource Self}, ValidatesOnNotifyDataErrors=False}" BorderBrush="Black" BorderThickness="1" MinWidth="25"></Label>
                                        </DataTemplate>
                                    </ListView.ItemTemplate>
                                    <ListView.ItemsPanel>
                                        <ItemsPanelTemplate>
                                            <StackPanel Orientation="Horizontal"></StackPanel>
                                        </ItemsPanelTemplate>
                                    </ListView.ItemsPanel>
                                </ListView>
                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>
                    </DataGridTemplateColumn>

                    <!-- Preference1 -->
                    <DataGridTextColumn x:Name="Pre1" Header="Преференция 1" Width="auto" Binding="{Binding Preference1}" ClipboardContentBinding="{x:Null}"
                                        Visibility="{Binding Path=IsChecked, Source={x:Reference BioColorIHide}, Converter={StaticResource BooleanToNOTVisibilityConverter}}">
                        <DataGridTextColumn.ElementStyle>
                            <Style TargetType="{x:Type TextBlock}">
                                <Setter Property="Background" Value="{Binding Preference1, Converter={StaticResource PreferenceToBrushConverter}}" />
                                <Setter Property="TextAlignment" Value="Center"></Setter>
                            </Style>
                        </DataGridTextColumn.ElementStyle>
                    </DataGridTextColumn>
                    <!-- BioColor I END -->

                    <DataGridTemplateColumn ClipboardContentBinding="{x:Null}"/>
                    <!-- BioColor II START -->
                    <!-- BioColor II (Three) -->
                    <DataGridTemplateColumn Header="Короткий 2" Width="auto" ClipboardContentBinding="{x:Null}"
                                                 Visibility="{Binding Path=IsChecked, Source={x:Reference BioColorIITwelve}, Converter={StaticResource BooleanToVisibilityConverter}}">
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>
                                <ListView ItemsSource="{Binding ShortOder2, Converter={StaticResource StringToListConverter}}">
                                    <ListView.ItemTemplate>
                                        <DataTemplate>
                                            <Label Content="{Binding}" Foreground="{Binding Content, Converter={StaticResource TextColorNumberToBrushConverter}, RelativeSource={RelativeSource Self}}"  Background="{Binding Content,Converter={StaticResource NameToBrushConverter}, IsAsync=True, NotifyOnTargetUpdated=True, NotifyOnSourceUpdated=True, NotifyOnValidationError=True, RelativeSource={RelativeSource Self}, ValidatesOnNotifyDataErrors=False}" BorderBrush="Black" BorderThickness="1" Width="25" ></Label>
                                        </DataTemplate>
                                    </ListView.ItemTemplate>
                                    <ListView.ItemsPanel>
                                        <ItemsPanelTemplate>
                                            <StackPanel Orientation="Horizontal"></StackPanel>
                                        </ItemsPanelTemplate>
                                    </ListView.ItemsPanel>
                                </ListView>
                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>
                    </DataGridTemplateColumn>

                    <!-- BioColor II (ThreePictures) -->
                    <DataGridTemplateColumn  ClipboardContentBinding="{x:Null}"
                                                 Visibility="{Binding Path=IsChecked, Source={x:Reference BioColorIIPictures}, Converter={StaticResource BooleanToVisibilityConverter}}">
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>
                                <ListView ItemsSource="{Binding ShortOder2, Converter={StaticResource StringToListConverter}}">
                                    <ListView.ItemTemplate>
                                        <DataTemplate>
                                            <Label Content="{Binding}" Foreground="{Binding Content, Converter={StaticResource TextColorNumberToBrushConverter}, RelativeSource={RelativeSource Self}}"  Background="{Binding Content,Converter={StaticResource NameToImageConverter}, IsAsync=True, NotifyOnTargetUpdated=True, NotifyOnSourceUpdated=True, NotifyOnValidationError=True, RelativeSource={RelativeSource Self}, ValidatesOnNotifyDataErrors=False}" BorderBrush="Black" BorderThickness="1" Width="25"></Label>
                                        </DataTemplate>
                                    </ListView.ItemTemplate>
                                    <ListView.ItemsPanel>
                                        <ItemsPanelTemplate>
                                            <StackPanel Orientation="Horizontal"></StackPanel>
                                        </ItemsPanelTemplate>
                                    </ListView.ItemsPanel>
                                </ListView>
                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>
                    </DataGridTemplateColumn>

                    <DataGridTemplateColumn ClipboardContentBinding="{x:Null}"/>
                    <!-- BioColor II (TwelveColor) -->
                    <DataGridTemplateColumn Header="Биоколор 2" Width="auto" ClipboardContentBinding="{x:Null}" MinWidth="280"
                                                 Visibility="{Binding Path=IsChecked, Source={x:Reference BioColorIITwelve}, Converter={StaticResource BooleanToVisibilityConverter}}">
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>
                                <ListView ItemsSource="{Binding Oder2, Converter={StaticResource StringToListConverter}}" Padding="-4,0,0,0" Margin="0" Width="Auto" HorizontalAlignment="Left" MinWidth="270">
                                    <ListView.ItemTemplate>
                                        <DataTemplate>
                                            <Label Content="{Binding}" Foreground="{Binding Content, Converter={StaticResource TextColorNumberToBrushConverter}, RelativeSource={RelativeSource Self}}" Background="{Binding Content,Converter={StaticResource NameToBrushConverter}, IsAsync=True, NotifyOnTargetUpdated=True, NotifyOnSourceUpdated=True, NotifyOnValidationError=True, RelativeSource={RelativeSource Self}, ValidatesOnNotifyDataErrors=False}" BorderBrush="Black" BorderThickness="1" MinWidth="25"></Label>
                                        </DataTemplate>
                                    </ListView.ItemTemplate>
                                    <ListView.ItemsPanel>
                                        <ItemsPanelTemplate>
                                            <StackPanel Orientation="Horizontal"></StackPanel>
                                        </ItemsPanelTemplate>
                                    </ListView.ItemsPanel>
                                </ListView>
                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>
                    </DataGridTemplateColumn>
                    <!-- BioColor II (TwelvePictures) -->
                    <DataGridTemplateColumn Header="Биоколор 2" Width="auto" ClipboardContentBinding="{x:Null}" MinWidth="280"
                                             Visibility="{Binding Path=IsChecked, Source={x:Reference BioColorIIPictures}, Converter={StaticResource BooleanToVisibilityConverter}}">
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>
                                <ListView ItemsSource="{Binding Oder2, Converter={StaticResource StringToListConverter}}" Padding="-4,0,0,0" Margin="0" Width="Auto" HorizontalAlignment="Left" MinWidth="270">
                                    <ListView.ItemTemplate>
                                        <DataTemplate>
                                            <Label Content="{Binding}" Foreground="{Binding Content, Converter={StaticResource TextColorNumberToBrushConverter}, RelativeSource={RelativeSource Self}}" 
											Background="{Binding Content,Converter={StaticResource NameToImageConverter}, IsAsync=True, NotifyOnTargetUpdated=True, NotifyOnSourceUpdated=True, NotifyOnValidationError=True, RelativeSource={RelativeSource Self}, ValidatesOnNotifyDataErrors=False}" BorderBrush="Black" BorderThickness="1" MinWidth="25"></Label>
                                        </DataTemplate>
                                    </ListView.ItemTemplate>
                                    <ListView.ItemsPanel>
                                        <ItemsPanelTemplate>
                                            <StackPanel Orientation="Horizontal"></StackPanel>
                                        </ItemsPanelTemplate>
                                    </ListView.ItemsPanel>
                                </ListView>
                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>
                    </DataGridTemplateColumn>

                    <!-- Preference2 -->
                    <DataGridTextColumn Header="Преференция 2" Width="auto" Binding="{Binding Preference2}" ClipboardContentBinding="{x:Null}"
                                                 Visibility="{Binding Path=IsChecked, Source={x:Reference BioColorIIHide}, Converter={StaticResource BooleanToNOTVisibilityConverter}}">
                        <DataGridTextColumn.ElementStyle>
                            <Style TargetType="{x:Type TextBlock}">
                                <Setter Property="Background" Value="{Binding Preference2, Converter={StaticResource PreferenceToBrushConverter}}" />
                                <Setter Property="TextAlignment" Value="Center"></Setter>
                            </Style>
                        </DataGridTextColumn.ElementStyle>
                    </DataGridTextColumn>
                    <!-- BioColor II END -->

                    <DataGridTemplateColumn ClipboardContentBinding="{x:Null}"/>
                    <DataGridTextColumn 
                        ClipboardContentBinding="{x:Null}"
                        Header="Физическое"
                        Binding="{Binding UserId, Converter={StaticResource DateToSin}, ConverterParameter=23}">
                        <DataGridTextColumn.ElementStyle>
                            <Style>
                                <Setter Property="TextBlock.HorizontalAlignment" Value="Center" />
                                <Setter Property="TextBlock.VerticalAlignment" Value="Center" />
                                <Setter Property="TextBlock.FontSize" Value="20" />
                            </Style>
                        </DataGridTextColumn.ElementStyle>
                    </DataGridTextColumn>
                    <DataGridTextColumn 
                        ClipboardContentBinding="{x:Null}"
                        Header="Эмоциональное"
                        Binding="{Binding UserId, Converter={StaticResource DateToSin}, ConverterParameter=28}">
                        <DataGridTextColumn.ElementStyle>
                            <Style>
                                <Setter Property="TextBlock.HorizontalAlignment" Value="Center" />
                                <Setter Property="TextBlock.VerticalAlignment" Value="Center" />
                                <Setter Property="TextBlock.FontSize" Value="20" />
                            </Style>
                        </DataGridTextColumn.ElementStyle>
                    </DataGridTextColumn>
                    <DataGridTextColumn 
                        ClipboardContentBinding="{x:Null}"
                        Header="Интелектуальное"
                        Binding="{Binding UserId, Converter={StaticResource DateToSin}, ConverterParameter=33}">
                        <DataGridTextColumn.ElementStyle>
                            <Style>
                                <Setter Property="TextBlock.HorizontalAlignment" Value="Center" />
                                <Setter Property="TextBlock.VerticalAlignment" Value="Center" />
                                <Setter Property="TextBlock.FontSize" Value="20" />
                            </Style>
                        </DataGridTextColumn.ElementStyle>
                    </DataGridTextColumn>
                    <DataGridTemplateColumn ClipboardContentBinding="{x:Null}"/>
                    <DataGridTextColumn Header="Преф 1 и Преф 2" Width="auto" Binding="{Binding Compare, Converter={StaticResource BooleanToChecker}}" ClipboardContentBinding="{x:Null}">
                        <DataGridTextColumn.ElementStyle>
                            <Style>
                                <Setter Property="TextBlock.HorizontalAlignment" Value="Center" />
                                <Setter Property="TextBlock.VerticalAlignment" Value="Center" />
                                <Setter Property="TextBlock.FontSize" Value="20" />

                            </Style>
                        </DataGridTextColumn.ElementStyle>
                    </DataGridTextColumn>
                    <DataGridTemplateColumn ClipboardContentBinding="{x:Null}"/>
                    <DataGridTemplateColumn ClipboardContentBinding="{x:Null}" Header="Релакс 1" Width="60">
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>
                                <Image Source="{Binding RelaxTable1, Converter={StaticResource NumberToRelax1Converter}}"/>
                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>
                    </DataGridTemplateColumn>
                    <DataGridTemplateColumn ClipboardContentBinding="{x:Null}" Header="Релакс 2" Width="60">
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>
                                <Image Source="{Binding RelaxTable2, Converter={StaticResource NumberToRelax2Converter}}"/>
                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>
                    </DataGridTemplateColumn>

                    <DataGridTemplateColumn ClipboardContentBinding="{x:Null}"/>
                    <!-- Preference1 -->
                    <DataGridTextColumn Header="Преференция 1" Width="auto" Binding="{Binding Preference1}" ClipboardContentBinding="{x:Null}"
                                        Visibility="{Binding Path=IsChecked, Source={x:Reference BioColorIHide}, Converter={StaticResource BooleanToNOTVisibilityConverter}}">
                        <DataGridTextColumn.ElementStyle>
                            <Style TargetType="{x:Type TextBlock}">
                                <Setter Property="Background" Value="{Binding Preference1, Converter={StaticResource PreferenceToBrushConverter}}" />
                                <Setter Property="TextAlignment" Value="Center"></Setter>
                            </Style>
                        </DataGridTextColumn.ElementStyle>
                    </DataGridTextColumn>

                    <!-- Preference2 -->
                    <DataGridTextColumn Header="Преференция 2" Width="auto" Binding="{Binding Preference2}" ClipboardContentBinding="{x:Null}"
                                        Visibility="{Binding Path=IsChecked, Source={x:Reference BioColorIIHide}, Converter={StaticResource BooleanToNOTVisibilityConverter}}">
                        <DataGridTextColumn.ElementStyle>
                            <Style TargetType="{x:Type TextBlock}">
                                <Setter Property="Background" Value="{Binding Preference2, Converter={StaticResource PreferenceToBrushConverter}}" />
                                <Setter Property="TextAlignment" Value="Center"></Setter>
                            </Style>
                        </DataGridTextColumn.ElementStyle>
                    </DataGridTextColumn>

                    <!-- Compare Pref1 + Relax1-->
                    <DataGridTemplateColumn ClipboardContentBinding="{x:Null}"/>
                    <DataGridTextColumn Header="Преф 1 Релакс2" Width="auto" ClipboardContentBinding="{x:Null}">
                        <DataGridTextColumn.ElementStyle>
                            <Style>
                                <Setter Property="TextBlock.HorizontalAlignment" Value="Center" />
                                <Setter Property="TextBlock.VerticalAlignment" Value="Center" />
                                <Setter Property="TextBlock.FontSize" Value="20"/>
                                <Setter Property="TextBlock.Text">
                                    <Setter.Value>
                                        <MultiBinding Converter="{StaticResource PreferenceSameAsRelax}">
                                            <Binding Path="Preference1"/>
                                            <Binding Path="RelaxTable1"/>
                                        </MultiBinding>
                                    </Setter.Value>
                                </Setter>
                            </Style>
                        </DataGridTextColumn.ElementStyle>
                    </DataGridTextColumn>
                    <!-- Compare Pref2 + Relax2-->
                    <DataGridTextColumn Header="Преф 2 Релакс 2" Width="auto" ClipboardContentBinding="{x:Null}">
                        <DataGridTextColumn.ElementStyle>
                            <Style>
                                <Setter Property="TextBlock.HorizontalAlignment" Value="Center" />
                                <Setter Property="TextBlock.VerticalAlignment" Value="Center" />
                                <Setter Property="TextBlock.FontSize" Value="20"/>
                                <Setter Property="TextBlock.Text">
                                    <Setter.Value>
                                        <MultiBinding Converter="{StaticResource PreferenceSameAsRelax}">
                                            <Binding Path="Preference2"/>
                                            <Binding Path="RelaxTable2"/>
                                        </MultiBinding>
                                    </Setter.Value>
                                </Setter>
                            </Style>
                        </DataGridTextColumn.ElementStyle>
                    </DataGridTextColumn>

                    <DataGridTemplateColumn ClipboardContentBinding="{x:Null}">
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>
                                <Button x:Name="EditPreferenceBtn" Content="&#xE70F;" FontFamily="Segoe MDL2 Assets" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Width="Auto" BorderBrush="White" Background="White" Foreground="Black" FontSize="14" Click="BindPreferenceInForm_Click" Tag="{Binding Id}"/>
                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>
                    </DataGridTemplateColumn>
                    <DataGridTemplateColumn ClipboardContentBinding="{x:Null}">
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>
                                <Button x:Name="RemovePreferenceBtn" Content="&#xE107;" FontFamily="Segoe MDL2 Assets" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Width="Auto" BorderBrush="White" Background="White" Foreground="Red" FontSize="14" Click="RemovePreference_Click"/>
                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>
                    </DataGridTemplateColumn>

                </DataGrid.Columns>
            </DataGrid>

            <DataGrid x:Name="SubjectiveFeelingDataGrid" IsReadOnly="True" CanUserAddRows="False" ItemsSource="{Binding Source={StaticResource GetFeelings}}" IsSynchronizedWithCurrentItem="True" AutoGenerateColumns="False" Visibility="{Binding IsSelected, Converter={StaticResource BooleanToVisibilityConverter}, ElementName=tabItem2}">
                <DataGrid.Columns>
                    <DataGridTextColumn Binding="{Binding Id}" Visibility="Hidden" />
                    <DataGridTextColumn Header="Код" Binding="{Binding UserId}" ClipboardContentBinding="{x:Null}"/>
                    <DataGridTextColumn Header="Дата" Binding="{Binding Date, StringFormat=\{0:d\}, ConverterCulture=uk-UA}" ClipboardContentBinding="{x:Null}"/>
                    <DataGridCheckBoxColumn Width="auto" Header="Общая слабость" Binding="{Binding GeneralWeaknes}" ClipboardContentBinding="{x:Null}"/>
                    <DataGridCheckBoxColumn Width="auto" Header="Плохой апетит" Binding="{Binding PoorAppetite}" ClipboardContentBinding="{x:Null}"/>
                    <DataGridCheckBoxColumn Width="auto" Header="Плохой сон" Binding="{Binding PoorSleep}" ClipboardContentBinding="{x:Null}"/>
                    <DataGridCheckBoxColumn Width="auto" Header="Плохое настроение" Binding="{Binding BadMood}" ClipboardContentBinding="{x:Null}"/>
                    <DataGridCheckBoxColumn Width="auto" Header="Тяжесть в голове" Binding="{Binding HeavyHead}" ClipboardContentBinding="{x:Null}"/>
                    <DataGridCheckBoxColumn Width="auto" Header="Замедленное мышление" Binding="{Binding SlowThink}" ClipboardContentBinding="{x:Null}"/>
                    <DataGridTemplateColumn ClipboardContentBinding="{x:Null}">
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>
                                <Button x:Name="EditFeelingsBtn" Content="&#xE70F;" FontFamily="Segoe MDL2 Assets" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Width="Auto" BorderBrush="White" Background="White" Foreground="Black" FontSize="14" Click="BindSubjectiveFeelingInForm_Click" Tag="{Binding Id}"/>
                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>
                    </DataGridTemplateColumn>
                    <DataGridTemplateColumn ClipboardContentBinding="{x:Null}">
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>
                                <Button x:Name="RemoveFeelingsBtn" Content="&#xE107;" FontFamily="Segoe MDL2 Assets" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Width="Auto" BorderBrush="White" Background="White" Foreground="Red" FontSize="14" Click="DeleteSSubjectiveFeeling_Click"/>
                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>
                    </DataGridTemplateColumn>
                </DataGrid.Columns>
            </DataGrid>

            <Grid x:Name="BioColorGrid" Background="White" Visibility="{Binding IsSelected, Converter={StaticResource BooleanToVisibilityConverter}, ElementName=tabItem3}" Grid.ColumnSpan="2" >
                <Grid.RowDefinitions>
                    <RowDefinition/>
                </Grid.RowDefinitions>
            </Grid>

            <Grid x:Name="ColorSettings" Background="White" Visibility="{Binding IsSelected, Converter={StaticResource BooleanToVisibilityConverter}, ElementName=ColorSettingsTab}" Margin="2,-51,-2,-31" Grid.ColumnSpan="2" Panel.ZIndex="2">

                <Image Width="200" Height="200" Margin="25,50,0,0" HorizontalAlignment="Left" VerticalAlignment="Top">
                    <Image.Source>
                        <DrawingImage>
                            <DrawingImage.Drawing>
                                <DrawingGroup>
                                    <GeometryDrawing x:Name="PhysicalColorBackground4" Brush="#F603EB">
                                        <GeometryDrawing.Pen>
                                            <Pen Brush="Black"/>
                                        </GeometryDrawing.Pen>
                                        <GeometryDrawing.Geometry>
                                            <PathGeometry>
                                                <PathFigure StartPoint="100,100">
                                                    <PathFigure.Segments>
                                                        <LineSegment Point="200.0,100.0"/>
                                                        <ArcSegment Point="186.6,50.0" SweepDirection="Counterclockwise" Size="100,100"/>
                                                        <LineSegment Point="100,100"/>
                                                    </PathFigure.Segments>
                                                </PathFigure>
                                            </PathGeometry>
                                        </GeometryDrawing.Geometry>
                                    </GeometryDrawing>

                                    <GeometryDrawing x:Name="PhysicalColorBackground3" Brush="#FA0006">
                                        <GeometryDrawing.Pen>
                                            <Pen Brush="Black"/>
                                        </GeometryDrawing.Pen>
                                        <GeometryDrawing.Geometry>
                                            <PathGeometry>
                                                <PathFigure StartPoint="100,100">
                                                    <PathFigure.Segments>
                                                        <LineSegment Point="186.6,50.0"/>
                                                        <ArcSegment Point="150.0,13.4" SweepDirection="Counterclockwise" Size="100,100"/>
                                                        <LineSegment Point="100,100"/>
                                                    </PathFigure.Segments>
                                                </PathFigure>
                                            </PathGeometry>
                                        </GeometryDrawing.Geometry>
                                    </GeometryDrawing>

                                    <GeometryDrawing x:Name="PhysicalColorBackground2" Brush="#FE280C">
                                        <GeometryDrawing.Pen>
                                            <Pen Brush="Black"/>
                                        </GeometryDrawing.Pen>
                                        <GeometryDrawing.Geometry>
                                            <PathGeometry>
                                                <PathFigure StartPoint="100,100">
                                                    <PathFigure.Segments>
                                                        <LineSegment Point="150.0,13.4"/>
                                                        <ArcSegment Point="100.0,0.0" SweepDirection="Counterclockwise" Size="100,100"/>
                                                        <LineSegment Point="100,100"/>
                                                    </PathFigure.Segments>
                                                </PathFigure>
                                            </PathGeometry>
                                        </GeometryDrawing.Geometry>
                                    </GeometryDrawing>

                                    <GeometryDrawing x:Name="PhysicalColorBackground1" Brush="#F96F0A">
                                        <GeometryDrawing.Pen>
                                            <Pen Brush="Black"/>
                                        </GeometryDrawing.Pen>
                                        <GeometryDrawing.Geometry>
                                            <PathGeometry>
                                                <PathFigure StartPoint="100,100">
                                                    <PathFigure.Segments>
                                                        <LineSegment Point="100.0,0.0"/>
                                                        <ArcSegment Point="50.0,13.4" SweepDirection="Counterclockwise" Size="100,100"/>
                                                        <LineSegment Point="100,100"/>
                                                    </PathFigure.Segments>
                                                </PathFigure>
                                            </PathGeometry>
                                        </GeometryDrawing.Geometry>
                                    </GeometryDrawing>

                                    <GeometryDrawing x:Name="EmotionalColorBackground4" Brush="#FBBC0C">
                                        <GeometryDrawing.Pen>
                                            <Pen Brush="Black"/>
                                        </GeometryDrawing.Pen>
                                        <GeometryDrawing.Geometry>
                                            <PathGeometry>
                                                <PathFigure StartPoint="100,100">
                                                    <PathFigure.Segments>
                                                        <LineSegment Point="50.0,13.4"/>
                                                        <ArcSegment Point="13.4,50.0" SweepDirection="Counterclockwise" Size="100,100"/>
                                                        <LineSegment Point="100,100"/>
                                                    </PathFigure.Segments>
                                                </PathFigure>
                                            </PathGeometry>
                                        </GeometryDrawing.Geometry>
                                    </GeometryDrawing>

                                    <GeometryDrawing x:Name="EmotionalColorBackground3" Brush="#F4FE09">
                                        <GeometryDrawing.Pen>
                                            <Pen Brush="Black"/>
                                        </GeometryDrawing.Pen>
                                        <GeometryDrawing.Geometry>
                                            <PathGeometry>
                                                <PathFigure StartPoint="100,100">
                                                    <PathFigure.Segments>
                                                        <LineSegment Point="13.4,50.0"/>
                                                        <ArcSegment Point="0.0,100.0" SweepDirection="Counterclockwise" Size="100,100"/>
                                                        <LineSegment Point="100,100"/>
                                                    </PathFigure.Segments>
                                                </PathFigure>
                                            </PathGeometry>
                                        </GeometryDrawing.Geometry>
                                    </GeometryDrawing>

                                    <GeometryDrawing x:Name="EmotionalColorBackground2" Brush="#7EFE07">
                                        <GeometryDrawing.Pen>
                                            <Pen Brush="Black"/>
                                        </GeometryDrawing.Pen>
                                        <GeometryDrawing.Geometry>
                                            <PathGeometry>
                                                <PathFigure StartPoint="100,100">
                                                    <PathFigure.Segments>
                                                        <LineSegment Point="0.0,100.0"/>
                                                        <ArcSegment Point="13.4,150.0" SweepDirection="Counterclockwise" Size="100,100"/>
                                                        <LineSegment Point="100,100"/>
                                                    </PathFigure.Segments>
                                                </PathFigure>
                                            </PathGeometry>
                                        </GeometryDrawing.Geometry>
                                    </GeometryDrawing>

                                    <GeometryDrawing x:Name="EmotionalColorBackground1" Brush="#31F715">
                                        <GeometryDrawing.Pen>
                                            <Pen Brush="Black"/>
                                        </GeometryDrawing.Pen>
                                        <GeometryDrawing.Geometry>
                                            <PathGeometry>
                                                <PathFigure StartPoint="100,100">
                                                    <PathFigure.Segments>
                                                        <LineSegment Point="13.4,150.0"/>
                                                        <ArcSegment Point="50.0,186.6" SweepDirection="Counterclockwise" Size="100,100"/>
                                                        <LineSegment Point="100,100"/>
                                                    </PathFigure.Segments>
                                                </PathFigure>
                                            </PathGeometry>
                                        </GeometryDrawing.Geometry>
                                    </GeometryDrawing>

                                    <GeometryDrawing x:Name="IntellectualColorBackground4" Brush="#3DDEFB">
                                        <GeometryDrawing.Pen>
                                            <Pen Brush="Black"/>
                                        </GeometryDrawing.Pen>
                                        <GeometryDrawing.Geometry>
                                            <PathGeometry>
                                                <PathFigure StartPoint="100,100">
                                                    <PathFigure.Segments>
                                                        <LineSegment Point="50.0,186.6"/>
                                                        <ArcSegment Point="100.0,200.0" SweepDirection="Counterclockwise" Size="100,100"/>
                                                        <LineSegment Point="100,100"/>
                                                    </PathFigure.Segments>
                                                </PathFigure>
                                            </PathGeometry>
                                        </GeometryDrawing.Geometry>
                                    </GeometryDrawing>

                                    <GeometryDrawing x:Name="IntellectualColorBackground3" Brush="#1855F7">
                                        <GeometryDrawing.Pen>
                                            <Pen Brush="Black"/>
                                        </GeometryDrawing.Pen>
                                        <GeometryDrawing.Geometry>
                                            <PathGeometry>
                                                <PathFigure StartPoint="100,100">
                                                    <PathFigure.Segments>
                                                        <LineSegment Point="100.0,200.0"/>
                                                        <ArcSegment Point="150.0,186.6" SweepDirection="Counterclockwise" Size="100,100"/>
                                                        <LineSegment Point="100,100"/>
                                                    </PathFigure.Segments>
                                                </PathFigure>
                                            </PathGeometry>
                                        </GeometryDrawing.Geometry>
                                    </GeometryDrawing>

                                    <GeometryDrawing x:Name="IntellectualColorBackground2" Brush="#0F2BEB">
                                        <GeometryDrawing.Pen>
                                            <Pen Brush="Black"/>
                                        </GeometryDrawing.Pen>
                                        <GeometryDrawing.Geometry>
                                            <PathGeometry>
                                                <PathFigure StartPoint="100,100">
                                                    <PathFigure.Segments>
                                                        <LineSegment Point="150.0,186.6"/>
                                                        <ArcSegment Point="186.6,150.0" SweepDirection="Counterclockwise" Size="100,100"/>
                                                        <LineSegment Point="100,100"/>
                                                    </PathFigure.Segments>
                                                </PathFigure>
                                            </PathGeometry>
                                        </GeometryDrawing.Geometry>
                                    </GeometryDrawing>

                                    <GeometryDrawing x:Name="IntellectualColorBackground1" Brush="#2317F5">
                                        <GeometryDrawing.Pen>
                                            <Pen Brush="Black"/>
                                        </GeometryDrawing.Pen>
                                        <GeometryDrawing.Geometry>
                                            <PathGeometry>
                                                <PathFigure StartPoint="100,100">
                                                    <PathFigure.Segments>
                                                        <LineSegment Point="186.6,150.0"/>
                                                        <ArcSegment Point="200.0,100.0" SweepDirection="Counterclockwise" Size="100,100"/>
                                                        <LineSegment Point="100,100"/>
                                                    </PathFigure.Segments>
                                                </PathFigure>
                                            </PathGeometry>
                                        </GeometryDrawing.Geometry>
                                    </GeometryDrawing>

                                </DrawingGroup>
                            </DrawingImage.Drawing>
                        </DrawingImage>
                    </Image.Source>
                </Image>


                <TextBlock Width="100" Height="25" Name="pt1" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="250,  0,0,0"  Text="Физическое: [1]"/>
                <TextBlock Width="100" Height="25" Name="pt2" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="250, 25,0,0"  Text="Физическое: [2]"/>
                <TextBlock Width="100" Height="25" Name="pt3" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="250, 50,0,0"  Text="Физическое: [3]"/>
                <TextBlock Width="100" Height="25" Name="pt4" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="250, 75,0,0"  Text="Физическое: [4]"/>

                <TextBlock Width="118" Height="25" Name="et1" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="250,100,0,0"  Text="Эмоциональное: [1]"/>
                <TextBlock Width="118" Height="25" Name="et2" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="250,125,0,0"  Text="Эмоциональное: [2]"/>
                <TextBlock Width="118" Height="25" Name="et3" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="250,150,0,0"  Text="Эмоциональное: [3]"/>
                <TextBlock Width="118" Height="25" Name="et4" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="250,175,0,0"  Text="Эмоциональное: [4]"/>

                <TextBlock Width="118" Height="25" Name="it1" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="250,200,0,0"  Text="Интелекнуальное: [1]"/>
                <TextBlock Width="118" Height="25" Name="it2" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="250,225,0,0"  Text="Интелекнуальное: [2]"/>
                <TextBlock Width="118" Height="25" Name="it3" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="250,250,0,0"  Text="Интелекнуальное: [3]"/>
                <TextBlock Width="118" Height="25" Name="it4" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="250,275,0,0"  Text="Интелекнуальное: [4]"/>



                <TextBox IsReadOnly="True" Width="160" Height="25" Name="PhysicalColor1" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="382,0,0,0" />
                <TextBox                   Width="50" Height="25" Name="cPhysicalColor1" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="607,0,0,0" />
                <TextBox                   Width="50" Height="25" Name="mPhysicalColor1" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="657,0,0,0" />
                <TextBox                   Width="50" Height="25" Name="yPhysicalColor1" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="707,0,0,0" />
                <TextBox                   Width="50" Height="25" Name="kPhysicalColor1" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="757,0,0,0" />
                <TextBox IsReadOnly="True" Width="160" Height="25" Name="PhysicalColor2" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="382,25,0,0" />
                <TextBox                   Width="50" Height="25" Name="cPhysicalColor2" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="607,25,0,0" />
                <TextBox                   Width="50" Height="25" Name="mPhysicalColor2" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="657,25,0,0" />
                <TextBox                   Width="50" Height="25" Name="yPhysicalColor2" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="707,25,0,0" />
                <TextBox                   Width="50" Height="25" Name="kPhysicalColor2" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="757,25,0,0" />
                <TextBox IsReadOnly="True" Width="160" Height="25" Name="PhysicalColor3" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="382,50,0,0" />
                <TextBox                   Width="50" Height="25" Name="cPhysicalColor3" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="607,50,0,0" />
                <TextBox                   Width="50" Height="25" Name="mPhysicalColor3" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="657,50,0,0" />
                <TextBox                   Width="50" Height="25" Name="yPhysicalColor3" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="707,50,0,0" />
                <TextBox                   Width="50" Height="25" Name="kPhysicalColor3" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="757,50,0,0" />
                <TextBox IsReadOnly="True" Width="160" Height="25" Name="PhysicalColor4" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="382,75,0,0" />
                <TextBox                   Width="50" Height="25" Name="cPhysicalColor4" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="607,75,0,0" />
                <TextBox                   Width="50" Height="25" Name="mPhysicalColor4" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="657,75,0,0" />
                <TextBox                   Width="50" Height="25" Name="yPhysicalColor4" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="707,75,0,0" />
                <TextBox                   Width="50" Height="25" Name="kPhysicalColor4" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="757,75,0,0" />
                <TextBox IsReadOnly="True" Width="160" Height="25" Name="EmotionalColor1" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="382,100,0,0" />
                <TextBox                   Width="50" Height="25" Name="cEmotionalColor1" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="607,100,0,0" />
                <TextBox                   Width="50" Height="25" Name="mEmotionalColor1" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="657,100,0,0" />
                <TextBox                   Width="50" Height="25" Name="yEmotionalColor1" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="707,100,0,0" />
                <TextBox                   Width="50" Height="25" Name="kEmotionalColor1" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="757,100,0,0" />
                <TextBox IsReadOnly="True" Width="160" Height="25" Name="EmotionalColor2" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="382,125,0,0" />
                <TextBox                   Width="50" Height="25" Name="cEmotionalColor2" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="607,125,0,0" />
                <TextBox                   Width="50" Height="25" Name="mEmotionalColor2" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="657,125,0,0" />
                <TextBox                   Width="50" Height="25" Name="yEmotionalColor2" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="707,125,0,0" />
                <TextBox                   Width="50" Height="25" Name="kEmotionalColor2" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="757,125,0,0" />
                <TextBox IsReadOnly="True" Width="160" Height="25" Name="EmotionalColor3" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="382,150,0,0" />
                <TextBox                   Width="50" Height="25" Name="cEmotionalColor3" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="607,150,0,0" />
                <TextBox                   Width="50" Height="25" Name="mEmotionalColor3" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="657,150,0,0" />
                <TextBox                   Width="50" Height="25" Name="yEmotionalColor3" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="707,150,0,0" />
                <TextBox                   Width="50" Height="25" Name="kEmotionalColor3" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="757,150,0,0" />
                <TextBox IsReadOnly="True" Width="160" Height="25" Name="EmotionalColor4" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="382,175,0,0" />
                <TextBox                   Width="50" Height="25" Name="cEmotionalColor4" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="607,175,0,0" />
                <TextBox                   Width="50" Height="25" Name="mEmotionalColor4" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="657,175,0,0" />
                <TextBox                   Width="50" Height="25" Name="yEmotionalColor4" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="707,175,0,0" RenderTransformOrigin="0.98,0.48" />
                <TextBox                   Width="50" Height="25" Name="kEmotionalColor4" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="757,175,0,0" />
                <TextBox IsReadOnly="True" Width="160" Height="25" Name="IntellectualColor1" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="382,200,0,0" />
                <TextBox                   Width="50" Height="25" Name="cIntellectualColor1" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="607,200,0,0" />
                <TextBox                   Width="50" Height="25" Name="mIntellectualColor1" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="657,200,0,0" />
                <TextBox                   Width="50" Height="25" Name="yIntellectualColor1" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="707,200,0,0" />
                <TextBox                   Width="50" Height="25" Name="kIntellectualColor1" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="757,200,0,0" />
                <TextBox IsReadOnly="True" Width="160" Height="25" Name="IntellectualColor2" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="382,225,0,0" />
                <TextBox                   Width="50" Height="25" Name="cIntellectualColor2" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="607,225,0,0" />
                <TextBox                   Width="50" Height="25" Name="mIntellectualColor2" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="657,225,0,0" />
                <TextBox                   Width="50" Height="25" Name="yIntellectualColor2" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="707,225,0,0" />
                <TextBox                   Width="50" Height="25" Name="kIntellectualColor2" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="757,225,0,0" />
                <TextBox IsReadOnly="True" Width="160" Height="25" Name="IntellectualColor3" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="382,250,0,0" />
                <TextBox                   Width="50" Height="25" Name="cIntellectualColor3" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="607,250,0,0" />
                <TextBox                   Width="50" Height="25" Name="mIntellectualColor3" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="657,250,0,0" />
                <TextBox                   Width="50" Height="25" Name="yIntellectualColor3" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="707,250,0,0" />
                <TextBox                   Width="50" Height="25" Name="kIntellectualColor3" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="757,250,0,0" />
                <TextBox IsReadOnly="True" Width="160" Height="25" Name="IntellectualColor4" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="382,275,0,0" />
                <TextBox                   Width="50" Height="25" Name="cIntellectualColor4" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="607,275,0,0" />
                <TextBox                   Width="50" Height="25" Name="mIntellectualColor4" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="657,275,0,0" />
                <TextBox                   Width="50" Height="25" Name="yIntellectualColor4" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="707,275,0,0" />
                <TextBox                   Width="50" Height="25" Name="kIntellectualColor4" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="757,275,0,0" />

                <Button Width="65"  Height="25" Name="PhysicalButton1" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="542,0,0,0" Click="CMYK2RGB_Click">&lt;--</Button>
                <Button Width="65"  Height="25" Name="PhysicalButton2" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="542,25,0,0" Click="CMYK2RGB_Click">&lt;--</Button>
                <Button Width="65"  Height="25" Name="PhysicalButton3" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="542,50,0,0" Click="CMYK2RGB_Click">&lt;--</Button>
                <Button Width="65"  Height="25" Name="PhysicalButton4" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="542,75,0,0" Click="CMYK2RGB_Click">&lt;--</Button>

                <Button    Width="65"  Height="25" Name="EmotionalButton1" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="542,100,0,0" Click="CMYK2RGB_Click">&lt;--</Button>
                <Button    Width="65"  Height="25" Name="EmotionalButton2" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="542,125,0,0" Click="CMYK2RGB_Click">&lt;--</Button>
                <Button    Width="65"  Height="25" Name="EmotionalButton3" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="542,150,0,0" Click="CMYK2RGB_Click">&lt;--</Button>
                <Button    Width="65"  Height="25" Name="EmotionalButton4" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="542,175,0,0" Click="CMYK2RGB_Click">&lt;--</Button>

                <Button    Width="65"  Height="25" Name="IntellectualButton1" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="542,200,0,0" Click="CMYK2RGB_Click">&lt;--</Button>
                <Button    Width="65"  Height="25" Name="IntellectualButton2" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="542,225,0,0" Click="CMYK2RGB_Click">&lt;--</Button>
                <Button    Width="65"  Height="25" Name="IntellectualButton3" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="542,250,0,0" Click="CMYK2RGB_Click">&lt;--</Button>
                <Button    Width="65"  Height="25" Name="IntellectualButton4" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="542,275,0,0" Click="CMYK2RGB_Click">&lt;--</Button>


                <Button Width="89"  Height="25" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="496,326,0,0" Click="ResetColors_Click" Content="Сброс"/>
                <Button Width="89"  Height="25" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="606,326,0,0" Click="RestoreColors_Click" Content="Восстановить" RenderTransformOrigin="0.494,0.64"/>
                <Button Width="89"  Height="25" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="717,326,0,0" Click="SaveColors_Click" Content="Сохранить"/>

            </Grid>

            
            <Grid Grid.Column="1" comment:Tab="People"
                  DataContext="{StaticResource peopleFilterVM}"
                  Visibility="{Binding IsSelected, Converter={StaticResource BooleanToVisibilityConverter}, ElementName=tabItem}">
                
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <Label Grid.Row="0" Content="Фильтры" FontSize="15" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Background="LightGray"/>

                <ScrollViewer Grid.Row="1">
                    <StackPanel>
                        <Expander Header="Код человека" Padding="5,2">
                            <ListBox 
                                    Margin="-5,0"
                                    x:Name="UserIdsFilterPeopleTab" 
                                    ItemsSource="{Binding Source={StaticResource GetCodesForFilter}}" 
                                    SelectionMode="Multiple">
                                <ListBox.ItemTemplate>
                                    <DataTemplate>
                                        <CheckBox 
                                                Checked="UserIdsFilterPeopleTab_Selected" 
                                                Unchecked="UserIdsFilterPeopleTab_Selected" 
                                                Content="{Binding}" 
                                                IsChecked="{Binding RelativeSource={RelativeSource AncestorType={x:Type ListBoxItem}}, Path=IsSelected}"/>
                                    </DataTemplate>
                                </ListBox.ItemTemplate>
                            </ListBox>
                        </Expander>
                        <Expander Header="Дата рождения" Padding="5,2">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition />
                                    <ColumnDefinition />
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition/>
                                    <RowDefinition/>
                                    <RowDefinition/>
                                </Grid.RowDefinitions>

                                <Label Grid.Row="0" Grid.ColumnSpan="2" Content="Дата рождения" FontWeight="Bold" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" />
                                <Label Grid.Row="1" Grid.Column="0" Content="Начало" HorizontalContentAlignment="Center" VerticalContentAlignment="Center"/>
                                <Label Grid.Row="1" Grid.Column="1" Content="Конец"  HorizontalContentAlignment="Center" VerticalContentAlignment="Center"/>

                                <DatePicker Grid.Row="2" Grid.Column="0" Margin="2,0" SelectedDate="{Binding DateFrom}" />
                                <DatePicker Grid.Row="2" Grid.Column="1" Margin="2,0" SelectedDate="{Binding DateTo}"   />
                            </Grid>
                        </Expander>
                        <Expander Header="Экспедиция" Padding="5,2">
                            <ListBox 
                                    Margin="-5,0"
                                    x:Name="ExpeditionFilterPeopleTab" 
                                    ItemsSource="{Binding Source={StaticResource GetExpeditionCodes}}" 
                                    SelectionMode="Multiple">
                                <ListBox.ItemTemplate>
                                    <DataTemplate>
                                        <CheckBox 
                                                Checked="ExpeditionFilterPeopleTab_Selected" 
                                                Unchecked="ExpeditionFilterPeopleTab_Selected" 
                                                Content="{Binding}" 
                                                IsChecked="{Binding RelativeSource={RelativeSource AncestorType={x:Type ListBoxItem}}, Path=IsSelected}" />
                                    </DataTemplate>
                                </ListBox.ItemTemplate>
                            </ListBox>
                        </Expander>
                        <Expander Header="Номер человека" Padding="5,2">
                            <ListBox 
                                    Margin="-5,0"
                                    x:Name="NumberFilterPeopleTab" 
                                    ItemsSource="{Binding Source={StaticResource GetPeopleCodes}}" 
                                    SelectionMode="Multiple">
                                <ListBox.ItemTemplate>
                                    <DataTemplate>
                                        <CheckBox 
                                                Checked="NumberFilterPeopleTab_Selected" 
                                                Unchecked="NumberFilterPeopleTab_Selected" 
                                                Content="{Binding}" 
                                                IsChecked="{Binding RelativeSource={RelativeSource AncestorType={x:Type ListBoxItem}}, Path=IsSelected}" />
                                    </DataTemplate>
                                </ListBox.ItemTemplate>
                            </ListBox>
                        </Expander>
                        <Expander Header="Профессия" Padding="5,2">
                            <ListBox 
                                    Margin="-5,0"
                                    x:Name="ProfessionFilterPeopleTab" 
                                    ItemsSource="{Binding Source={StaticResource GetProfessionsList}}" 
                                    SelectionMode="Multiple">
                                <ListBox.ItemTemplate>
                                    <DataTemplate>
                                        <CheckBox 
                                                Checked="ProfessionFilterPeopleTab_Selected" 
                                                Unchecked="ProfessionFilterPeopleTab_Selected" 
                                                Content="{Binding}" 
                                                IsChecked="{Binding RelativeSource={RelativeSource AncestorType={x:Type ListBoxItem}}, Path=IsSelected}" />
                                    </DataTemplate>
                                </ListBox.ItemTemplate>
                            </ListBox>
                        </Expander>
                    </StackPanel>
                </ScrollViewer>

                <Grid Grid.Row="2">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition/>
                        <ColumnDefinition />
                    </Grid.ColumnDefinitions>

                    <Button Grid.Column="0" Margin="2" Click="ClearFilterPeopleTab_Click" Content="Сбосить фильтр"  />
                    <Button Grid.Column="1" Margin="2" Click="FilterPeople_Click"         Content="Применить фильтр"/>
                </Grid>
            </Grid>

            <Grid Grid.Column="1" comment:Tab="Preferences" 
                  DataContext="{StaticResource preferenceFilterVM}"
                  Visibility="{Binding IsSelected, Converter={StaticResource BooleanToVisibilityConverter}, ElementName=tabItem1}">
                
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <Label Grid.Row="0" Content="Фильтры" FontSize="15" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Background="LightGray" />

                <ScrollViewer Grid.Row="1" comment:Group="Filters">
                    <StackPanel>
                        <Expander Header="Код человека" Padding="5,2">
                            <ListBox 
                                    Margin="-5,0"
                                    x:Name="UserIdsFilterPreferencesTab" 
                                    ItemsSource="{Binding Source={StaticResource GetCodesForFilter}}" 
                                    SelectionMode="Multiple">
                                <ListBox.ItemTemplate>
                                    <DataTemplate>
                                        <CheckBox 
                                                Checked="UserIdsFilterPreferencesTab_Selected" 
                                                Unchecked="UserIdsFilterPreferencesTab_Selected" 
                                                Content="{Binding}" 
                                                IsChecked="{Binding RelativeSource={RelativeSource AncestorType={x:Type ListBoxItem}}, Path=IsSelected}"/>
                                    </DataTemplate>
                                </ListBox.ItemTemplate>
                            </ListBox>
                        </Expander>
                        <Expander Header="Дата рождения" Padding="5,2">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition />
                                    <ColumnDefinition />
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition/>
                                    <RowDefinition/>
                                    <RowDefinition/>
                                </Grid.RowDefinitions>

                                <Label Grid.Row="0" Grid.ColumnSpan="2" Content="Дата рождения" FontWeight="Bold" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" />
                                <Label Grid.Row="1" Grid.Column="0" Content="Начало" HorizontalContentAlignment="Center" VerticalContentAlignment="Center"/>
                                <Label Grid.Row="1" Grid.Column="1" Content="Конец"  HorizontalContentAlignment="Center" VerticalContentAlignment="Center"/>

                                <DatePicker Grid.Row="2" Grid.Column="0" Margin="2,0" SelectedDate="{Binding DateFrom}" />
                                <DatePicker Grid.Row="2" Grid.Column="1" Margin="2,0" SelectedDate="{Binding DateTo}"   />
                            </Grid>
                        </Expander>
                        <Expander Header="Экспедиция" Padding="5,2">
                            <ListBox 
                                    Margin="-5,0"
                                    x:Name="ExpeditionFilterPreferencesTab" 
                                    ItemsSource="{Binding Source={StaticResource GetExpeditionCodes}}" 
                                    SelectionMode="Multiple">
                                <ListBox.ItemTemplate>
                                    <DataTemplate>
                                        <CheckBox 
                                                Checked="ExpeditionFilterPreferencesTab_Selected" 
                                                Unchecked="ExpeditionFilterPreferencesTab_Selected" 
                                                Content="{Binding}" 
                                                IsChecked="{Binding RelativeSource={RelativeSource AncestorType={x:Type ListBoxItem}}, Path=IsSelected}" />
                                    </DataTemplate>
                                </ListBox.ItemTemplate>
                            </ListBox>
                        </Expander>
                        <Expander Header="Номер человека" Padding="5,2">
                            <ListBox 
                                    Margin="-5,0"
                                    x:Name="NumberFilterPreferencesTab" 
                                    ItemsSource="{Binding Source={StaticResource GetPeopleCodes}}" 
                                    SelectionMode="Multiple">
                                <ListBox.ItemTemplate>
                                    <DataTemplate>
                                        <CheckBox 
                                                Checked="NumberFilterPreferencesTab_Selected" 
                                                Unchecked="NumberFilterPreferencesTab_Selected" 
                                                Content="{Binding}" 
                                                IsChecked="{Binding RelativeSource={RelativeSource AncestorType={x:Type ListBoxItem}}, Path=IsSelected}" />
                                    </DataTemplate>
                                </ListBox.ItemTemplate>
                            </ListBox>
                        </Expander>
                        <Expander Header="Профессия" Padding="5,2">
                            <ListBox 
                                    Margin="-5,0"
                                    x:Name="ProfessionFilterPreferencesTab" 
                                    ItemsSource="{Binding Source={StaticResource GetProfessionsList}}" 
                                    SelectionMode="Multiple">
                                <ListBox.ItemTemplate>
                                    <DataTemplate>
                                        <CheckBox 
                                                Checked="ProfessionFilterPreferencesTab_Selected" 
                                                Unchecked="ProfessionFilterPreferencesTab_Selected" 
                                                Content="{Binding}" 
                                                IsChecked="{Binding RelativeSource={RelativeSource AncestorType={x:Type ListBoxItem}}, Path=IsSelected}" />
                                    </DataTemplate>
                                </ListBox.ItemTemplate>
                            </ListBox>
                        </Expander>
                        <Expander Header="Преференция" Padding="5,2">
                            <ListBox 
                                    Margin="-5,0"
                                    x:Name="PreferenceFilterPreferenceTab" 
                                    ItemsSource="{Binding Source={StaticResource GetPreferencesList}}" 
                                    SelectionMode="Multiple">
                                <ListBox.ItemTemplate>
                                    <DataTemplate>
                                        <CheckBox 
                                                Checked="PreferenceFilterPreferencesTab_Selected" 
                                                Unchecked="PreferenceFilterPreferencesTab_Selected" 
                                                Content="{Binding}" 
                                                IsChecked="{Binding RelativeSource={RelativeSource AncestorType={x:Type ListBoxItem}}, Path=IsSelected}" />
                                    </DataTemplate>
                                </ListBox.ItemTemplate>
                            </ListBox>
                        </Expander>
                        <Expander Header="Расположение карточек" Padding="5,2">
                            <StackPanel>
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition />
                                        <ColumnDefinition />
                                        <ColumnDefinition />
                                    </Grid.ColumnDefinitions>

                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="22"   />
                                    </Grid.RowDefinitions>

                                    <TextBlock Grid.Column="0" HorizontalAlignment="Center" Text="1" />
                                    <TextBlock Grid.Column="1" HorizontalAlignment="Center" Text="2" />
                                    <TextBlock Grid.Column="2" HorizontalAlignment="Center" Text="3" />
                                    <TextBox Grid.Row="1" Grid.Column="0" Margin="15,0" Text="{Binding Color1in3Filter}" />
                                    <TextBox Grid.Row="1" Grid.Column="1" Margin="15,0" Text="{Binding Color1in3Filter}" />
                                    <TextBox Grid.Row="1" Grid.Column="2" Margin="15,0" Text="{Binding Color1in3Filter}" />
                                </Grid>

                                <Grid Margin="5">

                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*" />
                                        <ColumnDefinition Width="*" />
                                        <ColumnDefinition Width="*" />
                                        <ColumnDefinition Width="*" />
                                        <ColumnDefinition Width="*" />
                                        <ColumnDefinition Width="*" />
                                        <ColumnDefinition Width="*" />
                                        <ColumnDefinition Width="*" />
                                        <ColumnDefinition Width="*" />
                                        <ColumnDefinition Width="*" />
                                        <ColumnDefinition Width="*" />
                                        <ColumnDefinition Width="*" />
                                    </Grid.ColumnDefinitions>

                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="auto" />
                                        <RowDefinition Height="auto" />
                                    </Grid.RowDefinitions>

                                    <TextBlock Grid.Row="0" Grid.Column="0"  HorizontalAlignment="Center" Text="1"  />
                                    <TextBlock Grid.Row="0" Grid.Column="1"  HorizontalAlignment="Center" Text="2"  />
                                    <TextBlock Grid.Row="0" Grid.Column="2"  HorizontalAlignment="Center" Text="3"  />
                                    <TextBlock Grid.Row="0" Grid.Column="3"  HorizontalAlignment="Center" Text="4"  />
                                    <TextBlock Grid.Row="0" Grid.Column="4"  HorizontalAlignment="Center" Text="5"  />
                                    <TextBlock Grid.Row="0" Grid.Column="5"  HorizontalAlignment="Center" Text="6"  />
                                    <TextBlock Grid.Row="0" Grid.Column="6"  HorizontalAlignment="Center" Text="7"  />
                                    <TextBlock Grid.Row="0" Grid.Column="7"  HorizontalAlignment="Center" Text="8"  />
                                    <TextBlock Grid.Row="0" Grid.Column="8"  HorizontalAlignment="Center" Text="9"  />
                                    <TextBlock Grid.Row="0" Grid.Column="9"  HorizontalAlignment="Center" Text="10" />
                                    <TextBlock Grid.Row="0" Grid.Column="10" HorizontalAlignment="Center" Text="11" />
                                    <TextBlock Grid.Row="0" Grid.Column="11" HorizontalAlignment="Center" Text="12" />


                                    <TextBox Grid.Row="1" Grid.Column="0"  Text="{Binding Color1in12Filter}" />
                                    <TextBox Grid.Row="1" Grid.Column="1"  Text="{Binding Color2in12Filter}" />
                                    <TextBox Grid.Row="1" Grid.Column="2"  Text="{Binding Color3in12Filter}" />
                                    <TextBox Grid.Row="1" Grid.Column="3"  Text="{Binding Color4in12Filter}" />
                                    <TextBox Grid.Row="1" Grid.Column="4"  Text="{Binding Color5in12Filter}" />
                                    <TextBox Grid.Row="1" Grid.Column="5"  Text="{Binding Color6in12Filter}" />
                                    <TextBox Grid.Row="1" Grid.Column="6"  Text="{Binding Color7in12Filter}" />
                                    <TextBox Grid.Row="1" Grid.Column="7"  Text="{Binding Color8in12Filter}" />
                                    <TextBox Grid.Row="1" Grid.Column="8"  Text="{Binding Color9in12Filter}" />
                                    <TextBox Grid.Row="1" Grid.Column="9"  Text="{Binding Color10in12Filter}" />
                                    <TextBox Grid.Row="1" Grid.Column="10" Text="{Binding Color11in12Filter}" />
                                    <TextBox Grid.Row="1" Grid.Column="11" Text="{Binding Color12in12Filter}" />

                                </Grid>
                            </StackPanel>
                        </Expander>
                    </StackPanel>
                </ScrollViewer>
                <Grid Grid.Row="2" comment:Group="Biocolors">

                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="*" />
                    </Grid.ColumnDefinitions>

                    <ListBox Grid.Column="0" Margin="2">
                        <TextBlock TextAlignment="Center" HorizontalAlignment="Center">Биоколор I</TextBlock>
                        <RadioButton Grid.Column="0" Name="BioColorIHide" HorizontalAlignment="Center">
                            Скрыть
                        </RadioButton>
                        <RadioButton Grid.Column="0" Name="BioColorIThree" HorizontalAlignment="Center" IsChecked="True">
                            3 цвета
                        </RadioButton>
                        <RadioButton Grid.Column="0" Name="BioColorITwelve" HorizontalAlignment="Center">
                            12 цветов
                        </RadioButton>
                    </ListBox>

                    <ListBox Grid.Column="1" Margin="2">
                        <TextBlock TextAlignment="Center" HorizontalAlignment="Center">Биоколор II</TextBlock>
                        <RadioButton Name="BioColorIIHide" Grid.Column="0" HorizontalAlignment="Center">
                            Скрыть
                        </RadioButton>
                        <RadioButton Name="BioColorIITwelve" Grid.Column="0" HorizontalAlignment="Center" IsChecked="True">
                            3 цвета
                        </RadioButton>
                        <RadioButton Name="BioColorIIPictures" Grid.Column="0" HorizontalAlignment="Center">
                            Картинки
                        </RadioButton>
                    </ListBox>
                </Grid>
                <Grid Grid.Row="3" comment:Group="Buttons">
                    <Grid.RowDefinitions>
                        <RowDefinition/>
                        <RowDefinition/>
                        <RowDefinition/>
                    </Grid.RowDefinitions>

                    <Grid.ColumnDefinitions>
                        <ColumnDefinition />
                        <ColumnDefinition />
                    </Grid.ColumnDefinitions>

                    <Button Grid.Row="0"
                        Grid.Column="0"
                        Margin="2"
                        Content="Сбосить фильтр" 
                        Click="ClearFilterPreferenceTab_Click"/>
                    <Button 
                        Grid.Row="0"
                        Grid.Column="1"
                        Margin="2"
                        Content="Применить фильтр"
                        Click="FilterPreference_Click" />
                    <Button 
                        Grid.Row="1"
                        Grid.Column="0" 
                        Margin="2"
                        Content="Диаграма преф.1" 
                        Click="BildChartOnPreference1_Click"/>
                    <Button 
                        Grid.Row="1"
                        Grid.Column="1" 
                        Margin="2"
                        Content="Диаграма преф.2"
                        Click="BildChartOnPreference2_Click" />
                    <!--
                    <Button 
                        Grid.Row="2"
                        Grid.Column="0" 
                        Grid.ColumnSpan="2"
                        Content="Импорт"
                        Click="AddData_OnClick" />
                    -->
                </Grid>
            </Grid>

            <Grid Grid.Column="1" comment:Tab="Feelings"
                  DataContext="{StaticResource subjectiveFeelingFilterVM}"
                  Visibility="{Binding IsSelected, Converter={StaticResource BooleanToVisibilityConverter}, ElementName=tabItem2}">
                
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <Label Grid.Row="0" Content="Фильтры" FontSize="15" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Background="LightGray" />

                <ScrollViewer Grid.Row="1">
                    <StackPanel>
                        <Expander Header="Код человека" Padding="5,2">
                            <ListBox 
                                    Margin="-5,0"
                                    x:Name="UserIdsFilterFeelingsTab" 
                                    ItemsSource="{Binding Source={StaticResource GetCodesForFilter}}" 
                                    SelectionMode="Multiple">
                                <ListBox.ItemTemplate>
                                    <DataTemplate>
                                        <CheckBox 
                                                Checked="UserIdsFilterFeelingsTab_Selected" 
                                                Unchecked="UserIdsFilterFeelingsTab_Selected" 
                                                Content="{Binding}" 
                                                IsChecked="{Binding RelativeSource={RelativeSource AncestorType={x:Type ListBoxItem}}, Path=IsSelected}"/>
                                    </DataTemplate>
                                </ListBox.ItemTemplate>
                            </ListBox>
                        </Expander>
                        <Expander Header="Дата рождения" Padding="5,2">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition />
                                    <ColumnDefinition />
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition/>
                                    <RowDefinition/>
                                    <RowDefinition/>
                                </Grid.RowDefinitions>

                                <Label Grid.Row="0" Grid.ColumnSpan="2" Content="Дата рождения" FontWeight="Bold" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" />
                                <Label Grid.Row="1" Grid.Column="0" Content="Начало" HorizontalContentAlignment="Center" VerticalContentAlignment="Center"/>
                                <Label Grid.Row="1" Grid.Column="1" Content="Конец"  HorizontalContentAlignment="Center" VerticalContentAlignment="Center"/>

                                <DatePicker Grid.Row="2" Grid.Column="0" Margin="2,0" SelectedDate="{Binding DateFrom}" />
                                <DatePicker Grid.Row="2" Grid.Column="1" Margin="2,0" SelectedDate="{Binding DateTo}"   />
                            </Grid>
                        </Expander>
                        <Expander Header="Экспедиция" Padding="5,2">
                            <ListBox 
                                    Margin="-5,0"
                                    x:Name="ExpeditionFilterFeelingsTab" 
                                    ItemsSource="{Binding Source={StaticResource GetExpeditionCodes}}" 
                                    SelectionMode="Multiple">
                                <ListBox.ItemTemplate>
                                    <DataTemplate>
                                        <CheckBox 
                                                Checked="ExpeditionFilterFeelingsTab_Selected" 
                                                Unchecked="ExpeditionFilterFeelingsTab_Selected" 
                                                Content="{Binding}" 
                                                IsChecked="{Binding RelativeSource={RelativeSource AncestorType={x:Type ListBoxItem}}, Path=IsSelected}" />
                                    </DataTemplate>
                                </ListBox.ItemTemplate>
                            </ListBox>
                        </Expander>
                        <Expander Header="Номер человека" Padding="5,2">
                            <ListBox 
                                    Margin="-5,0"
                                    x:Name="NumberFilterFeelingsTab" 
                                    ItemsSource="{Binding Source={StaticResource GetPeopleCodes}}" 
                                    SelectionMode="Multiple">
                                <ListBox.ItemTemplate>
                                    <DataTemplate>
                                        <CheckBox 
                                                Checked="NumberFilterFeelingsTab_Selected" 
                                                Unchecked="NumberFilterFeelingsTab_Selected" 
                                                Content="{Binding}" 
                                                IsChecked="{Binding RelativeSource={RelativeSource AncestorType={x:Type ListBoxItem}}, Path=IsSelected}" />
                                    </DataTemplate>
                                </ListBox.ItemTemplate>
                            </ListBox>
                        </Expander>
                        <Expander Header="Профессия" Padding="5,2">
                            <ListBox 
                                    Margin="-5,0"
                                    x:Name="ProfessionFilterFeelingsTab" 
                                    ItemsSource="{Binding Source={StaticResource GetProfessionsList}}" 
                                    SelectionMode="Multiple">
                                <ListBox.ItemTemplate>
                                    <DataTemplate>
                                        <CheckBox 
                                                Checked="ProfessionFilterFeelingsTab_Selected" 
                                                Unchecked="ProfessionFilterFeelingsTab_Selected" 
                                                Content="{Binding}" 
                                                IsChecked="{Binding RelativeSource={RelativeSource AncestorType={x:Type ListBoxItem}}, Path=IsSelected}" />
                                    </DataTemplate>
                                </ListBox.ItemTemplate>
                            </ListBox>
                        </Expander>
                        <Expander Header="Ощущения" Padding="5,2">
                            <Border BorderBrush="Gray" BorderThickness="0.5" Margin="-5,0" Padding="5">
                                <StackPanel>
                                    <CheckBox Margin="2" Checked="CheckBox_Selected" Content="Учитывать ощущения" IsChecked="{Binding IsFeeling}"  FontWeight="Bold" />
                                    <CheckBox Margin="2" Checked="CheckBox_Selected" Content="Общая слабость" IsChecked="{Binding GeneralWeakness}" />
                                    <CheckBox Margin="2" Checked="CheckBox_Selected" Content="Плохой аппетит" IsChecked="{Binding PoorAppetite}" />
                                    <CheckBox Margin="2" Checked="CheckBox_Selected" Content="Плохой сон" IsChecked="{Binding PoorSleep}" />
                                    <CheckBox Margin="2" Checked="CheckBox_Selected" Content="Плохое настроение" IsChecked="{Binding BadMood}" />
                                    <CheckBox Margin="2" Checked="CheckBox_Selected" Content="Тяжесть в голове" IsChecked="{Binding HeavyHead}" />
                                    <CheckBox Margin="2" Checked="CheckBox_Selected" Content="Замедленное мышление" IsChecked="{Binding SlowThink}" />
                                </StackPanel>
                            </Border>
                        </Expander>
                    </StackPanel>
                </ScrollViewer>
                
                <Grid Grid.Row="2">
                    <Grid.RowDefinitions>
                        <RowDefinition/>
                    </Grid.RowDefinitions>

                    <Grid.ColumnDefinitions>
                        <ColumnDefinition />
                        <ColumnDefinition />
                    </Grid.ColumnDefinitions>

                    <Button Grid.Column="0" Margin="2" Click="ClearFilterSubjFeelTab_Click" Content="Сбосить фильтр" />
                    <Button Grid.Column="1" Margin="2" Click="FilterSubjectiveFeeling_Click" Content="Применить фильтр" />
                </Grid>
            </Grid>

        </Grid>
        </Grid>
</Window>

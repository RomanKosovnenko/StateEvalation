<Window x:Class="StateEvaluation.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:helpers="clr-namespace:StateEvaluation.View.Helpers"
        xmlns:biocolorhelpers="clr-namespace:StateEvaluation.BioColor.Helpers;assembly=StateEvaluation.Biocolor"
        xmlns:repository="clr-namespace:StateEvaluation.Repository.Providers;assembly=StateEvaluation.Repository"
        xmlns:sys="clr-namespace:System;assembly=mscorlib"
        xmlns:viewModel="clr-namespace:StateEvaluation.Common.ViewModel;assembly=StateEvaluation.Common"
        xmlns:comment="Tag to add comments"
        mc:Ignorable="d comment"
        ContentRendered="WindowRendered_Click"
        Title="Оценка состояния" Height="768" Width="1366" WindowState="Maximized">

    <Window.Resources>
        <ObjectDataProvider x:Key="GetPeople" ObjectType="{x:Type repository:DataRepository}" MethodName="GetPeople"></ObjectDataProvider>
        <ObjectDataProvider x:Key="GetPreferences" ObjectType="{x:Type repository:DataRepository}" MethodName="GetPreferenceTests"></ObjectDataProvider>
        <ObjectDataProvider x:Key="GetFeelings" ObjectType="{x:Type repository:DataRepository}" MethodName="GetSubjecriveFeelings"></ObjectDataProvider>
        <ObjectDataProvider x:Key="GetCodesForInsert" ObjectType="{x:Type repository:DataRepository}" MethodName="GetUserIds"></ObjectDataProvider>
        <ObjectDataProvider x:Key="GetCodesForFilter" ObjectType="{x:Type repository:DataRepository}" MethodName="GetUserIdsFilter"></ObjectDataProvider>
        <ObjectDataProvider x:Key="GetPreferencesList" ObjectType="{x:Type repository:DataRepository}" MethodName="PreferencesFilters"></ObjectDataProvider>
        <ObjectDataProvider x:Key="GetProfessionsList" ObjectType="{x:Type repository:DataRepository}" MethodName="GetProfessionsFilter"></ObjectDataProvider>


        <!--here defined resourses' name for exact model-->
        <viewModel:PeopleFilterVM x:Key="peopleFilterVM" />
        <viewModel:SubjectiveFeelingVM x:Key="subjectiveFeelingVM" />
        <viewModel:PeopleVM x:Key="peopleVM" />
        <viewModel:PreferenceVM x:Key="preferenceVM" />
        <viewModel:PreferenceFilterVM x:Key="preferenceFilterVM"/>
        <viewModel:SubjectiveFeelingFilterVM x:Key="subjectiveFeelingFilterVM"/>
        <!---->

        <ObjectDataProvider x:Key="GetPeopleCodes" ObjectType="{x:Type repository:DataRepository}" MethodName="GetPeopleNumbersFilter"></ObjectDataProvider>
        <ObjectDataProvider x:Key="GetExpeditionCodes" ObjectType="{x:Type repository:DataRepository}" MethodName="GetExpeditionCodesFilter"></ObjectDataProvider>
        <ObjectDataProvider x:Key="GetShortColorsNumbersList" ObjectType="{x:Type repository:DataRepository}" MethodName="GetShortColorsNumbersFilters"></ObjectDataProvider>
        <ObjectDataProvider x:Key="GetColorsNumbersList" ObjectType="{x:Type repository:DataRepository}" MethodName="GetColorsNumbersFilters"></ObjectDataProvider>
         
        
        <BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter"/>
        <biocolorhelpers:NameToBrushConverter x:Key="NameToBrushConverter" />
        <biocolorhelpers:NameToMultiBrushConverter x:Key="NameToMultiBrushConverter" />
        <helpers:StringToListConverter x:Key="StringToListConverter" />
        <helpers:NameToImageConverter x:Key="NameToImageConverter" />
        <helpers:DateToSin x:Key="DateToSin" />
        <helpers:BooleanToChecker x:Key="BooleanToChecker" />
        <helpers:NumberToRelax1Converter x:Key="NumberToRelax1Converter" />
        <helpers:NumberToRelax2Converter x:Key="NumberToRelax2Converter" />
        <helpers:PreferenceSameAsRelax x:Key="PreferenceSameAsRelax" />
        <helpers:PreferenceToBrushConverter x:Key="PreferenceToBrushConverter" />
        <helpers:ButtonToVisibilityConverter x:Key="ButtonToVisibilityConverter" />
        <helpers:BooleanToNOTVisibilityConverter x:Key="BooleanToNOTVisibilityConverter" />
        <helpers:TextColorNumberToBrushConverter x:Key="TextColorNumberToBrushConverter"/>
        <helpers:TextTrimmer x:Key="TextTrimmer"/>
        
        <Style TargetType="Button">
            <EventSetter Event="PreviewMouseDown" Handler="Button_MouseDown"/>
            <EventSetter Event="PreviewMouseUp" Handler="Button_MouseUp"/>
        </Style>
        <Style TargetType="DatePickerTextBox">
            <Setter Property="Control.Template">
                <Setter.Value>
                    <ControlTemplate>
                        <TextBox x:Name="PART_TextBox" 
                                 IsReadOnly="True"
                                 Background="Transparent"
                                 BorderThickness="0"
                                 MinWidth="75"
                                 HorizontalContentAlignment="Center"
                                 Text="{Binding Path=SelectedDate, RelativeSource={RelativeSource AncestorType={x:Type DatePicker}}, StringFormat=\{0:d\}, ConverterCulture=uk-UA}" />
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <Style x:Key="styleCalendar" TargetType="{x:Type Calendar}">
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type Calendar}">
                        <Viewbox Height="300"
                                 Width="300">
                            <CalendarItem x:Name="PART_CalendarItem"
                                          Background="{TemplateBinding Background}"
                                          BorderBrush="{TemplateBinding BorderBrush}"
                                          BorderThickness="{TemplateBinding BorderThickness}"/>
                        </Viewbox>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style TargetType="DatePicker">
            <Setter Property="HorizontalContentAlignment" Value="Center"/>
            <Setter Property="VerticalContentAlignment" Value="Center"/>
            <Setter Property="CalendarStyle" Value="{StaticResource styleCalendar}"/>
            <Style.Resources>
                <Style TargetType="Button">
                    <Setter Property="Control.Template">
                        <Setter.Value>
                            <ControlTemplate>
                                <Button x:Name="PART_Button" />
                            </ControlTemplate>
                        </Setter.Value>
                    </Setter>
                </Style>
            </Style.Resources>
        </Style>
        <Style TargetType="CheckBox" x:Key="BigCheckBox">
            <Setter Property="HorizontalAlignment" Value="Center" />
            <Setter Property="LayoutTransform">
                <Setter.Value>
                    <ScaleTransform ScaleX="1.5" ScaleY="1.5"/>
                </Setter.Value>
            </Setter>
        </Style>
        
        <Style TargetType="ComboBoxItem" x:Key="ComboBoxItemColored">
            <!--
            <Setter Property="Foreground" Value="{Binding Converter={StaticResource TextColorNumberToBrushConverter}}" />
            <Setter Property="Background" Value="{Binding Converter={StaticResource NameToMultiBrushConverter}}" />
            -->
            <Style.Triggers>
                <Trigger Property="IsSelected" Value="True">
                    <Setter Property="Foreground" Value="Black" />
                </Trigger>
                <Trigger Property="IsSelected" Value="True">
                    <Setter Property="Foreground" Value="Black" />
                </Trigger>
            </Style.Triggers>
        </Style>
        <Style TargetType="ComboBox" x:Key="ComboBoxColored">
            <Setter Property="MaxDropDownHeight" Value="500"/>
            <Setter Property="ItemContainerStyle" Value="{StaticResource ComboBoxItemColored}"/>
        </Style>
        
        <Style TargetType="Image" x:Key="ImageBigOnHover">
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Height" Value="500"/>
                    <Setter Property="Width" Value="500"/>
                </Trigger>
            </Style.Triggers>
        </Style>
    </Window.Resources>
    
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="120"/>
            <RowDefinition/>
        </Grid.RowDefinitions>
        
        <TabControl x:Name="tabControl" Height="125" VerticalAlignment="Top">
        <TabItem Header="Люди"
                     x:Name="tabItem" IsSelected="True" DataContext="{StaticResource peopleVM}">
                <Grid Background="#FFE5E5E5">
                    <Grid x:Name="PersonAddFormGrid" Margin="10">
                        <Grid.RowDefinitions>
                            <RowDefinition/>
                            <RowDefinition/>
                        </Grid.RowDefinitions>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition/>
                            <ColumnDefinition/>
                            <ColumnDefinition/>
                            <ColumnDefinition/>
                            <ColumnDefinition/>
                            <ColumnDefinition/>
                            <ColumnDefinition/>
                            <ColumnDefinition/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>

                        <Label Grid.Row="0" Grid.Column="0" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Content="Имя"           />
                        <Label Grid.Row="0" Grid.Column="1" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Content="Фамилия"       />
                        <Label Grid.Row="0" Grid.Column="2" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Content="Отчество"      />
                        <Label Grid.Row="0" Grid.Column="3" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Content="День рождения" />
                        <Label Grid.Row="0" Grid.Column="4" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Content="Профессия"     />
                        <Label Grid.Row="0" Grid.Column="5" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Content="Експедиция"    />
                        <Label Grid.Row="0" Grid.Column="6" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Content="Номер"         />

                        <TextBox Text="{Binding Id}" Visibility="Hidden"/>

                        <TextBox    Grid.Row="1" Grid.Column="0" Margin="10,5" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Text="{Binding FirstName}"        />
                        <TextBox    Grid.Row="1" Grid.Column="1" Margin="10,5" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Text="{Binding LastName}"         />
                        <TextBox    Grid.Row="1" Grid.Column="2" Margin="10,5" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Text="{Binding MiddleName}"       />
                        <DatePicker Grid.Row="1" Grid.Column="3" Margin="10,5" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" SelectedDate="{Binding Birthday}" />
                        <TextBox    Grid.Row="1" Grid.Column="4" Margin="10,5" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Text="{Binding Workposition}"     />
                        <TextBox    Grid.Row="1" Grid.Column="5" Margin="10,5" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Text="{Binding Expedition}"       />
                        <TextBox    Grid.Row="1" Grid.Column="6" Margin="10,5" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Text="{Binding PersonNumber}"     />

                        <Button Grid.Row="0" Grid.Column="7" Margin="10,5" Content="Добавить"  Click="CreatePerson_Click" Visibility="Visible" x:Name="AddPersonBtn"    />
                        <Button Grid.Row="0" Grid.Column="7" Margin="10,5" Content="Сохранить" Click="UpdatePerson_Click" Visibility="Hidden"  x:Name="UpdatePersonBtn" />
                        <Button Grid.Row="1" Grid.Column="7" Margin="10,5" Content="Сброс"     Click="ClearInputs_Click"  Visibility="Visible" />
                    </Grid>
                </Grid>
            </TabItem>
        <TabItem Header="Преференции" 
                     x:Name="tabItem1" DataContext="{StaticResource preferenceVM}">
                <Grid Background="#FFE5E5E5">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="75" comment:Column="User, Date Text"/>
                        <ColumnDefinition Width="125" comment:Column="User, Date Selector"/>
                        <ColumnDefinition Width="75" comment:Column="Biocolor Text"/>
                        <ColumnDefinition Width="45" comment:Column="Colors [3]"/>
                        <ColumnDefinition Width="45" comment:Column="Colors [3]"/>
                        <ColumnDefinition Width="45" comment:Column="Colors [3]"/>
                        <ColumnDefinition Width="5" comment:Column="Divider"/>
                        <ColumnDefinition Width="45" comment:Column="Colors [12]"/>
                        <ColumnDefinition Width="45" comment:Column="Colors [12]"/>
                        <ColumnDefinition Width="45" comment:Column="Colors [12]"/>
                        <ColumnDefinition Width="45" comment:Column="Colors [12]"/>
                        <ColumnDefinition Width="45" comment:Column="Colors [12]"/>
                        <ColumnDefinition Width="45" comment:Column="Colors [12]"/>
                        <ColumnDefinition Width="45" comment:Column="Colors [12]"/>
                        <ColumnDefinition Width="45" comment:Column="Colors [12]"/>
                        <ColumnDefinition Width="45" comment:Column="Colors [12]"/>
                        <ColumnDefinition Width="45" comment:Column="Colors [12]"/>
                        <ColumnDefinition Width="45" comment:Column="Colors [12]"/>
                        <ColumnDefinition Width="45" comment:Column="Colors [12]"/>
                        <ColumnDefinition Width="40" comment:Column="Preference"/>
                        <ColumnDefinition Width="50" comment:Column="Preference"/>
                        <ColumnDefinition Width="50" comment:Column="Preference"/>
                        <ColumnDefinition Width="70" comment:Column="Preference"/>
                        <ColumnDefinition Width="50" comment:Column="Relax"/>
                        <ColumnDefinition Width="125" comment:Column="Buttons"/>
                    </Grid.ColumnDefinitions>

                    <Grid.RowDefinitions>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="30"/>
                        <RowDefinition Height="30"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>
                
                    <TextBlock x:Name="TestID" Text="{Binding Id}" Visibility="Hidden"/>

                    <TextBlock Grid.Row="0" Grid.Column="03" HorizontalAlignment="Center" VerticalAlignment="Center" Text="1" />
                    <TextBlock Grid.Row="0" Grid.Column="04" HorizontalAlignment="Center" VerticalAlignment="Center" Text="2" />
                    <TextBlock Grid.Row="0" Grid.Column="05" HorizontalAlignment="Center" VerticalAlignment="Center" Text="3" />
                    <TextBlock Grid.Row="0" Grid.Column="07" HorizontalAlignment="Center" VerticalAlignment="Center" Text="1" />
                    <TextBlock Grid.Row="0" Grid.Column="08" HorizontalAlignment="Center" VerticalAlignment="Center" Text="2" />
                    <TextBlock Grid.Row="0" Grid.Column="09" HorizontalAlignment="Center" VerticalAlignment="Center" Text="3" />
                    <TextBlock Grid.Row="0" Grid.Column="10" HorizontalAlignment="Center" VerticalAlignment="Center" Text="4" />
                    <TextBlock Grid.Row="0" Grid.Column="11" HorizontalAlignment="Center" VerticalAlignment="Center" Text="5" />
                    <TextBlock Grid.Row="0" Grid.Column="12" HorizontalAlignment="Center" VerticalAlignment="Center" Text="6" />
                    <TextBlock Grid.Row="0" Grid.Column="13" HorizontalAlignment="Center" VerticalAlignment="Center" Text="7" />
                    <TextBlock Grid.Row="0" Grid.Column="14" HorizontalAlignment="Center" VerticalAlignment="Center" Text="8" />
                    <TextBlock Grid.Row="0" Grid.Column="15" HorizontalAlignment="Center" VerticalAlignment="Center" Text="9" />
                    <TextBlock Grid.Row="0" Grid.Column="16" HorizontalAlignment="Center" VerticalAlignment="Center" Text="10" />
                    <TextBlock Grid.Row="0" Grid.Column="17" HorizontalAlignment="Center" VerticalAlignment="Center" Text="11" />
                    <TextBlock Grid.Row="0" Grid.Column="18" HorizontalAlignment="Center" VerticalAlignment="Center" Text="12" />
                    <TextBlock Grid.Row="0" Grid.Column="19" HorizontalAlignment="Center" VerticalAlignment="Center" Text="Синяя" />
                    <TextBlock Grid.Row="0" Grid.Column="20" HorizontalAlignment="Center" VerticalAlignment="Center" Text="Желтая" />
                    <TextBlock Grid.Row="0" Grid.Column="21" HorizontalAlignment="Center" VerticalAlignment="Center" Text="Красная" />
                    <TextBlock Grid.Row="0" Grid.Column="22" HorizontalAlignment="Center" VerticalAlignment="Center" Text="Смешанная" />
                    <TextBlock Grid.Row="0" Grid.Column="23" HorizontalAlignment="Center" VerticalAlignment="Center" Text="Релакс" />

                    <TextBlock Grid.Row="1" Grid.Column="0" HorizontalAlignment="Center" VerticalAlignment="Center" Text="Код"  />
                    <ComboBox  Grid.Row="1" Grid.Column="1" Margin="0,2,10,2" x:Name="UserIdsInsertPreferenceCB" ItemsSource="{Binding Source={StaticResource GetCodesForInsert}}" SelectedValue="{Binding UserId}" />
                    <TextBlock Grid.Row="1" Grid.Column="2" HorizontalAlignment="Center" VerticalAlignment="Center" Text="Биоколор 1" />
                    <!-- Bio1 - 3 -->
                    <ComboBox Grid.Row="1" Grid.Column="3" Margin="2" x:Name="selectorC1in3" SelectionChanged="BioColor_SelectionChanged" Tag="shortOrder1" Style="{StaticResource ComboBoxColored}" SelectedValue="{Binding Color1in3}" />
                    <ComboBox Grid.Row="1" Grid.Column="4" Margin="2" x:Name="selectorC2in3" SelectionChanged="BioColor_SelectionChanged" Tag="shortOrder1" Style="{StaticResource ComboBoxColored}" SelectedValue="{Binding Color2in3}" />
                    <ComboBox Grid.Row="1" Grid.Column="5" Margin="2" x:Name="selectorC3in3" SelectionChanged="BioColor_SelectionChanged" Tag="shortOrder1" Style="{StaticResource ComboBoxColored}" SelectedValue="{Binding Color3in3}" />
                    <!-- Bio1 - 12 -->
                    <ComboBox Grid.Row="1" Grid.Column="07" Margin="2" x:Name="selectorC1in12"  SelectionChanged="BioColor_SelectionChanged" Tag="longOrder1" Style="{StaticResource ComboBoxColored}" SelectedValue="{Binding Color1in12}" />
                    <ComboBox Grid.Row="1" Grid.Column="08" Margin="2" x:Name="selectorC2in12"  SelectionChanged="BioColor_SelectionChanged" Tag="longOrder1" Style="{StaticResource ComboBoxColored}" SelectedValue="{Binding Color2in12}" />
                    <ComboBox Grid.Row="1" Grid.Column="09" Margin="2" x:Name="selectorC3in12"  SelectionChanged="BioColor_SelectionChanged" Tag="longOrder1" Style="{StaticResource ComboBoxColored}" SelectedValue="{Binding Color3in12}" />
                    <ComboBox Grid.Row="1" Grid.Column="10" Margin="2" x:Name="selectorC4in12"  SelectionChanged="BioColor_SelectionChanged" Tag="longOrder1" Style="{StaticResource ComboBoxColored}" SelectedValue="{Binding Color4in12}" />
                    <ComboBox Grid.Row="1" Grid.Column="11" Margin="2" x:Name="selectorC5in12"  SelectionChanged="BioColor_SelectionChanged" Tag="longOrder1" Style="{StaticResource ComboBoxColored}" SelectedValue="{Binding Color5in12}" />
                    <ComboBox Grid.Row="1" Grid.Column="12" Margin="2" x:Name="selectorC6in12"  SelectionChanged="BioColor_SelectionChanged" Tag="longOrder1" Style="{StaticResource ComboBoxColored}" SelectedValue="{Binding Color6in12}" />
                    <ComboBox Grid.Row="1" Grid.Column="13" Margin="2" x:Name="selectorC7in12"  SelectionChanged="BioColor_SelectionChanged" Tag="longOrder1" Style="{StaticResource ComboBoxColored}" SelectedValue="{Binding Color7in12}" />
                    <ComboBox Grid.Row="1" Grid.Column="14" Margin="2" x:Name="selectorC8in12"  SelectionChanged="BioColor_SelectionChanged" Tag="longOrder1" Style="{StaticResource ComboBoxColored}" SelectedValue="{Binding Color8in12}" />
                    <ComboBox Grid.Row="1" Grid.Column="15" Margin="2" x:Name="selectorC9in12"  SelectionChanged="BioColor_SelectionChanged" Tag="longOrder1" Style="{StaticResource ComboBoxColored}" SelectedValue="{Binding Color9in12}" />
                    <ComboBox Grid.Row="1" Grid.Column="16" Margin="2" x:Name="selectorC10in12" SelectionChanged="BioColor_SelectionChanged" Tag="longOrder1" Style="{StaticResource ComboBoxColored}" SelectedValue="{Binding Color10in12}" />
                    <ComboBox Grid.Row="1" Grid.Column="17" Margin="2" x:Name="selectorC11in12" SelectionChanged="BioColor_SelectionChanged" Tag="longOrder1" Style="{StaticResource ComboBoxColored}" SelectedValue="{Binding Color11in12}" />
                    <ComboBox Grid.Row="1" Grid.Column="18" Margin="2" x:Name="selectorC12in12" SelectionChanged="BioColor_SelectionChanged" Tag="longOrder1" Style="{StaticResource ComboBoxColored}" SelectedValue="{Binding Color12in12}" />
                    <!-- Bio1 - Pref -->
                    <RadioButton Grid.Row="1" Grid.Column="19" Margin="2" x:Name="RedStat"    HorizontalAlignment="Center" VerticalAlignment="Center" GroupName="Pref1" IsChecked="{Binding Preference1Blue}"  />
                    <RadioButton Grid.Row="1" Grid.Column="20" Margin="2" x:Name="YellowStat" HorizontalAlignment="Center" VerticalAlignment="Center" GroupName="Pref1" IsChecked="{Binding Preference1Yellow}"/>
                    <RadioButton Grid.Row="1" Grid.Column="21" Margin="2" x:Name="BlueStat"   HorizontalAlignment="Center" VerticalAlignment="Center" GroupName="Pref1" IsChecked="{Binding Preference1Red}"   />
                    <RadioButton Grid.Row="1" Grid.Column="22" Margin="2" x:Name="GrayStat"   HorizontalAlignment="Center" VerticalAlignment="Center" GroupName="Pref1" IsChecked="{Binding Preference1Grey}"  />
                    <!-- Bio1 - R -->
                    <ComboBox Grid.Row="1" Grid.Column="23" Margin="2" x:Name="selectorRelax1" ItemsSource="{Binding Source={StaticResource GetColorsNumbersList}}" SelectedValue="{Binding ColorRelax1}" />


                    <TextBlock Grid.Row="2" Grid.Column="0" HorizontalAlignment="Center" VerticalAlignment="Center" Text="Дата" />
                    <DatePicker Grid.Row="2" Grid.Column="1" Margin="0,2,10,2" x:Name="dateTimeForTest" SelectedDate="{Binding TestDate}" />
                    <TextBlock  Grid.Row="2" Grid.Column="2" Margin="5" VerticalAlignment="Center" HorizontalAlignment="Center" Text="Биоколор 2" />
                    <!-- Bio2 - 3 -->
                    <ComboBox Grid.Row="2" Grid.Column="3" Margin="2" x:Name="selectorC21in3" SelectionChanged="BioColor_SelectionChanged" Tag="shortOrder2" Style="{StaticResource ComboBoxColored}" SelectedValue="{Binding Color21in3}" />
                    <ComboBox Grid.Row="2" Grid.Column="4" Margin="2" x:Name="selectorC22in3" SelectionChanged="BioColor_SelectionChanged" Tag="shortOrder2" Style="{StaticResource ComboBoxColored}" SelectedValue="{Binding Color22in3}" />
                    <ComboBox Grid.Row="2" Grid.Column="5" Margin="2" x:Name="selectorC23in3" SelectionChanged="BioColor_SelectionChanged" Tag="shortOrder2" Style="{StaticResource ComboBoxColored}" SelectedValue="{Binding Color23in3}" />
                    <!-- Bio2 - 12 -->
                    <ComboBox Grid.Row="2" Grid.Column="07" Margin="2" x:Name="selectorC21in12"  SelectionChanged="BioColor_SelectionChanged" Tag="longOrder2" Style="{StaticResource ComboBoxColored}" SelectedValue="{Binding Color21in12}" />
                    <ComboBox Grid.Row="2" Grid.Column="08" Margin="2" x:Name="selectorC22in12"  SelectionChanged="BioColor_SelectionChanged" Tag="longOrder2" Style="{StaticResource ComboBoxColored}" SelectedValue="{Binding Color22in12}" />
                    <ComboBox Grid.Row="2" Grid.Column="09" Margin="2" x:Name="selectorC23in12"  SelectionChanged="BioColor_SelectionChanged" Tag="longOrder2" Style="{StaticResource ComboBoxColored}" SelectedValue="{Binding Color23in12}" />
                    <ComboBox Grid.Row="2" Grid.Column="10" Margin="2" x:Name="selectorC24in12"  SelectionChanged="BioColor_SelectionChanged" Tag="longOrder2" Style="{StaticResource ComboBoxColored}" SelectedValue="{Binding Color24in12}" />
                    <ComboBox Grid.Row="2" Grid.Column="11" Margin="2" x:Name="selectorC25in12"  SelectionChanged="BioColor_SelectionChanged" Tag="longOrder2" Style="{StaticResource ComboBoxColored}" SelectedValue="{Binding Color25in12}" />
                    <ComboBox Grid.Row="2" Grid.Column="12" Margin="2" x:Name="selectorC26in12"  SelectionChanged="BioColor_SelectionChanged" Tag="longOrder2" Style="{StaticResource ComboBoxColored}" SelectedValue="{Binding Color26in12}" />
                    <ComboBox Grid.Row="2" Grid.Column="13" Margin="2" x:Name="selectorC27in12"  SelectionChanged="BioColor_SelectionChanged" Tag="longOrder2" Style="{StaticResource ComboBoxColored}" SelectedValue="{Binding Color27in12}" />
                    <ComboBox Grid.Row="2" Grid.Column="14" Margin="2" x:Name="selectorC28in12"  SelectionChanged="BioColor_SelectionChanged" Tag="longOrder2" Style="{StaticResource ComboBoxColored}" SelectedValue="{Binding Color28in12}" />
                    <ComboBox Grid.Row="2" Grid.Column="15" Margin="2" x:Name="selectorC29in12"  SelectionChanged="BioColor_SelectionChanged" Tag="longOrder2" Style="{StaticResource ComboBoxColored}" SelectedValue="{Binding Color29in12}" />
                    <ComboBox Grid.Row="2" Grid.Column="16" Margin="2" x:Name="selectorC210in12" SelectionChanged="BioColor_SelectionChanged" Tag="longOrder2" Style="{StaticResource ComboBoxColored}" SelectedValue="{Binding Color210in12}" />
                    <ComboBox Grid.Row="2" Grid.Column="17" Margin="2" x:Name="selectorC211in12" SelectionChanged="BioColor_SelectionChanged" Tag="longOrder2" Style="{StaticResource ComboBoxColored}" SelectedValue="{Binding Color211in12}" />
                    <ComboBox Grid.Row="2" Grid.Column="18" Margin="2" x:Name="selectorC212in12" SelectionChanged="BioColor_SelectionChanged" Tag="longOrder2" Style="{StaticResource ComboBoxColored}" SelectedValue="{Binding Color212in12}" />
                    <!-- Bio2 - Pref -->
                    <RadioButton Grid.Row="2" Grid.Column="19" Margin="2" x:Name="Blue2Stat"   HorizontalAlignment="Center" VerticalAlignment="Center" GroupName="Pref2" IsChecked="{Binding Preference2Blue}"  />
                    <RadioButton Grid.Row="2" Grid.Column="20" Margin="2" x:Name="Yellow2Stat" HorizontalAlignment="Center" VerticalAlignment="Center" GroupName="Pref2" IsChecked="{Binding Preference2Yellow}"/>
                    <RadioButton Grid.Row="2" Grid.Column="21" Margin="2" x:Name="Red2Stat"    HorizontalAlignment="Center" VerticalAlignment="Center" GroupName="Pref2" IsChecked="{Binding Preference2Red}"   />
                    <RadioButton Grid.Row="2" Grid.Column="22" Margin="2" x:Name="Gray2Stat"   HorizontalAlignment="Center" VerticalAlignment="Center" GroupName="Pref2" IsChecked="{Binding Preference2Grey}"  />
                    <!-- Bio2 - R -->
                    <ComboBox Grid.Row="2" Grid.Column="23" Margin="2" x:Name="selectorRelax2" ItemsSource="{Binding Source={StaticResource GetColorsNumbersList}}" SelectedValue="{Binding ColorRelax2}"/>
                    <!-- End -->

                    <Button Grid.Row="1" Grid.Column="24" Margin="2" Click="CreatePreferense_Click" Content="Добавить запись" />
                    <Button Grid.Row="1" Grid.Column="24" Margin="2" x:Name="UpdatePrefernceBtn" Click="UpdatePreference_Click" Content="Применить" Visibility="Hidden"/>
                    <Button Grid.Row="2" Grid.Column="24" Margin="2" Click="ClearPreferenceInputs_Click" Content="Сброс выбора"  />
                </Grid>
        </TabItem>
        <TabItem Header="Субъективные ощущения"
                     x:Name="tabItem2" DataContext="{StaticResource subjectiveFeelingVM}">
            <Grid x:Name="DataFridSubjectiveFeelings" Background="#FFE5E5E5">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="105"/>
                    <ColumnDefinition Width="125"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="150"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                <Grid.RowDefinitions>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="30"/>
                    <RowDefinition Height="30"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>

                <TextBox Text="{Binding Id}" Visibility="Hidden"/>

                <TextBlock Grid.Row="1" Grid.Column="0" Margin="5" HorizontalAlignment="Center" VerticalAlignment="Center" Text="Код" />
                <TextBlock Grid.Row="1" Grid.Column="1" Margin="5" HorizontalAlignment="Center" VerticalAlignment="Center" Text="Дата" />
                <TextBlock Grid.Row="1" Grid.Column="2" Margin="5" HorizontalAlignment="Center" VerticalAlignment="Center" Text="Общая слабость" />
                <TextBlock Grid.Row="1" Grid.Column="3" Margin="5" HorizontalAlignment="Center" VerticalAlignment="Center" Text="Плохой аппетит" />
                <TextBlock Grid.Row="1" Grid.Column="4" Margin="5" HorizontalAlignment="Center" VerticalAlignment="Center" Text="Плохой сон" />
                <TextBlock Grid.Row="1" Grid.Column="5" Margin="5" HorizontalAlignment="Center" VerticalAlignment="Center" Text="Плохое настроение" />
                <TextBlock Grid.Row="1" Grid.Column="6" Margin="5" HorizontalAlignment="Center" VerticalAlignment="Center" Text="Тяжесть в голове" />
                <TextBlock Grid.Row="1" Grid.Column="7" Margin="5" HorizontalAlignment="Center" VerticalAlignment="Center" Text="Замедленное мышление" />

                <ComboBox   Grid.Row="2" Grid.Column="0" Margin="2" Width="100" x:Name="UserIdsInsertSubjFeelCB" ItemsSource="{Binding Source={StaticResource GetCodesForInsert}}" SelectedValue="{Binding UserId}"/>
                <DatePicker Grid.Row="2" Grid.Column="1" Margin="2" Width="110" x:Name="selectedDateInSubjectiveFeeling" SelectedDate="{Binding Date}" />
                <CheckBox   Grid.Row="2" Grid.Column="2" HorizontalAlignment="Center" VerticalAlignment="Center" Style="{StaticResource BigCheckBox}" x:Name="markGeneralWeakness" IsChecked="{Binding GeneralWeaknes}" />
                <CheckBox   Grid.Row="2" Grid.Column="3" HorizontalAlignment="Center" VerticalAlignment="Center" Style="{StaticResource BigCheckBox}" x:Name="markBadAppetite"     IsChecked="{Binding PoorAppetite}"   />
                <CheckBox   Grid.Row="2" Grid.Column="4" HorizontalAlignment="Center" VerticalAlignment="Center" Style="{StaticResource BigCheckBox}" x:Name="markBadDream"        IsChecked="{Binding PoorSleep}"      />
                <CheckBox   Grid.Row="2" Grid.Column="5" HorizontalAlignment="Center" VerticalAlignment="Center" Style="{StaticResource BigCheckBox}" x:Name="markBadMood"         IsChecked="{Binding BadMood}"        />
                <CheckBox   Grid.Row="2" Grid.Column="6" HorizontalAlignment="Center" VerticalAlignment="Center" Style="{StaticResource BigCheckBox}" x:Name="markHeavyHead"       IsChecked="{Binding HeavyHead}"      />
                <CheckBox   Grid.Row="2" Grid.Column="7" HorizontalAlignment="Center" VerticalAlignment="Center" Style="{StaticResource BigCheckBox}" x:Name="markSlowThink"       IsChecked="{Binding SlowThink}"      />

                <Button Grid.Row="1" Grid.Column="8" Margin="2" Click="CreateSubjectiveFeeling_Click" Content="Добавить запись" Visibility="Visible" />
                <Button Grid.Row="1" Grid.Column="8" Margin="2" Click="UpdateSubjectiveFeeling_Click" Content="Применить"       Visibility="Hidden"  x:Name="UpdateSubjectiveFeelingBtn"/>
                <Button Grid.Row="2" Grid.Column="8" Margin="2" Click="ClearSubjectiveFeelingInputs_Click" Content="Сброс" />
            </Grid>
        </TabItem>
        <TabItem Header="Биоколор" 
                     x:Name="tabItem3">
            <Grid Background="#FFE5E5E5">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="50"/>
                    <ColumnDefinition Width="Auto" MinWidth="150"/>
                    <ColumnDefinition Width="Auto" MinWidth="150"/>
                    <ColumnDefinition Width="50"/>
                    <ColumnDefinition Width="Auto" MinWidth="125"/>
                    <ColumnDefinition Width="50"/>
                    <ColumnDefinition Width="Auto" MinWidth="75"/>
                    <ColumnDefinition Width="Auto" MinWidth="75"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>
                <Grid.RowDefinitions>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="30"/>
                    <RowDefinition Height="30"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>

                <Label Grid.Row="1" Grid.Column="1" HorizontalAlignment="Center" VerticalAlignment="Center" Content="Дата рождения"/>
                <Label Grid.Row="1" Grid.Column="2" HorizontalAlignment="Center" VerticalAlignment="Center" Content="Дата расчета"/>

                <DatePicker Grid.Row="2" Grid.Column="1" Margin="5,2" Name="Date" />
                <DatePicker Grid.Row="2" Grid.Column="2" Margin="5,2" Name="DateNow" SelectedDate="{x:Static sys:DateTime.Now}"/>

                <Button Grid.Row="2" Grid.Column="4" Margin="2" Click="DrawGraphs_Click" Content="Построить графики"/>
                <Button Grid.Row="2" Grid.Column="6" Margin="2" Click="Prew_Click" Content="Назад" />
                <Button Grid.Row="2" Grid.Column="7" Margin="2" Click="Next_Click" Content="Вперед"/>


            </Grid>
        </TabItem>
        <TabItem Header="Цвета" 
                     x:Name="ColorSettingsTab"/>
        </TabControl>

        <Grid Grid.Row="1">
            <Grid.ColumnDefinitions>
                <ColumnDefinition/>
                <ColumnDefinition MaxWidth="250"/>
            </Grid.ColumnDefinitions>

            <DataGrid comment:Tab="People Grid" CellEditEnding="PeopleDataGrid_CellEditEnding"
                      x:Name="PeopleDataGrid" CanUserAddRows="False" CanUserDeleteRows="False" ItemsSource="{Binding Source={StaticResource GetPeople}}" IsSynchronizedWithCurrentItem="True" AutoGenerateColumns="False">
                <DataGrid.Columns>
                    <DataGridTextColumn Binding="{Binding Id}" Visibility="Hidden"/>
                    <DataGridTemplateColumn>
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>
                                <Button x:Name="RemovePersonBtn" Content="&#xE107;" FontFamily="Segoe MDL2 Assets" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" BorderBrush="White" Background="White" Foreground="Red" FontSize="14" Click="RemovePerson_Click"/>
                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>
                    </DataGridTemplateColumn>
                    <DataGridTemplateColumn Visibility="Hidden">
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>
                                <Button x:Name="EditPersonBtn" Content="&#xE70F;" FontFamily="Segoe MDL2 Assets" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" BorderBrush="White" Background="White" Foreground="Black" FontSize="14" Click="BindPersonInForm_Click" Tag="{Binding Id}"/>
                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>
                    </DataGridTemplateColumn>
                    <DataGridTextColumn Header="Код" Binding="{Binding UserId}" x:Name="PeopleUserId" IsReadOnly="True"/>
                    <DataGridTextColumn Header="Имя" Binding="{Binding Firstname}" />
                    <DataGridTextColumn Header="Фамилия" Binding="{Binding Lastname}" />
                    <DataGridTextColumn Header="Отчество" Binding="{Binding Middlename}" />
                    <DataGridTextColumn Header="День рождения" Binding="{Binding Birthday, StringFormat=\{0:d\}}" />
                    <DataGridTextColumn Header="Профессия" Binding="{Binding Workposition}" />
                    <DataGridTextColumn IsReadOnly="True" Header="Експедиция" Binding="{Binding Expedition}" />
                    <DataGridTextColumn IsReadOnly="True" Header="Номер" Binding="{Binding Number}" />
                </DataGrid.Columns>
            </DataGrid>
            <DataGrid comment:Tab="Preferences Grid"
                      x:Name="PreferencesDataGrid" IsReadOnly="True" SelectionChanged="PreferencesDataGrid_Selected" CanUserAddRows="False" RowHeight="40" ItemsSource="{Binding Source={StaticResource GetPreferences}}" IsSynchronizedWithCurrentItem="True" AutoGenerateColumns="False" Visibility="{Binding IsSelected, Converter={StaticResource BooleanToVisibilityConverter}, ElementName=tabItem1}">
                <DataGrid.Columns>
                    <DataGridTextColumn Binding="{Binding Id}" Visibility="Hidden"/>
                    <DataGridTemplateColumn ClipboardContentBinding="{x:Null}">
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>
                                <Button x:Name="RemovePreferenceBtn" Content="&#xE107;" FontFamily="Segoe MDL2 Assets" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" BorderBrush="White" Background="White" Foreground="Red" FontSize="14" Click="RemovePreference_Click"/>
                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>
                    </DataGridTemplateColumn>
                    <DataGridTemplateColumn ClipboardContentBinding="{x:Null}">
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>
                                <Button x:Name="EditPreferenceBtn" Content="&#xE70F;" FontFamily="Segoe MDL2 Assets" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" BorderBrush="White" Background="White" Foreground="Black" FontSize="14" Click="BindPreferenceInForm_Click" Tag="{Binding Id}"/>
                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>
                    </DataGridTemplateColumn>
                    <DataGridTextColumn Header="Код" Binding="{Binding UserId}" ClipboardContentBinding="{x:Null}" FontSize="14"/>
                    <DataGridTextColumn Header="Дата" Binding="{Binding Date, StringFormat=\{0:d\}, ConverterCulture=uk-UA}" ClipboardContentBinding="{x:Null}"/>
                    <!-- BioColor I START -->
                    <!-- BioColor I (Three) -->
                    <DataGridTemplateColumn Header="Короткий 1" ClipboardContentBinding="{x:Null}"
                                                 Visibility="{Binding Path=IsChecked, Source={x:Reference BioColorIHide}, Converter={StaticResource BooleanToNOTVisibilityConverter}}">
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>
                                <ListView ItemsSource="{Binding ShortOder1, Converter={StaticResource StringToListConverter}}">
                                    <ListView.ItemTemplate>
                                        <DataTemplate>
                                            <Label Content="{Binding}" Foreground="{Binding Content, Converter={StaticResource TextColorNumberToBrushConverter}, RelativeSource={RelativeSource Self}}"  Background="{Binding Content,Converter={StaticResource NameToBrushConverter}, IsAsync=True, NotifyOnTargetUpdated=True, NotifyOnSourceUpdated=True, NotifyOnValidationError=True, RelativeSource={RelativeSource Self}, ValidatesOnNotifyDataErrors=False}" BorderBrush="Black" BorderThickness="1" MinWidth="25"></Label>
                                        </DataTemplate>
                                    </ListView.ItemTemplate>
                                    <ListView.ItemsPanel>
                                        <ItemsPanelTemplate>
                                            <StackPanel Orientation="Horizontal"></StackPanel>
                                        </ItemsPanelTemplate>
                                    </ListView.ItemsPanel>
                                </ListView>
                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>
                    </DataGridTemplateColumn>

                    <DataGridTemplateColumn ClipboardContentBinding="{x:Null}"/>
                    <!-- BioColor I (ThreeColor) -->
                    <DataGridTemplateColumn Header="Биоколор 1" ClipboardContentBinding="{x:Null}" MinWidth="280"
                                                 Visibility="{Binding Path=IsChecked, Source={x:Reference BioColorIThree}, Converter={StaticResource BooleanToVisibilityConverter}}">
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>
                                <ListView ItemsSource="{Binding Oder1, Converter={StaticResource StringToListConverter}}" Padding="-4,0,0,0" HorizontalAlignment="Left" MinWidth="270">
                                    <ListView.ItemTemplate>
                                        <DataTemplate>
                                            <Label Content="{Binding}" Foreground="{Binding Content, Converter={StaticResource TextColorNumberToBrushConverter}, RelativeSource={RelativeSource Self}}" Background="{Binding Content,Converter={StaticResource NameToBrushConverter}, IsAsync=True, NotifyOnTargetUpdated=True, NotifyOnSourceUpdated=True, NotifyOnValidationError=True, RelativeSource={RelativeSource Self}, ValidatesOnNotifyDataErrors=False}" BorderBrush="Black" BorderThickness="1" MinWidth="25"></Label>
                                        </DataTemplate>
                                    </ListView.ItemTemplate>
                                    <ListView.ItemsPanel>
                                        <ItemsPanelTemplate>
                                            <StackPanel Orientation="Horizontal"></StackPanel>
                                        </ItemsPanelTemplate>
                                    </ListView.ItemsPanel>
                                </ListView>
                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>
                    </DataGridTemplateColumn>

                    <!-- BioColor I (TwelveColor) -->
                    <DataGridTemplateColumn Header="Биоколор 2" ClipboardContentBinding="{x:Null}" MinWidth="280"
                                             Visibility="{Binding Path=IsChecked, Source={x:Reference BioColorITwelve}, Converter={StaticResource BooleanToVisibilityConverter}}">
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>
                                <ListView ItemsSource="{Binding Oder1, Converter={StaticResource StringToListConverter}}" Padding="-4,0,0,0" HorizontalAlignment="Left" MinWidth="270">
                                    <ListView.ItemTemplate>
                                        <DataTemplate>
                                            <Label Content="{Binding}" Foreground="{Binding Content, Converter={StaticResource TextColorNumberToBrushConverter}, RelativeSource={RelativeSource Self}}" 
											Background="{Binding Content, Converter={StaticResource NameToMultiBrushConverter}, IsAsync=True, NotifyOnTargetUpdated=True, NotifyOnSourceUpdated=True, NotifyOnValidationError=True, RelativeSource={RelativeSource Self}, ValidatesOnNotifyDataErrors=False}" BorderBrush="Black" BorderThickness="1" MinWidth="25"></Label>
                                        </DataTemplate>
                                    </ListView.ItemTemplate>
                                    <ListView.ItemsPanel>
                                        <ItemsPanelTemplate>
                                            <StackPanel Orientation="Horizontal"></StackPanel>
                                        </ItemsPanelTemplate>
                                    </ListView.ItemsPanel>
                                </ListView>
                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>
                    </DataGridTemplateColumn>

                    <!-- Preference1 -->
                    <DataGridTextColumn x:Name="Pre1" Header="Преференция 1" Binding="{Binding Preference1}" ClipboardContentBinding="{x:Null}"
                                        Visibility="{Binding Path=IsChecked, Source={x:Reference BioColorIHide}, Converter={StaticResource BooleanToNOTVisibilityConverter}}">
                        <DataGridTextColumn.ElementStyle>
                            <Style TargetType="{x:Type TextBlock}">
                                <Setter Property="Background" Value="{Binding Preference1, Converter={StaticResource PreferenceToBrushConverter}}" />
                                <Setter Property="TextAlignment" Value="Center"></Setter>
                            </Style>
                        </DataGridTextColumn.ElementStyle>
                    </DataGridTextColumn>
                    <!-- BioColor I END -->

                    <DataGridTemplateColumn ClipboardContentBinding="{x:Null}"/>
                    <!-- BioColor II START -->
                    <!-- BioColor II (Three) -->
                    <DataGridTemplateColumn Header="Короткий 2" ClipboardContentBinding="{x:Null}"
                                                 Visibility="{Binding Path=IsChecked, Source={x:Reference BioColorIITwelve}, Converter={StaticResource BooleanToVisibilityConverter}}">
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>
                                <ListView ItemsSource="{Binding ShortOder2, Converter={StaticResource StringToListConverter}}">
                                    <ListView.ItemTemplate>
                                        <DataTemplate>
                                            <Label Content="{Binding}" Foreground="{Binding Content, Converter={StaticResource TextColorNumberToBrushConverter}, RelativeSource={RelativeSource Self}}"  Background="{Binding Content,Converter={StaticResource NameToBrushConverter}, IsAsync=True, NotifyOnTargetUpdated=True, NotifyOnSourceUpdated=True, NotifyOnValidationError=True, RelativeSource={RelativeSource Self}, ValidatesOnNotifyDataErrors=False}" BorderBrush="Black" BorderThickness="1" ></Label>
                                        </DataTemplate>
                                    </ListView.ItemTemplate>
                                    <ListView.ItemsPanel>
                                        <ItemsPanelTemplate>
                                            <StackPanel Orientation="Horizontal"></StackPanel>
                                        </ItemsPanelTemplate>
                                    </ListView.ItemsPanel>
                                </ListView>
                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>
                    </DataGridTemplateColumn>

                    <!-- BioColor II (ThreePictures) -->
                    <DataGridTemplateColumn  ClipboardContentBinding="{x:Null}"
                                                 Visibility="{Binding Path=IsChecked, Source={x:Reference BioColorIIPictures}, Converter={StaticResource BooleanToVisibilityConverter}}">
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>
                                <ListView ItemsSource="{Binding ShortOder2, Converter={StaticResource StringToListConverter}}">
                                    <ListView.ItemTemplate>
                                        <DataTemplate>
                                            <Label Content="{Binding}" Foreground="{Binding Content, Converter={StaticResource TextColorNumberToBrushConverter}, RelativeSource={RelativeSource Self}}"  Background="{Binding Content,Converter={StaticResource NameToImageConverter}, IsAsync=True, NotifyOnTargetUpdated=True, NotifyOnSourceUpdated=True, NotifyOnValidationError=True, RelativeSource={RelativeSource Self}, ValidatesOnNotifyDataErrors=False}" BorderBrush="Black" BorderThickness="1" Width="25"></Label>
                                        </DataTemplate>
                                    </ListView.ItemTemplate>
                                    <ListView.ItemsPanel>
                                        <ItemsPanelTemplate>
                                            <StackPanel Orientation="Horizontal"></StackPanel>
                                        </ItemsPanelTemplate>
                                    </ListView.ItemsPanel>
                                </ListView>
                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>
                    </DataGridTemplateColumn>

                    <DataGridTemplateColumn ClipboardContentBinding="{x:Null}"/>

                    <!-- BioColor II (TwelveColor) -->
                    <DataGridTemplateColumn Header="Биоколор 2" ClipboardContentBinding="{x:Null}" MinWidth="280"
                                                 Visibility="{Binding Path=IsChecked, Source={x:Reference BioColorIITwelve}, Converter={StaticResource BooleanToVisibilityConverter}}">
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>
                                <ListView ItemsSource="{Binding Oder2, Converter={StaticResource StringToListConverter}}" Padding="-4,0,0,0" HorizontalAlignment="Left" MinWidth="270">
                                    <ListView.ItemTemplate>
                                        <DataTemplate>
                                            <Label Content="{Binding}" Foreground="{Binding Content, Converter={StaticResource TextColorNumberToBrushConverter}, RelativeSource={RelativeSource Self}}" Background="{Binding Content,Converter={StaticResource NameToBrushConverter}, IsAsync=True, NotifyOnTargetUpdated=True, NotifyOnSourceUpdated=True, NotifyOnValidationError=True, RelativeSource={RelativeSource Self}, ValidatesOnNotifyDataErrors=False}" BorderBrush="Black" BorderThickness="1" MinWidth="25"></Label>
                                        </DataTemplate>
                                    </ListView.ItemTemplate>
                                    <ListView.ItemsPanel>
                                        <ItemsPanelTemplate>
                                            <StackPanel Orientation="Horizontal"></StackPanel>
                                        </ItemsPanelTemplate>
                                    </ListView.ItemsPanel>
                                </ListView>
                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>
                    </DataGridTemplateColumn>

                    <!-- BioColor II (TwelvePictures) -->
                    <DataGridTemplateColumn Header="Биоколор 2" ClipboardContentBinding="{x:Null}" MinWidth="280"
                                             Visibility="{Binding Path=IsChecked, Source={x:Reference BioColorIIPictures}, Converter={StaticResource BooleanToVisibilityConverter}}">
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>
                                <ListView ItemsSource="{Binding Oder2, Converter={StaticResource StringToListConverter}}" Padding="-4,0,0,0" HorizontalAlignment="Left" MinWidth="270">
                                    <ListView.ItemTemplate>
                                        <DataTemplate>
                                            <Label Content="{Binding}" Foreground="{Binding Content, Converter={StaticResource TextColorNumberToBrushConverter}, RelativeSource={RelativeSource Self}}" 
											Background="{Binding Content,Converter={StaticResource NameToImageConverter}, IsAsync=True, NotifyOnTargetUpdated=True, NotifyOnSourceUpdated=True, NotifyOnValidationError=True, RelativeSource={RelativeSource Self}, ValidatesOnNotifyDataErrors=False}" BorderBrush="Black" BorderThickness="1" MinWidth="25"></Label>
                                        </DataTemplate>
                                    </ListView.ItemTemplate>
                                    <ListView.ItemsPanel>
                                        <ItemsPanelTemplate>
                                            <StackPanel Orientation="Horizontal"></StackPanel>
                                        </ItemsPanelTemplate>
                                    </ListView.ItemsPanel>
                                </ListView>
                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>
                    </DataGridTemplateColumn>

                    <!-- Preference2 -->
                    <DataGridTextColumn Header="Преференция 2" Binding="{Binding Preference2}" ClipboardContentBinding="{x:Null}"
                                                 Visibility="{Binding Path=IsChecked, Source={x:Reference BioColorIIHide}, Converter={StaticResource BooleanToNOTVisibilityConverter}}">
                        <DataGridTextColumn.ElementStyle>
                            <Style TargetType="{x:Type TextBlock}">
                                <Setter Property="Background" Value="{Binding Preference2, Converter={StaticResource PreferenceToBrushConverter}}" />
                                <Setter Property="TextAlignment" Value="Center"></Setter>
                            </Style>
                        </DataGridTextColumn.ElementStyle>
                    </DataGridTextColumn>

                    <!-- BioColor II END -->

                    <DataGridTemplateColumn ClipboardContentBinding="{x:Null}"/>
                    <DataGridTextColumn 
                        ClipboardContentBinding="{x:Null}"
                        Header="Физическое"
                        Binding="{Binding UserId, Converter={StaticResource DateToSin}, ConverterParameter=23}">
                        <DataGridTextColumn.ElementStyle>
                            <Style>
                                <Setter Property="TextBlock.HorizontalAlignment" Value="Center" />
                                <Setter Property="TextBlock.VerticalAlignment" Value="Center" />
                                <Setter Property="TextBlock.FontSize" Value="20" />
                            </Style>
                        </DataGridTextColumn.ElementStyle>
                    </DataGridTextColumn>
                    <DataGridTextColumn 
                        ClipboardContentBinding="{x:Null}"
                        Header="Эмоциональное"
                        Binding="{Binding UserId, Converter={StaticResource DateToSin}, ConverterParameter=28}">
                        <DataGridTextColumn.ElementStyle>
                            <Style>
                                <Setter Property="TextBlock.HorizontalAlignment" Value="Center" />
                                <Setter Property="TextBlock.VerticalAlignment" Value="Center" />
                                <Setter Property="TextBlock.FontSize" Value="20" />
                            </Style>
                        </DataGridTextColumn.ElementStyle>
                    </DataGridTextColumn>
                    <DataGridTextColumn 
                        ClipboardContentBinding="{x:Null}"
                        Header="Интелектуальное"
                        Binding="{Binding UserId, Converter={StaticResource DateToSin}, ConverterParameter=33}">
                        <DataGridTextColumn.ElementStyle>
                            <Style>
                                <Setter Property="TextBlock.HorizontalAlignment" Value="Center" />
                                <Setter Property="TextBlock.VerticalAlignment" Value="Center" />
                                <Setter Property="TextBlock.FontSize" Value="20" />
                            </Style>
                        </DataGridTextColumn.ElementStyle>
                    </DataGridTextColumn>
                    <DataGridTemplateColumn ClipboardContentBinding="{x:Null}"/>
                    <DataGridTemplateColumn ClipboardContentBinding="{x:Null}" Header="Релакс 1" Width="60">
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>
                                <Button Background="Transparent" Tag="{Binding RelaxTable1, Converter={StaticResource NumberToRelax1Converter}}" Click="ExpandImage">
                                    <Image Source="{Binding RelaxTable1, Converter={StaticResource NumberToRelax1Converter}}"/>
                                </Button>
                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>
                    </DataGridTemplateColumn>
                    <DataGridTemplateColumn ClipboardContentBinding="{x:Null}" Header="Релакс 2" Width="60">
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>
                                <Button Background="Transparent" Tag="{Binding RelaxTable2, Converter={StaticResource NumberToRelax2Converter}}" Click="ExpandImage">
                                    <Image Source="{Binding RelaxTable2, Converter={StaticResource NumberToRelax2Converter}}"/>
                                </Button>
                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>
                    </DataGridTemplateColumn>

                    <DataGridTemplateColumn ClipboardContentBinding="{x:Null}"/>
                    <!-- Preference1 -->
                    <DataGridTextColumn Header="Преференция 1" Binding="{Binding Preference1}" ClipboardContentBinding="{x:Null}">
                        <DataGridTextColumn.ElementStyle>
                            <Style TargetType="{x:Type TextBlock}">
                                <Setter Property="Background" Value="{Binding Preference1, Converter={StaticResource PreferenceToBrushConverter}}" />
                                <Setter Property="TextAlignment" Value="Center"></Setter>
                            </Style>
                        </DataGridTextColumn.ElementStyle>
                    </DataGridTextColumn>

                    <!-- Preference2 -->
                    <DataGridTextColumn Header="Преференция 2" Binding="{Binding Preference2}" ClipboardContentBinding="{x:Null}">
                        <DataGridTextColumn.ElementStyle>
                            <Style TargetType="{x:Type TextBlock}">
                                <Setter Property="Background" Value="{Binding Preference2, Converter={StaticResource PreferenceToBrushConverter}}" />
                                <Setter Property="TextAlignment" Value="Center"></Setter>
                            </Style>
                        </DataGridTextColumn.ElementStyle>
                    </DataGridTextColumn>

                    <DataGridTemplateColumn ClipboardContentBinding="{x:Null}"/>

                    <!-- Compare Preferences -->
                    <DataGridTextColumn Header="Преф 1 и Преф 2" Binding="{Binding Compare, Converter={StaticResource BooleanToChecker}}" ClipboardContentBinding="{x:Null}">
                        <DataGridTextColumn.ElementStyle>
                            <Style>
                                <Setter Property="TextBlock.HorizontalAlignment" Value="Center" />
                                <Setter Property="TextBlock.VerticalAlignment" Value="Center" />
                                <Setter Property="TextBlock.FontSize" Value="20" />

                            </Style>
                        </DataGridTextColumn.ElementStyle>
                    </DataGridTextColumn>

                    <DataGridTemplateColumn ClipboardContentBinding="{x:Null}"/>

                    <!-- Compare Pref1 + Relax1-->
                    <DataGridTextColumn Header="Преф 1 Релакс2" ClipboardContentBinding="{x:Null}">
                        <DataGridTextColumn.ElementStyle>
                            <Style>
                                <Setter Property="TextBlock.HorizontalAlignment" Value="Center" />
                                <Setter Property="TextBlock.VerticalAlignment" Value="Center" />
                                <Setter Property="TextBlock.FontSize" Value="20"/>
                                <Setter Property="TextBlock.Text">
                                    <Setter.Value>
                                        <MultiBinding Converter="{StaticResource PreferenceSameAsRelax}">
                                            <Binding Path="Preference1"/>
                                            <Binding Path="RelaxTable1"/>
                                        </MultiBinding>
                                    </Setter.Value>
                                </Setter>
                            </Style>
                        </DataGridTextColumn.ElementStyle>
                    </DataGridTextColumn>

                    <!-- Compare Pref2 + Relax2-->
                    <DataGridTextColumn Header="Преф 2 Релакс 2" ClipboardContentBinding="{x:Null}">
                        <DataGridTextColumn.ElementStyle>
                            <Style>
                                <Setter Property="TextBlock.HorizontalAlignment" Value="Center" />
                                <Setter Property="TextBlock.VerticalAlignment" Value="Center" />
                                <Setter Property="TextBlock.FontSize" Value="20"/>
                                <Setter Property="TextBlock.Text">
                                    <Setter.Value>
                                        <MultiBinding Converter="{StaticResource PreferenceSameAsRelax}">
                                            <Binding Path="Preference2"/>
                                            <Binding Path="RelaxTable2"/>
                                        </MultiBinding>
                                    </Setter.Value>
                                </Setter>
                            </Style>
                        </DataGridTextColumn.ElementStyle>
                    </DataGridTextColumn>

                </DataGrid.Columns>
            </DataGrid>
            <DataGrid comment:Tab="Subjective Feelings Grid" CellEditEnding="FeelingsDataGrid_CellEditEnding"
                      x:Name="SubjectiveFeelingDataGrid" CanUserAddRows="False" ItemsSource="{Binding Source={StaticResource GetFeelings}}" IsSynchronizedWithCurrentItem="True" AutoGenerateColumns="False" Visibility="{Binding IsSelected, Converter={StaticResource BooleanToVisibilityConverter}, ElementName=tabItem2}">
                <DataGrid.Columns>
                    <DataGridTextColumn Binding="{Binding Id}" Visibility="Hidden" />
                    <DataGridTemplateColumn>
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>
                                <Button x:Name="RemoveFeelingsBtn" Content="&#xE107;" FontFamily="Segoe MDL2 Assets" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" BorderBrush="White" Background="White" Foreground="Red" FontSize="14" Click="DeleteSubjectiveFeeling_Click"/>
                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>
                    </DataGridTemplateColumn>
                    <DataGridTemplateColumn Visibility="Hidden">
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>
                                <Button x:Name="EditFeelingsBtn" Content="&#xE70F;" FontFamily="Segoe MDL2 Assets" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" BorderBrush="White" Background="White" Foreground="Black" FontSize="14" Click="BindSubjectiveFeelingInForm_Click" Tag="{Binding Id}"/>
                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>
                    </DataGridTemplateColumn>
                    <DataGridTextColumn IsReadOnly="True" Header="Код" Binding="{Binding UserId}" />
                    <DataGridTextColumn Header="Дата" Binding="{Binding Date, StringFormat=\{0:d\}, ConverterCulture=uk-UA}" />
                    <DataGridCheckBoxColumn Header="Общая слабость" Binding="{Binding GeneralWeaknes}" />
                    <DataGridCheckBoxColumn Header="Плохой апетит" Binding="{Binding PoorAppetite}" />
                    <DataGridCheckBoxColumn Header="Плохой сон" Binding="{Binding PoorSleep}" />
                    <DataGridCheckBoxColumn Header="Плохое настроение" Binding="{Binding BadMood}" />
                    <DataGridCheckBoxColumn Header="Тяжесть в голове" Binding="{Binding HeavyHead}" />
                    <DataGridCheckBoxColumn Header="Замедленное мышление" Binding="{Binding SlowThink}" />
                </DataGrid.Columns>
            </DataGrid>
            <Grid comment:Tab="Biocolor"
                  x:Name="BioColorGrid" Background="White" Visibility="{Binding IsSelected, Converter={StaticResource BooleanToVisibilityConverter}, ElementName=tabItem3}" Grid.ColumnSpan="2" >
                <Grid.RowDefinitions>
                    <RowDefinition/>
                </Grid.RowDefinitions>
            </Grid>
            <Grid comment:Tab="Colors Settings"
                  x:Name="ColorSettings" Background="White" Visibility="{Binding IsSelected, Converter={StaticResource BooleanToVisibilityConverter}, ElementName=ColorSettingsTab}" Grid.ColumnSpan="2" Panel.ZIndex="2">
                <Grid.RowDefinitions>
                    <RowDefinition Height="25"/>
                    <RowDefinition Height="25"/>
                    <RowDefinition Height="25"/>
                    <RowDefinition Height="25"/>
                    <RowDefinition Height="25"/>
                    <RowDefinition Height="25"/>
                    <RowDefinition Height="25"/>
                    <RowDefinition Height="25"/>
                    <RowDefinition Height="25"/>
                    <RowDefinition Height="25"/>
                    <RowDefinition Height="25"/>
                    <RowDefinition Height="25"/>
                    <RowDefinition Height="25"/>
                    <RowDefinition Height="25"/>
                    <RowDefinition Height="25"/>
                </Grid.RowDefinitions>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="300"/>
                    <ColumnDefinition Width="150"/>
                    <ColumnDefinition Width="150"/>
                    <ColumnDefinition Width="65"/>
                    <ColumnDefinition Width="50"/>
                    <ColumnDefinition Width="50"/>
                    <ColumnDefinition Width="50"/>
                    <ColumnDefinition Width="50"/>
                </Grid.ColumnDefinitions>

                <Image Grid.Row="1" Grid.Column="0" Grid.RowSpan="12" Height="200" HorizontalAlignment="Center" VerticalAlignment="Center">
                    <Image.Source>
                        <DrawingImage>
                            <DrawingImage.Drawing>
                                <DrawingGroup>
                                    <GeometryDrawing x:Name="PhysicalColorBackground4" Brush="#F603EB">
                                        <GeometryDrawing.Pen>
                                            <Pen Brush="Black"/>
                                        </GeometryDrawing.Pen>
                                        <GeometryDrawing.Geometry>
                                            <PathGeometry>
                                                <PathFigure StartPoint="100,100">
                                                    <PathFigure.Segments>
                                                        <LineSegment Point="200.0,100.0"/>
                                                        <ArcSegment Point="186.6,50.0" SweepDirection="Counterclockwise" Size="100,100"/>
                                                        <LineSegment Point="100,100"/>
                                                    </PathFigure.Segments>
                                                </PathFigure>
                                            </PathGeometry>
                                        </GeometryDrawing.Geometry>
                                    </GeometryDrawing>

                                    <GeometryDrawing x:Name="PhysicalColorBackground3" Brush="#FA0006">
                                        <GeometryDrawing.Pen>
                                            <Pen Brush="Black"/>
                                        </GeometryDrawing.Pen>
                                        <GeometryDrawing.Geometry>
                                            <PathGeometry>
                                                <PathFigure StartPoint="100,100">
                                                    <PathFigure.Segments>
                                                        <LineSegment Point="186.6,50.0"/>
                                                        <ArcSegment Point="150.0,13.4" SweepDirection="Counterclockwise" Size="100,100"/>
                                                        <LineSegment Point="100,100"/>
                                                    </PathFigure.Segments>
                                                </PathFigure>
                                            </PathGeometry>
                                        </GeometryDrawing.Geometry>
                                    </GeometryDrawing>

                                    <GeometryDrawing x:Name="PhysicalColorBackground2" Brush="#FE280C">
                                        <GeometryDrawing.Pen>
                                            <Pen Brush="Black"/>
                                        </GeometryDrawing.Pen>
                                        <GeometryDrawing.Geometry>
                                            <PathGeometry>
                                                <PathFigure StartPoint="100,100">
                                                    <PathFigure.Segments>
                                                        <LineSegment Point="150.0,13.4"/>
                                                        <ArcSegment Point="100.0,0.0" SweepDirection="Counterclockwise" Size="100,100"/>
                                                        <LineSegment Point="100,100"/>
                                                    </PathFigure.Segments>
                                                </PathFigure>
                                            </PathGeometry>
                                        </GeometryDrawing.Geometry>
                                    </GeometryDrawing>

                                    <GeometryDrawing x:Name="PhysicalColorBackground1" Brush="#F96F0A">
                                        <GeometryDrawing.Pen>
                                            <Pen Brush="Black"/>
                                        </GeometryDrawing.Pen>
                                        <GeometryDrawing.Geometry>
                                            <PathGeometry>
                                                <PathFigure StartPoint="100,100">
                                                    <PathFigure.Segments>
                                                        <LineSegment Point="100.0,0.0"/>
                                                        <ArcSegment Point="50.0,13.4" SweepDirection="Counterclockwise" Size="100,100"/>
                                                        <LineSegment Point="100,100"/>
                                                    </PathFigure.Segments>
                                                </PathFigure>
                                            </PathGeometry>
                                        </GeometryDrawing.Geometry>
                                    </GeometryDrawing>

                                    <GeometryDrawing x:Name="EmotionalColorBackground4" Brush="#FBBC0C">
                                        <GeometryDrawing.Pen>
                                            <Pen Brush="Black"/>
                                        </GeometryDrawing.Pen>
                                        <GeometryDrawing.Geometry>
                                            <PathGeometry>
                                                <PathFigure StartPoint="100,100">
                                                    <PathFigure.Segments>
                                                        <LineSegment Point="50.0,13.4"/>
                                                        <ArcSegment Point="13.4,50.0" SweepDirection="Counterclockwise" Size="100,100"/>
                                                        <LineSegment Point="100,100"/>
                                                    </PathFigure.Segments>
                                                </PathFigure>
                                            </PathGeometry>
                                        </GeometryDrawing.Geometry>
                                    </GeometryDrawing>

                                    <GeometryDrawing x:Name="EmotionalColorBackground3" Brush="#F4FE09">
                                        <GeometryDrawing.Pen>
                                            <Pen Brush="Black"/>
                                        </GeometryDrawing.Pen>
                                        <GeometryDrawing.Geometry>
                                            <PathGeometry>
                                                <PathFigure StartPoint="100,100">
                                                    <PathFigure.Segments>
                                                        <LineSegment Point="13.4,50.0"/>
                                                        <ArcSegment Point="0.0,100.0" SweepDirection="Counterclockwise" Size="100,100"/>
                                                        <LineSegment Point="100,100"/>
                                                    </PathFigure.Segments>
                                                </PathFigure>
                                            </PathGeometry>
                                        </GeometryDrawing.Geometry>
                                    </GeometryDrawing>

                                    <GeometryDrawing x:Name="EmotionalColorBackground2" Brush="#7EFE07">
                                        <GeometryDrawing.Pen>
                                            <Pen Brush="Black"/>
                                        </GeometryDrawing.Pen>
                                        <GeometryDrawing.Geometry>
                                            <PathGeometry>
                                                <PathFigure StartPoint="100,100">
                                                    <PathFigure.Segments>
                                                        <LineSegment Point="0.0,100.0"/>
                                                        <ArcSegment Point="13.4,150.0" SweepDirection="Counterclockwise" Size="100,100"/>
                                                        <LineSegment Point="100,100"/>
                                                    </PathFigure.Segments>
                                                </PathFigure>
                                            </PathGeometry>
                                        </GeometryDrawing.Geometry>
                                    </GeometryDrawing>

                                    <GeometryDrawing x:Name="EmotionalColorBackground1" Brush="#31F715">
                                        <GeometryDrawing.Pen>
                                            <Pen Brush="Black"/>
                                        </GeometryDrawing.Pen>
                                        <GeometryDrawing.Geometry>
                                            <PathGeometry>
                                                <PathFigure StartPoint="100,100">
                                                    <PathFigure.Segments>
                                                        <LineSegment Point="13.4,150.0"/>
                                                        <ArcSegment Point="50.0,186.6" SweepDirection="Counterclockwise" Size="100,100"/>
                                                        <LineSegment Point="100,100"/>
                                                    </PathFigure.Segments>
                                                </PathFigure>
                                            </PathGeometry>
                                        </GeometryDrawing.Geometry>
                                    </GeometryDrawing>

                                    <GeometryDrawing x:Name="IntellectualColorBackground4" Brush="#3DDEFB">
                                        <GeometryDrawing.Pen>
                                            <Pen Brush="Black"/>
                                        </GeometryDrawing.Pen>
                                        <GeometryDrawing.Geometry>
                                            <PathGeometry>
                                                <PathFigure StartPoint="100,100">
                                                    <PathFigure.Segments>
                                                        <LineSegment Point="50.0,186.6"/>
                                                        <ArcSegment Point="100.0,200.0" SweepDirection="Counterclockwise" Size="100,100"/>
                                                        <LineSegment Point="100,100"/>
                                                    </PathFigure.Segments>
                                                </PathFigure>
                                            </PathGeometry>
                                        </GeometryDrawing.Geometry>
                                    </GeometryDrawing>

                                    <GeometryDrawing x:Name="IntellectualColorBackground3" Brush="#1855F7">
                                        <GeometryDrawing.Pen>
                                            <Pen Brush="Black"/>
                                        </GeometryDrawing.Pen>
                                        <GeometryDrawing.Geometry>
                                            <PathGeometry>
                                                <PathFigure StartPoint="100,100">
                                                    <PathFigure.Segments>
                                                        <LineSegment Point="100.0,200.0"/>
                                                        <ArcSegment Point="150.0,186.6" SweepDirection="Counterclockwise" Size="100,100"/>
                                                        <LineSegment Point="100,100"/>
                                                    </PathFigure.Segments>
                                                </PathFigure>
                                            </PathGeometry>
                                        </GeometryDrawing.Geometry>
                                    </GeometryDrawing>

                                    <GeometryDrawing x:Name="IntellectualColorBackground2" Brush="#0F2BEB">
                                        <GeometryDrawing.Pen>
                                            <Pen Brush="Black"/>
                                        </GeometryDrawing.Pen>
                                        <GeometryDrawing.Geometry>
                                            <PathGeometry>
                                                <PathFigure StartPoint="100,100">
                                                    <PathFigure.Segments>
                                                        <LineSegment Point="150.0,186.6"/>
                                                        <ArcSegment Point="186.6,150.0" SweepDirection="Counterclockwise" Size="100,100"/>
                                                        <LineSegment Point="100,100"/>
                                                    </PathFigure.Segments>
                                                </PathFigure>
                                            </PathGeometry>
                                        </GeometryDrawing.Geometry>
                                    </GeometryDrawing>

                                    <GeometryDrawing x:Name="IntellectualColorBackground1" Brush="#2317F5">
                                        <GeometryDrawing.Pen>
                                            <Pen Brush="Black"/>
                                        </GeometryDrawing.Pen>
                                        <GeometryDrawing.Geometry>
                                            <PathGeometry>
                                                <PathFigure StartPoint="100,100">
                                                    <PathFigure.Segments>
                                                        <LineSegment Point="186.6,150.0"/>
                                                        <ArcSegment Point="200.0,100.0" SweepDirection="Counterclockwise" Size="100,100"/>
                                                        <LineSegment Point="100,100"/>
                                                    </PathFigure.Segments>
                                                </PathFigure>
                                            </PathGeometry>
                                        </GeometryDrawing.Geometry>
                                    </GeometryDrawing>

                                </DrawingGroup>
                            </DrawingImage.Drawing>
                        </DrawingImage>
                    </Image.Source>
                </Image>

                <Grid Grid.Row="2" Grid.Column="0" Grid.RowSpan="10" Width="250" Height="250">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="25"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="25"/>
                    </Grid.RowDefinitions>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="25"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="25"/>
                    </Grid.ColumnDefinitions>

                    <TextBlock Grid.Row="0" Grid.Column="1" Margin=" 0, 0,20, 0" HorizontalAlignment="Right"  VerticalAlignment="Center" Text="Ф 1"/>
                    <TextBlock Grid.Row="0" Grid.Column="2" Margin="20, 0, 0, 0" HorizontalAlignment="Left"   VerticalAlignment="Center" Text="Ф 2"/>
                    <TextBlock Grid.Row="1" Grid.Column="2" Margin=" 5, 5, 5, 5" HorizontalAlignment="Right"  VerticalAlignment="Top"    Text="Ф 3"/>
                    <TextBlock Grid.Row="1" Grid.Column="3" Margin=" 0, 0, 0,20" HorizontalAlignment="Center" VerticalAlignment="Bottom" Text="Ф 4"/>
                    <TextBlock Grid.Row="2" Grid.Column="1" Margin=" 5, 5, 5, 5" HorizontalAlignment="Left"   VerticalAlignment="Bottom" Text="Э 1"/>
                    <TextBlock Grid.Row="2" Grid.Column="0" Margin=" 0,20, 0, 0" HorizontalAlignment="Center" VerticalAlignment="Top"    Text="Э 2"/>
                    <TextBlock Grid.Row="1" Grid.Column="0" Margin=" 0, 0, 0,20" HorizontalAlignment="Center" VerticalAlignment="Bottom" Text="Э 3"/>
                    <TextBlock Grid.Row="1" Grid.Column="1" Margin=" 5, 5, 5, 5" HorizontalAlignment="Left"   VerticalAlignment="Top"    Text="Э 4"/>
                    <TextBlock Grid.Row="2" Grid.Column="3" Margin=" 0,20, 0, 0" HorizontalAlignment="Center" VerticalAlignment="Top"    Text="И 1"/>
                    <TextBlock Grid.Row="2" Grid.Column="2" Margin=" 5, 5, 5, 5" HorizontalAlignment="Right"  VerticalAlignment="Bottom" Text="И 2"/>
                    <TextBlock Grid.Row="3" Grid.Column="2" Margin="20, 0, 0, 0" HorizontalAlignment="Left"   VerticalAlignment="Center" Text="И 3"/>
                    <TextBlock Grid.Row="3" Grid.Column="1" Margin=" 0, 0,20, 0" HorizontalAlignment="Right"  VerticalAlignment="Center" Text="И 4"/>
                </Grid>

                <TextBlock Grid.Row="00" Grid.Column="2" HorizontalAlignment="Center" VerticalAlignment="Center" Text="RGB"/>
                <TextBlock Grid.Row="00" Grid.Column="4" HorizontalAlignment="Center" VerticalAlignment="Center" Text="C"/>
                <TextBlock Grid.Row="00" Grid.Column="5" HorizontalAlignment="Center" VerticalAlignment="Center" Text="M"/>
                <TextBlock Grid.Row="00" Grid.Column="6" HorizontalAlignment="Center" VerticalAlignment="Center" Text="Y"/>
                <TextBlock Grid.Row="00" Grid.Column="7" HorizontalAlignment="Center" VerticalAlignment="Center" Text="K"/>

                <TextBlock Grid.Row="01" Grid.Column="1" Name="pt1" VerticalAlignment="Center" Text="Физическое: [1]"/>
                <TextBlock Grid.Row="02" Grid.Column="1" Name="pt2" VerticalAlignment="Center" Text="Физическое: [2]"/>
                <TextBlock Grid.Row="03" Grid.Column="1" Name="pt3" VerticalAlignment="Center" Text="Физическое: [3]"/>
                <TextBlock Grid.Row="04" Grid.Column="1" Name="pt4" VerticalAlignment="Center" Text="Физическое: [4]"/>
                <TextBlock Grid.Row="05" Grid.Column="1" Name="et1" VerticalAlignment="Center" Text="Эмоциональное: [1]"/>
                <TextBlock Grid.Row="06" Grid.Column="1" Name="et2" VerticalAlignment="Center" Text="Эмоциональное: [2]"/>
                <TextBlock Grid.Row="07" Grid.Column="1" Name="et3" VerticalAlignment="Center" Text="Эмоциональное: [3]"/>
                <TextBlock Grid.Row="08" Grid.Column="1" Name="et4" VerticalAlignment="Center" Text="Эмоциональное: [4]"/>
                <TextBlock Grid.Row="09" Grid.Column="1" Name="it1" VerticalAlignment="Center" Text="Интелекнуальное: [1]"/>
                <TextBlock Grid.Row="10" Grid.Column="1" Name="it2" VerticalAlignment="Center" Text="Интелекнуальное: [2]"/>
                <TextBlock Grid.Row="11" Grid.Column="1" Name="it3" VerticalAlignment="Center" Text="Интелекнуальное: [3]"/>
                <TextBlock Grid.Row="12" Grid.Column="1" Name="it4" VerticalAlignment="Center" Text="Интелекнуальное: [4]"/>

                <TextBox IsReadOnly="True" Grid.Row="01" Grid.Column="2" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Name= "PhysicalColor1" />
                <TextBox                   Grid.Row="01" Grid.Column="4" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Name="cPhysicalColor1" />
                <TextBox                   Grid.Row="01" Grid.Column="5" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Name="mPhysicalColor1" />
                <TextBox                   Grid.Row="01" Grid.Column="6" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Name="yPhysicalColor1" />
                <TextBox                   Grid.Row="01" Grid.Column="7" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Name="kPhysicalColor1" />
                <TextBox IsReadOnly="True" Grid.Row="02" Grid.Column="2" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Name= "PhysicalColor2" />
                <TextBox                   Grid.Row="02" Grid.Column="4" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Name="cPhysicalColor2" />
                <TextBox                   Grid.Row="02" Grid.Column="5" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Name="mPhysicalColor2" />
                <TextBox                   Grid.Row="02" Grid.Column="6" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Name="yPhysicalColor2" />
                <TextBox                   Grid.Row="02" Grid.Column="7" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Name="kPhysicalColor2" />
                <TextBox IsReadOnly="True" Grid.Row="03" Grid.Column="2" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Name= "PhysicalColor3" />
                <TextBox                   Grid.Row="03" Grid.Column="4" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Name="cPhysicalColor3" />
                <TextBox                   Grid.Row="03" Grid.Column="5" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Name="mPhysicalColor3" />
                <TextBox                   Grid.Row="03" Grid.Column="6" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Name="yPhysicalColor3" />
                <TextBox                   Grid.Row="03" Grid.Column="7" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Name="kPhysicalColor3" />
                <TextBox IsReadOnly="True" Grid.Row="04" Grid.Column="2" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Name= "PhysicalColor4" />
                <TextBox                   Grid.Row="04" Grid.Column="4" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Name="cPhysicalColor4" />
                <TextBox                   Grid.Row="04" Grid.Column="5" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Name="mPhysicalColor4" />
                <TextBox                   Grid.Row="04" Grid.Column="6" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Name="yPhysicalColor4" />
                <TextBox                   Grid.Row="04" Grid.Column="7" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Name="kPhysicalColor4" />
                <TextBox IsReadOnly="True" Grid.Row="05" Grid.Column="2" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Name= "EmotionalColor1" />
                <TextBox                   Grid.Row="05" Grid.Column="4" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Name="cEmotionalColor1" />
                <TextBox                   Grid.Row="05" Grid.Column="5" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Name="mEmotionalColor1" />
                <TextBox                   Grid.Row="05" Grid.Column="6" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Name="yEmotionalColor1" />
                <TextBox                   Grid.Row="05" Grid.Column="7" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Name="kEmotionalColor1" />
                <TextBox IsReadOnly="True" Grid.Row="06" Grid.Column="2" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Name= "EmotionalColor2" />
                <TextBox                   Grid.Row="06" Grid.Column="4" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Name="cEmotionalColor2" />
                <TextBox                   Grid.Row="06" Grid.Column="5" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Name="mEmotionalColor2" />
                <TextBox                   Grid.Row="06" Grid.Column="6" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Name="yEmotionalColor2" />
                <TextBox                   Grid.Row="06" Grid.Column="7" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Name="kEmotionalColor2" />
                <TextBox IsReadOnly="True" Grid.Row="07" Grid.Column="2" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Name= "EmotionalColor3" />
                <TextBox                   Grid.Row="07" Grid.Column="4" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Name="cEmotionalColor3" />
                <TextBox                   Grid.Row="07" Grid.Column="5" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Name="mEmotionalColor3" />
                <TextBox                   Grid.Row="07" Grid.Column="6" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Name="yEmotionalColor3" />
                <TextBox                   Grid.Row="07" Grid.Column="7" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Name="kEmotionalColor3" />
                <TextBox IsReadOnly="True" Grid.Row="08" Grid.Column="2" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Name= "EmotionalColor4" />
                <TextBox                   Grid.Row="08" Grid.Column="4" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Name="cEmotionalColor4" />
                <TextBox                   Grid.Row="08" Grid.Column="5" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Name="mEmotionalColor4" />
                <TextBox                   Grid.Row="08" Grid.Column="6" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Name="yEmotionalColor4" />
                <TextBox                   Grid.Row="08" Grid.Column="7" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Name="kEmotionalColor4" />
                <TextBox IsReadOnly="True" Grid.Row="09" Grid.Column="2" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Name= "IntellectualColor1" />
                <TextBox                   Grid.Row="09" Grid.Column="4" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Name="cIntellectualColor1" />
                <TextBox                   Grid.Row="09" Grid.Column="5" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Name="mIntellectualColor1" />
                <TextBox                   Grid.Row="09" Grid.Column="6" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Name="yIntellectualColor1" />
                <TextBox                   Grid.Row="09" Grid.Column="7" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Name="kIntellectualColor1" />
                <TextBox IsReadOnly="True" Grid.Row="10" Grid.Column="2" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Name= "IntellectualColor2" />
                <TextBox                   Grid.Row="10" Grid.Column="4" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Name="cIntellectualColor2" />
                <TextBox                   Grid.Row="10" Grid.Column="5" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Name="mIntellectualColor2" />
                <TextBox                   Grid.Row="10" Grid.Column="6" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Name="yIntellectualColor2" />
                <TextBox                   Grid.Row="10" Grid.Column="7" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Name="kIntellectualColor2" />
                <TextBox IsReadOnly="True" Grid.Row="11" Grid.Column="2" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Name= "IntellectualColor3" />
                <TextBox                   Grid.Row="11" Grid.Column="4" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Name="cIntellectualColor3" />
                <TextBox                   Grid.Row="11" Grid.Column="5" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Name="mIntellectualColor3" />
                <TextBox                   Grid.Row="11" Grid.Column="6" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Name="yIntellectualColor3" />
                <TextBox                   Grid.Row="11" Grid.Column="7" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Name="kIntellectualColor3" />
                <TextBox IsReadOnly="True" Grid.Row="12" Grid.Column="2" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Name= "IntellectualColor4" />
                <TextBox                   Grid.Row="12" Grid.Column="4" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Name="cIntellectualColor4" />
                <TextBox                   Grid.Row="12" Grid.Column="5" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Name="mIntellectualColor4" />
                <TextBox                   Grid.Row="12" Grid.Column="6" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Name="yIntellectualColor4" />
                <TextBox                   Grid.Row="12" Grid.Column="7" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Name="kIntellectualColor4" />

                <Button Grid.Row="01" Grid.Column="3" Name="PhysicalButton1"     Click="CMYK2RGB_Click" Content="&lt;--" />
                <Button Grid.Row="02" Grid.Column="3" Name="PhysicalButton2"     Click="CMYK2RGB_Click" Content="&lt;--" />
                <Button Grid.Row="03" Grid.Column="3" Name="PhysicalButton3"     Click="CMYK2RGB_Click" Content="&lt;--" />
                <Button Grid.Row="04" Grid.Column="3" Name="PhysicalButton4"     Click="CMYK2RGB_Click" Content="&lt;--" />
                <Button Grid.Row="05" Grid.Column="3" Name="EmotionalButton1"    Click="CMYK2RGB_Click" Content="&lt;--" />
                <Button Grid.Row="06" Grid.Column="3" Name="EmotionalButton2"    Click="CMYK2RGB_Click" Content="&lt;--" />
                <Button Grid.Row="07" Grid.Column="3" Name="EmotionalButton3"    Click="CMYK2RGB_Click" Content="&lt;--" />
                <Button Grid.Row="08" Grid.Column="3" Name="EmotionalButton4"    Click="CMYK2RGB_Click" Content="&lt;--" />
                <Button Grid.Row="09" Grid.Column="3" Name="IntellectualButton1" Click="CMYK2RGB_Click" Content="&lt;--" />
                <Button Grid.Row="10" Grid.Column="3" Name="IntellectualButton2" Click="CMYK2RGB_Click" Content="&lt;--" />
                <Button Grid.Row="11" Grid.Column="3" Name="IntellectualButton3" Click="CMYK2RGB_Click" Content="&lt;--" />
                <Button Grid.Row="12" Grid.Column="3" Name="IntellectualButton4" Click="CMYK2RGB_Click" Content="&lt;--" />


                <Button Grid.Row="14" Grid.Column="2" Grid.ColumnSpan="1" Click="SaveColors_Click"    Content="Сохранить"/>
                <Button Grid.Row="14" Grid.Column="4" Grid.ColumnSpan="2" Click="RestoreColors_Click" Content="Отменить"/>
                <Button Grid.Row="14" Grid.Column="6" Grid.ColumnSpan="2" Click="ResetColors_Click"   Content="Восстановить"/>

            </Grid>

            <Grid x:Name="Loader" Visibility="Hidden" Grid.ColumnSpan="2">
                <TextBox
                    FontSize="24"
                    HorizontalContentAlignment="Center"
                    VerticalContentAlignment="Center"
                    Text="Загрузка..."
                    IsReadOnly="True">
                    <TextBox.Background>
                        <SolidColorBrush Color="White" Opacity="0.8" />
                    </TextBox.Background>
                </TextBox>
            </Grid>
            <Border BorderBrush="Black" BorderThickness="2" 
                    VerticalAlignment="Center"
                    HorizontalAlignment="Center"
                    Visibility="{Binding Path=Visibility, ElementName=BigImage}"
                    >
                <Button Click="HideImage"
                    Height="{Binding Path=Height, ElementName=BigImage}"
                    Width="{Binding Path=Width, ElementName=BigImage}">
                    <Image x:Name="BigImage" 
                       Visibility="Hidden" 
                       HorizontalAlignment="Center" 
                       VerticalAlignment="Center" 
                       MaxHeight="500" MaxWidth="500"/>
                </Button>
            </Border>
            
            <Grid Grid.Column="1" comment:Tab="People Filter"
                  DataContext="{StaticResource peopleFilterVM}"
                  Visibility="{Binding IsSelected, Converter={StaticResource BooleanToVisibilityConverter}, ElementName=tabItem}">

                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <Label Grid.Row="0" Content="Фильтры" FontSize="15" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Background="LightGray"/>

                <ScrollViewer Grid.Row="1">
                    <StackPanel>
                        <Expander Header="Код человека" Padding="5,2">
                            <ListBox 
                                    Margin="-5,0"
                                    x:Name="UserIdsFilterPeopleTab" 
                                    ItemsSource="{Binding Source={StaticResource GetCodesForFilter}}" 
                                    SelectionMode="Multiple">
                                <ListBox.ItemTemplate>
                                    <DataTemplate>
                                        <CheckBox 
                                                Checked="UserIdsFilterPeopleTab_Selected" 
                                                Unchecked="UserIdsFilterPeopleTab_Selected" 
                                                Content="{Binding}" 
                                                IsChecked="{Binding RelativeSource={RelativeSource AncestorType={x:Type ListBoxItem}}, Path=IsSelected}"/>
                                    </DataTemplate>
                                </ListBox.ItemTemplate>
                            </ListBox>
                        </Expander>
                        <Expander Header="Дата рождения" Padding="5,2">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition />
                                    <ColumnDefinition />
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition/>
                                    <RowDefinition/>
                                </Grid.RowDefinitions>

                                <Label Grid.Row="0" Grid.Column="0" Content="Начало" HorizontalContentAlignment="Center" VerticalContentAlignment="Center"/>
                                <Label Grid.Row="0" Grid.Column="1" Content="Конец"  HorizontalContentAlignment="Center" VerticalContentAlignment="Center"/>

                                <DatePicker Grid.Row="1" Grid.Column="0" SelectedDate="{Binding DateFrom}" />
                                <DatePicker Grid.Row="1" Grid.Column="1" SelectedDate="{Binding DateTo}"   />
                            </Grid>
                        </Expander>
                        <Expander Header="Экспедиция" Padding="5,2">
                            <ListBox 
                                    Margin="-5,0"
                                    x:Name="ExpeditionFilterPeopleTab" 
                                    ItemsSource="{Binding Source={StaticResource GetExpeditionCodes}}" 
                                    SelectionMode="Multiple">
                                <ListBox.ItemTemplate>
                                    <DataTemplate>
                                        <CheckBox 
                                                Checked="ExpeditionFilterPeopleTab_Selected" 
                                                Unchecked="ExpeditionFilterPeopleTab_Selected" 
                                                Content="{Binding}" 
                                                IsChecked="{Binding RelativeSource={RelativeSource AncestorType={x:Type ListBoxItem}}, Path=IsSelected}" />
                                    </DataTemplate>
                                </ListBox.ItemTemplate>
                            </ListBox>
                        </Expander>
                        <Expander Header="Номер человека" Padding="5,2">
                            <ListBox 
                                    Margin="-5,0"
                                    x:Name="NumberFilterPeopleTab" 
                                    ItemsSource="{Binding Source={StaticResource GetPeopleCodes}}" 
                                    SelectionMode="Multiple">
                                <ListBox.ItemTemplate>
                                    <DataTemplate>
                                        <CheckBox 
                                                Checked="NumberFilterPeopleTab_Selected" 
                                                Unchecked="NumberFilterPeopleTab_Selected" 
                                                Content="{Binding}" 
                                                IsChecked="{Binding RelativeSource={RelativeSource AncestorType={x:Type ListBoxItem}}, Path=IsSelected}" />
                                    </DataTemplate>
                                </ListBox.ItemTemplate>
                            </ListBox>
                        </Expander>
                        <Expander Header="Профессия" Padding="5,2">
                            <ListBox 
                                    Margin="-5,0"
                                    x:Name="ProfessionFilterPeopleTab" 
                                    ItemsSource="{Binding Source={StaticResource GetProfessionsList}}" 
                                    SelectionMode="Multiple">
                                <ListBox.ItemTemplate>
                                    <DataTemplate>
                                        <CheckBox 
                                                Checked="ProfessionFilterPeopleTab_Selected" 
                                                Unchecked="ProfessionFilterPeopleTab_Selected" 
                                                Content="{Binding}" 
                                                IsChecked="{Binding RelativeSource={RelativeSource AncestorType={x:Type ListBoxItem}}, Path=IsSelected}" />
                                    </DataTemplate>
                                </ListBox.ItemTemplate>
                            </ListBox>
                        </Expander>
                    </StackPanel>
                </ScrollViewer>

                <Grid Grid.Row="2">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition />
                        <ColumnDefinition />
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="40"/>
                    </Grid.RowDefinitions>

                    <Button Grid.Column="0" Margin="2" Click="ClearFilterPeopleTab_Click" Content="Сбосить фильтр"  />
                    <Button Grid.Column="1" Margin="2" Click="FilterPeople_Click"         Content="Применить фильтр"/>
                </Grid>
            </Grid>
            <Grid Grid.Column="1" comment:Tab="Preferences Filter" 
                  DataContext="{StaticResource preferenceFilterVM}"
                  Visibility="{Binding IsSelected, Converter={StaticResource BooleanToVisibilityConverter}, ElementName=tabItem1}">

                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <Label Grid.Row="0" Content="Фильтры" FontSize="15" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Background="LightGray" />

                <ScrollViewer Grid.Row="1" comment:Group="Filters">
                    <StackPanel>
                        <Expander Header="Код человека" Padding="5,2">
                            <ListBox 
                                    Margin="-5,0"
                                    x:Name="UserIdsFilterPreferencesTab" 
                                    ItemsSource="{Binding Source={StaticResource GetCodesForFilter}}" 
                                    SelectionMode="Multiple">
                                <ListBox.ItemTemplate>
                                    <DataTemplate>
                                        <CheckBox 
                                                Checked="UserIdsFilterPreferencesTab_Selected" 
                                                Unchecked="UserIdsFilterPreferencesTab_Selected" 
                                                Content="{Binding}" 
                                                IsChecked="{Binding RelativeSource={RelativeSource AncestorType={x:Type ListBoxItem}}, Path=IsSelected}"/>
                                    </DataTemplate>
                                </ListBox.ItemTemplate>
                            </ListBox>
                        </Expander>
                        <Expander Header="Дата теста" Padding="5,2">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition />
                                    <ColumnDefinition />
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition/>
                                    <RowDefinition/>
                                </Grid.RowDefinitions>

                                <Label Grid.Row="0" Grid.Column="0" Content="Начало" HorizontalContentAlignment="Center" VerticalContentAlignment="Center"/>
                                <Label Grid.Row="0" Grid.Column="1" Content="Конец"  HorizontalContentAlignment="Center" VerticalContentAlignment="Center"/>

                                <DatePicker Grid.Row="1" Grid.Column="0" SelectedDate="{Binding DateFrom}" />
                                <DatePicker Grid.Row="1" Grid.Column="1" SelectedDate="{Binding DateTo}"   />
                            </Grid>
                        </Expander>
                        <Expander Header="Экспедиция" Padding="5,2">
                            <ListBox 
                                    Margin="-5,0"
                                    x:Name="ExpeditionFilterPreferencesTab" 
                                    ItemsSource="{Binding Source={StaticResource GetExpeditionCodes}}" 
                                    SelectionMode="Multiple">
                                <ListBox.ItemTemplate>
                                    <DataTemplate>
                                        <CheckBox 
                                                Checked="ExpeditionFilterPreferencesTab_Selected" 
                                                Unchecked="ExpeditionFilterPreferencesTab_Selected" 
                                                Content="{Binding}" 
                                                IsChecked="{Binding RelativeSource={RelativeSource AncestorType={x:Type ListBoxItem}}, Path=IsSelected}" />
                                    </DataTemplate>
                                </ListBox.ItemTemplate>
                            </ListBox>
                        </Expander>
                        <Expander Header="Номер человека" Padding="5,2">
                            <ListBox 
                                    Margin="-5,0"
                                    x:Name="NumberFilterPreferencesTab" 
                                    ItemsSource="{Binding Source={StaticResource GetPeopleCodes}}" 
                                    SelectionMode="Multiple">
                                <ListBox.ItemTemplate>
                                    <DataTemplate>
                                        <CheckBox 
                                                Checked="NumberFilterPreferencesTab_Selected" 
                                                Unchecked="NumberFilterPreferencesTab_Selected" 
                                                Content="{Binding}" 
                                                IsChecked="{Binding RelativeSource={RelativeSource AncestorType={x:Type ListBoxItem}}, Path=IsSelected}" />
                                    </DataTemplate>
                                </ListBox.ItemTemplate>
                            </ListBox>
                        </Expander>
                        <Expander Header="Профессия" Padding="5,2">
                            <ListBox 
                                    Margin="-5,0"
                                    x:Name="ProfessionFilterPreferencesTab" 
                                    ItemsSource="{Binding Source={StaticResource GetProfessionsList}}" 
                                    SelectionMode="Multiple">
                                <ListBox.ItemTemplate>
                                    <DataTemplate>
                                        <CheckBox 
                                                Checked="ProfessionFilterPreferencesTab_Selected" 
                                                Unchecked="ProfessionFilterPreferencesTab_Selected" 
                                                Content="{Binding}" 
                                                IsChecked="{Binding RelativeSource={RelativeSource AncestorType={x:Type ListBoxItem}}, Path=IsSelected}" />
                                    </DataTemplate>
                                </ListBox.ItemTemplate>
                            </ListBox>
                        </Expander>
                        <Expander Header="Преференция" Padding="5,2">
                            <ListBox 
                                    Margin="-5,0"
                                    x:Name="PreferenceFilterPreferenceTab" 
                                    ItemsSource="{Binding Source={StaticResource GetPreferencesList}}" 
                                    SelectionMode="Multiple">
                                <ListBox.ItemTemplate>
                                    <DataTemplate>
                                        <CheckBox 
                                                Checked="PreferenceFilterPreferencesTab_Selected" 
                                                Unchecked="PreferenceFilterPreferencesTab_Selected" 
                                                Content="{Binding}" 
                                                IsChecked="{Binding RelativeSource={RelativeSource AncestorType={x:Type ListBoxItem}}, Path=IsSelected}" />
                                    </DataTemplate>
                                </ListBox.ItemTemplate>
                            </ListBox>
                        </Expander>
                        <Expander Header="Расположение карточек" Padding="5,2">
                            <StackPanel>
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition />
                                        <ColumnDefinition />
                                        <ColumnDefinition />
                                    </Grid.ColumnDefinitions>

                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="22"   />
                                    </Grid.RowDefinitions>

                                    <TextBlock Grid.Column="0" HorizontalAlignment="Center" Text="1" />
                                    <TextBlock Grid.Column="1" HorizontalAlignment="Center" Text="2" />
                                    <TextBlock Grid.Column="2" HorizontalAlignment="Center" Text="3" />
                                    <TextBox Grid.Row="1" Grid.Column="0" Margin="5,0" TextAlignment="Center" Text="{Binding Color1in3Filter}" />
                                    <TextBox Grid.Row="1" Grid.Column="1" Margin="5,0" TextAlignment="Center" Text="{Binding Color2in3Filter}" />
                                    <TextBox Grid.Row="1" Grid.Column="2" Margin="5,0" TextAlignment="Center" Text="{Binding Color3in3Filter}" />
                                </Grid>

                                <Grid Margin="5">

                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition />
                                        <ColumnDefinition />
                                        <ColumnDefinition />
                                        <ColumnDefinition />
                                        <ColumnDefinition />
                                        <ColumnDefinition />
                                        <ColumnDefinition />
                                        <ColumnDefinition />
                                        <ColumnDefinition />
                                        <ColumnDefinition />
                                        <ColumnDefinition />
                                        <ColumnDefinition />
                                    </Grid.ColumnDefinitions>

                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="auto" />
                                        <RowDefinition Height="auto" />
                                    </Grid.RowDefinitions>

                                    <TextBlock Grid.Row="0" Grid.Column="0"  HorizontalAlignment="Center" TextAlignment="Center" Text="1"  />
                                    <TextBlock Grid.Row="0" Grid.Column="1"  HorizontalAlignment="Center" TextAlignment="Center" Text="2"  />
                                    <TextBlock Grid.Row="0" Grid.Column="2"  HorizontalAlignment="Center" TextAlignment="Center" Text="3"  />
                                    <TextBlock Grid.Row="0" Grid.Column="3"  HorizontalAlignment="Center" TextAlignment="Center" Text="4"  />
                                    <TextBlock Grid.Row="0" Grid.Column="4"  HorizontalAlignment="Center" TextAlignment="Center" Text="5"  />
                                    <TextBlock Grid.Row="0" Grid.Column="5"  HorizontalAlignment="Center" TextAlignment="Center" Text="6"  />
                                    <TextBlock Grid.Row="0" Grid.Column="6"  HorizontalAlignment="Center" TextAlignment="Center" Text="7"  />
                                    <TextBlock Grid.Row="0" Grid.Column="7"  HorizontalAlignment="Center" TextAlignment="Center" Text="8"  />
                                    <TextBlock Grid.Row="0" Grid.Column="8"  HorizontalAlignment="Center" TextAlignment="Center" Text="9"  />
                                    <TextBlock Grid.Row="0" Grid.Column="9"  HorizontalAlignment="Center" TextAlignment="Center" Text="10" />
                                    <TextBlock Grid.Row="0" Grid.Column="10" HorizontalAlignment="Center" TextAlignment="Center" Text="11" />
                                    <TextBlock Grid.Row="0" Grid.Column="11" HorizontalAlignment="Center" TextAlignment="Center" Text="12" />


                                    <TextBox Grid.Row="1" Grid.Column="0"  Text="{Binding Color1in12Filter}" />
                                    <TextBox Grid.Row="1" Grid.Column="1"  Text="{Binding Color2in12Filter}" />
                                    <TextBox Grid.Row="1" Grid.Column="2"  Text="{Binding Color3in12Filter}" />
                                    <TextBox Grid.Row="1" Grid.Column="3"  Text="{Binding Color4in12Filter}" />
                                    <TextBox Grid.Row="1" Grid.Column="4"  Text="{Binding Color5in12Filter}" />
                                    <TextBox Grid.Row="1" Grid.Column="5"  Text="{Binding Color6in12Filter}" />
                                    <TextBox Grid.Row="1" Grid.Column="6"  Text="{Binding Color7in12Filter}" />
                                    <TextBox Grid.Row="1" Grid.Column="7"  Text="{Binding Color8in12Filter}" />
                                    <TextBox Grid.Row="1" Grid.Column="8"  Text="{Binding Color9in12Filter}" />
                                    <TextBox Grid.Row="1" Grid.Column="9"  Text="{Binding Color10in12Filter}" />
                                    <TextBox Grid.Row="1" Grid.Column="10" Text="{Binding Color11in12Filter}" />
                                    <TextBox Grid.Row="1" Grid.Column="11" Text="{Binding Color12in12Filter}" />

                                </Grid>
                            </StackPanel>
                        </Expander>
                    </StackPanel>
                </ScrollViewer>
                <Grid Grid.Row="2" comment:Group="Biocolors">

                    <Grid.ColumnDefinitions>
                        <ColumnDefinition />
                        <ColumnDefinition />
                    </Grid.ColumnDefinitions>

                    <ListBox Grid.Column="0" Margin="2">
                        <TextBlock TextAlignment="Center" HorizontalAlignment="Center">Биоколор I</TextBlock>
                        <RadioButton Grid.Column="0" Name="BioColorIHide" HorizontalAlignment="Center">
                            Скрыть
                        </RadioButton>
                        <RadioButton Grid.Column="0" Name="BioColorIThree" HorizontalAlignment="Center" IsChecked="True">
                            3 цвета
                        </RadioButton>
                        <RadioButton Grid.Column="0" Name="BioColorITwelve" HorizontalAlignment="Center">
                            12 цветов
                        </RadioButton>
                    </ListBox>

                    <ListBox Grid.Column="1" Margin="2">
                        <TextBlock TextAlignment="Center" HorizontalAlignment="Center">Биоколор II</TextBlock>
                        <RadioButton Name="BioColorIIHide" Grid.Column="0" HorizontalAlignment="Center">
                            Скрыть
                        </RadioButton>
                        <RadioButton Name="BioColorIITwelve" Grid.Column="0" HorizontalAlignment="Center" IsChecked="True">
                            3 цвета
                        </RadioButton>
                        <RadioButton Name="BioColorIIPictures" Grid.Column="0" HorizontalAlignment="Center">
                            Картинки
                        </RadioButton>
                    </ListBox>
                </Grid>
                <Grid Grid.Row="3" comment:Group="Buttons">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="40"/>
                        <RowDefinition Height="40"/>
                        <RowDefinition Height="40"/>
                    </Grid.RowDefinitions>

                    <Grid.ColumnDefinitions>
                        <ColumnDefinition />
                        <ColumnDefinition />
                    </Grid.ColumnDefinitions>

                    <Button
                        Grid.Row="0"
                        Grid.Column="0" 
                        Margin="2"
                        Click="BuildInduvidualChart_Click" >
                        <TextBlock TextAlignment="Center">Индивидуальный<LineBreak/>график</TextBlock>
                    </Button>
                    <Button 
                        Grid.Row="0"
                        Grid.Column="1" 
                        Margin="2"
                        Content="Импорт"
                        Click="AddData_OnClick" />
                    <Button 
                        Grid.Row="1"
                        Grid.Column="0" 
                        Margin="2"
                        Content="Диаграма преф.1" 
                        Click="BildChartOnPreference1_Click"/>
                    <Button 
                        Grid.Row="1"
                        Grid.Column="1" 
                        Margin="2"
                        Content="Диаграма преф.2"
                        Click="BildChartOnPreference2_Click" />
                    <Button Grid.Row="2"
                        Grid.Column="0"
                        Margin="2"
                        Content="Сбосить фильтр" 
                        Click="ClearFilterPreferenceTab_Click"/>
                    <Button 
                        Grid.Row="2"
                        Grid.Column="1"
                        Margin="2"
                        Content="Применить фильтр"
                        Click="FilterPreference_Click" />
                </Grid>
            </Grid>
            <Grid Grid.Column="1" comment:Tab="Feelings Filter"
                  DataContext="{StaticResource subjectiveFeelingFilterVM}"
                  Visibility="{Binding IsSelected, Converter={StaticResource BooleanToVisibilityConverter}, ElementName=tabItem2}">

                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <Label Grid.Row="0" Content="Фильтры" FontSize="15" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Background="LightGray" />

                <ScrollViewer Grid.Row="1">
                    <StackPanel>
                        <Expander Header="Код человека" Padding="5,2">
                            <ListBox 
                                    Margin="-5,0"
                                    x:Name="UserIdsFilterFeelingsTab" 
                                    ItemsSource="{Binding Source={StaticResource GetCodesForFilter}}" 
                                    SelectionMode="Multiple">
                                <ListBox.ItemTemplate>
                                    <DataTemplate>
                                        <CheckBox 
                                                Checked="UserIdsFilterFeelingsTab_Selected" 
                                                Unchecked="UserIdsFilterFeelingsTab_Selected" 
                                                Content="{Binding}" 
                                                IsChecked="{Binding RelativeSource={RelativeSource AncestorType={x:Type ListBoxItem}}, Path=IsSelected}"/>
                                    </DataTemplate>
                                </ListBox.ItemTemplate>
                            </ListBox>
                        </Expander>
                        <Expander Header="Дата теста" Padding="5,2">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition />
                                    <ColumnDefinition />
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition/>
                                    <RowDefinition/>
                                </Grid.RowDefinitions>

                                <Label Grid.Row="0" Grid.Column="0" Content="Начало" HorizontalContentAlignment="Center" VerticalContentAlignment="Center"/>
                                <Label Grid.Row="0" Grid.Column="1" Content="Конец"  HorizontalContentAlignment="Center" VerticalContentAlignment="Center"/>

                                <DatePicker Grid.Row="1" Grid.Column="0" SelectedDate="{Binding DateFrom}" />
                                <DatePicker Grid.Row="1" Grid.Column="1" SelectedDate="{Binding DateTo}"   />
                            </Grid>
                        </Expander>
                        <Expander Header="Экспедиция" Padding="5,2">
                            <ListBox 
                                    Margin="-5,0"
                                    x:Name="ExpeditionFilterFeelingsTab" 
                                    ItemsSource="{Binding Source={StaticResource GetExpeditionCodes}}" 
                                    SelectionMode="Multiple">
                                <ListBox.ItemTemplate>
                                    <DataTemplate>
                                        <CheckBox 
                                                Checked="ExpeditionFilterFeelingsTab_Selected" 
                                                Unchecked="ExpeditionFilterFeelingsTab_Selected" 
                                                Content="{Binding}" 
                                                IsChecked="{Binding RelativeSource={RelativeSource AncestorType={x:Type ListBoxItem}}, Path=IsSelected}" />
                                    </DataTemplate>
                                </ListBox.ItemTemplate>
                            </ListBox>
                        </Expander>
                        <Expander Header="Номер человека" Padding="5,2">
                            <ListBox 
                                    Margin="-5,0"
                                    x:Name="NumberFilterFeelingsTab" 
                                    ItemsSource="{Binding Source={StaticResource GetPeopleCodes}}" 
                                    SelectionMode="Multiple">
                                <ListBox.ItemTemplate>
                                    <DataTemplate>
                                        <CheckBox 
                                                Checked="NumberFilterFeelingsTab_Selected" 
                                                Unchecked="NumberFilterFeelingsTab_Selected" 
                                                Content="{Binding}" 
                                                IsChecked="{Binding RelativeSource={RelativeSource AncestorType={x:Type ListBoxItem}}, Path=IsSelected}" />
                                    </DataTemplate>
                                </ListBox.ItemTemplate>
                            </ListBox>
                        </Expander>
                        <Expander Header="Профессия" Padding="5,2">
                            <ListBox 
                                    Margin="-5,0"
                                    x:Name="ProfessionFilterFeelingsTab" 
                                    ItemsSource="{Binding Source={StaticResource GetProfessionsList}}" 
                                    SelectionMode="Multiple">
                                <ListBox.ItemTemplate>
                                    <DataTemplate>
                                        <CheckBox 
                                                Checked="ProfessionFilterFeelingsTab_Selected" 
                                                Unchecked="ProfessionFilterFeelingsTab_Selected" 
                                                Content="{Binding}" 
                                                IsChecked="{Binding RelativeSource={RelativeSource AncestorType={x:Type ListBoxItem}}, Path=IsSelected}" />
                                    </DataTemplate>
                                </ListBox.ItemTemplate>
                            </ListBox>
                        </Expander>
                        <Expander Header="Ощущения" Padding="5,2">
                            <Border BorderBrush="Gray" BorderThickness="0.5" Padding="5">
                                <StackPanel>
                                    <CheckBox Checked="CheckBox_Selected" Content="Учитывать ощущения" IsChecked="{Binding IsFeeling}"  FontWeight="Bold" />
                                    <CheckBox Checked="CheckBox_Selected" Content="Общая слабость" IsChecked="{Binding GeneralWeakness}" />
                                    <CheckBox Checked="CheckBox_Selected" Content="Плохой аппетит" IsChecked="{Binding PoorAppetite}" />
                                    <CheckBox Checked="CheckBox_Selected" Content="Плохой сон" IsChecked="{Binding PoorSleep}" />
                                    <CheckBox Checked="CheckBox_Selected" Content="Плохое настроение" IsChecked="{Binding BadMood}" />
                                    <CheckBox Checked="CheckBox_Selected" Content="Тяжесть в голове" IsChecked="{Binding HeavyHead}" />
                                    <CheckBox Checked="CheckBox_Selected" Content="Замедленное мышление" IsChecked="{Binding SlowThink}" />
                                </StackPanel>
                            </Border>
                        </Expander>
                    </StackPanel>
                </ScrollViewer>

                <Grid Grid.Row="2">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="40"/>
                    </Grid.RowDefinitions>

                    <Grid.ColumnDefinitions>
                        <ColumnDefinition />
                        <ColumnDefinition />
                    </Grid.ColumnDefinitions>

                    <Button Grid.Column="0" Margin="2" Click="ClearFilterSubjFeelTab_Click" Content="Сбосить фильтр" />
                    <Button Grid.Column="1" Margin="2" Click="FilterSubjectiveFeeling_Click" Content="Применить фильтр" />
                </Grid>
            </Grid>

        </Grid>
        </Grid>
</Window>

<Window x:Class="StateEvaluation.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:view="clr-namespace:StateEvaluation.View"
        xmlns:helpers="clr-namespace:StateEvaluation.Helpers"
        xmlns:p="clr-namespace:StateEvaluation.Properties"
        xmlns:model="clr-namespace:StateEvaluation.Model"
        xmlns:sys="clr-namespace:System;assembly=mscorlib"
        xmlns:subjectiveFeelings="clr-namespace:StateEvaluation.ViewModel"
        xmlns:peopleInsert="clr-namespace:StateEvaluation.ViewModel"
        xmlns:preferenceInsert="clr-namespace:StateEvaluation.ViewModel"
        mc:Ignorable="d"
        ContentRendered="WindowRendered"
        Title="Оценка состояния" Height="768" Width="1366" WindowState="Maximized">
    <Window.Resources>
        <ObjectDataProvider x:Key="GetPeople" ObjectType="{x:Type model:PreferenceDB}" MethodName="GetPeople"></ObjectDataProvider>
        <ObjectDataProvider x:Key="GetPreferences" ObjectType="{x:Type model:PreferenceDB}" MethodName="GetPreferences"></ObjectDataProvider>
        <ObjectDataProvider x:Key="GetFeelings" ObjectType="{x:Type model:PreferenceDB}" MethodName="GetSubjecriveFeelings"></ObjectDataProvider>
        <ObjectDataProvider x:Key="GetCodesForInsert" ObjectType="{x:Type model:PreferenceDB}" MethodName="GetUserIds"></ObjectDataProvider>
        <ObjectDataProvider x:Key="GetCodesForFilter" ObjectType="{x:Type model:PreferenceDB}" MethodName="GetUserIds"></ObjectDataProvider>
        <ObjectDataProvider x:Key="GetPreferencesList" ObjectType="{x:Type model:PreferenceDB}" MethodName="Preferences"></ObjectDataProvider>
        <ObjectDataProvider x:Key="GetProfessionsList" ObjectType="{x:Type model:PreferenceDB}" MethodName="Professions"></ObjectDataProvider>
        <!--here defined resourses' name for exact model-->
        <subjectiveFeelings:SubjectiveFeelingVM x:Key="subjectiveFeelingVM" />
        <peopleInsert:PeopleVM x:Key="peopleVM" />
        <preferenceInsert:PreferenceVM x:Key="preferenceVM" />


        <ObjectDataProvider x:Key="GetPeopleCodes" ObjectType="{x:Type model:PreferenceDB}" MethodName="GetPeopleNumbers"></ObjectDataProvider>
        <ObjectDataProvider x:Key="GetExpeditionCodes" ObjectType="{x:Type model:PreferenceDB}" MethodName="GetExpeditionCodes"></ObjectDataProvider>
        <ObjectDataProvider x:Key="GetShortColorsNumbersList" ObjectType="{x:Type model:PreferenceDB}" MethodName="GetShortColorsNumbersList"></ObjectDataProvider>
        <ObjectDataProvider x:Key="GetColorsNumbersList" ObjectType="{x:Type model:PreferenceDB}" MethodName="GetColorsNumbersList"></ObjectDataProvider>
        <BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter"/>
        <helpers:StringToListConverter x:Key="StringToListConverter" />
        <helpers:NameToBrushConverter x:Key="NameToBrushConverter" />
        <helpers:NameToImageConverter x:Key="NameToImageConverter" />
        <helpers:DateToSin x:Key="DateToSin" />
        <helpers:BooleanToChecker x:Key="BooleanToChecker" />
        <helpers:NumberToRelax1Converter x:Key="NumberToRelax1Converter" />
        <helpers:NumberToRelax2Converter x:Key="NumberToRelax2Converter" />
        <helpers:NameToMultiBrushConverter x:Key="NameToMultiBrushConverter" />
        <helpers:PreferenceSameAsRelax x:Key="PreferenceSameAsRelax" />
        <helpers:PreferenceToBrushConverter x:Key="PreferenceToBrushConverter" />
        <helpers:ButtonToVisibilityConverter x:Key="ButtonToVisibilityConverter" />
        <helpers:BooleanToNOTVisibilityConverter x:Key="BooleanToNOTVisibilityConverter" />
        <helpers:TextColorNumberToBrushConverter x:Key="TextColorNumberToBrushConverter"/>
    </Window.Resources>
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="150"/>
            <RowDefinition/>
            <RowDefinition Height="30"/>
        </Grid.RowDefinitions>
        <TabControl x:Name="tabControl" Height="150" VerticalAlignment="Top" SelectionChanged="SetFilterVisibility">
            <!--<TabItem Header="{x:Static p:Resources.AddDataHeader}">
                <Grid Background="#FFE5E5E5"/>
            </TabItem>-->
            <TabItem x:Name="tabItem" IsSelected="True" DataContext="{StaticResource peopleVM}" Header="Люди">
                <Grid x:Name="PersonAddFormGrid" Background="#FFE5E5E5" Margin="0,0,0,33">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="119"/>
                    </Grid.RowDefinitions>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition/>
                    </Grid.ColumnDefinitions>
                    <Label Content="Имя" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Margin="10,11,0,82" HorizontalAlignment="Left" Width="193"/>
                    <Label Content="Фамилия" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Margin="186,11,0,82" HorizontalAlignment="Left" Width="193"/>
                    <Label Content="Отчество" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Margin="367,4,0,82" HorizontalAlignment="Left" Width="193"/>
                    <Label Content="День рождения" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Margin="537,11,0,82" HorizontalAlignment="Left" Width="193"/>
                    <Label Content="Профессия" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Margin="719,11,0,82" HorizontalAlignment="Left" Width="193"/>
                    <Label Content="Експедиция" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Margin="916,11,0,0" HorizontalAlignment="Left" Width="75" Height="26" VerticalAlignment="Top"/>
                    <Label Content="Номер" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Margin="996,11,0,0" HorizontalAlignment="Left" Width="77" Height="26" VerticalAlignment="Top"/>
                    <TextBox Text="{Binding Id}" Visibility="Hidden" Margin="0,0,0,0"/>
                    <TextBox Text="{Binding FirstName}" TextWrapping="Wrap" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Margin="33,42,0,52" HorizontalAlignment="Left" Width="150"/>
                    <TextBox Text="{Binding LastName}" TextWrapping="Wrap" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Margin="197,42,0,52" HorizontalAlignment="Left" Width="170"/>
                    <TextBox Text="{Binding MiddleName}" TextWrapping="Wrap" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Margin="381,42,0,52" HorizontalAlignment="Left" Width="167"/>
                    <DatePicker SelectedDate="{Binding Birthday}" Margin="563,42,0,52" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" HorizontalAlignment="Left" Width="149"/>
                    <TextBox Text="{Binding Workposition}" TextWrapping="Wrap" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Margin="730,42,0,52" HorizontalAlignment="Left" Width="165"/>
                    <TextBox Text="{Binding Expedition}" TextWrapping="Wrap" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Margin="921,42,0,52" HorizontalAlignment="Left" Width="60"/>
                    <TextBox Text="{Binding PersonNumber}" TextWrapping="Wrap" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Margin="1008,42,0,52" HorizontalAlignment="Left" Width="59"/>
                    <Button x:Name="AddPersonBtn" Content="Добавить" Margin="1086,22,0,76" Click="CreatePerson" HorizontalAlignment="Left" Width="105"/>
                    <Button x:Name="UpdatePersonBtn" Content="Сохранить" Margin="1209,33,0,65" Click="UpdatePerson" Visibility="Hidden" HorizontalAlignment="Left" Width="105" />
                    <Button Content="Сброс" Margin="1086,48,0,50" Visibility="Visible" HorizontalAlignment="Left" Width="105" Height="21" />
                </Grid>
            </TabItem>
            <TabItem x:Name="tabItem1" DataContext="{StaticResource preferenceVM}" Header="Преференции">
                <Grid Background="#FFE5E5E5" Margin="0,0,0,32">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="62" />
                        <ColumnDefinition Width="205"/>
                        <ColumnDefinition Width="0" />
                        <ColumnDefinition Width="auto" MinWidth="45" />
                        <ColumnDefinition Width="5" />
                        <ColumnDefinition Width="auto" />
                        <ColumnDefinition Width="5" />
                        <ColumnDefinition Width="auto" />
                        <ColumnDefinition Width="5" />
                        <ColumnDefinition Width="auto" />
                        <ColumnDefinition Width="5" />
                        <ColumnDefinition Width="auto" />
                        <ColumnDefinition Width="5" />
                        <ColumnDefinition Width="auto" />
                        <ColumnDefinition Width="5" />
                        <ColumnDefinition Width="auto" />
                        <ColumnDefinition Width="5" />
                        <ColumnDefinition Width="auto" />
                        <ColumnDefinition Width="5" />
                        <ColumnDefinition Width="auto" />
                        <ColumnDefinition Width="5" />
                        <ColumnDefinition Width="auto" />
                        <ColumnDefinition Width="5" />
                        <ColumnDefinition Width="auto" />
                        <ColumnDefinition Width="5" />
                        <ColumnDefinition Width="auto" />
                        <ColumnDefinition Width="5" />
                        <ColumnDefinition Width="auto" />
                        <ColumnDefinition Width="5" />
                        <ColumnDefinition Width="auto" />
                        <ColumnDefinition Width="5" />
                        <ColumnDefinition Width="auto" />
                        <ColumnDefinition Width="5" />
                        <ColumnDefinition Width="auto" />
                        <ColumnDefinition Width="5" />
                        <ColumnDefinition Width="400" />
                    </Grid.ColumnDefinitions>

                    <Grid.RowDefinitions>
                        <RowDefinition Height="73" />
                    </Grid.RowDefinitions>
                    <TextBlock
                               Grid.Column="0"
                               HorizontalAlignment="Center"
                               Text="Код" Margin="28,7,0,48" Width="34" RenderTransformOrigin="-1.5,0.474" />
                    <TextBlock
                               HorizontalAlignment="Center"
                               Text="Дата" Margin="59,7,118,48" Width="28" RenderTransformOrigin="0.571,1.947" Grid.Column="1" />
                    <TextBlock
                               Grid.Column="2"
                               HorizontalAlignment="Center"
                               Text="1" Margin="20,1,19,54" Width="6" Grid.ColumnSpan="2" />
                    <TextBlock
                               Grid.Column="5"
                               HorizontalAlignment="Center"
                               Text="2" Margin="17,1,17,54" Width="6" />
                    <TextBlock
                               Grid.Column="7"
                               HorizontalAlignment="Center"
                               Text="3" Margin="17,1,17,54" Width="6" />
                    <TextBlock
                               Grid.Column="11"
                               HorizontalAlignment="Center"
                               Text="1" Margin="17,1,17,54" Width="6" />
                    <TextBlock
                               Grid.Column="13"
                               HorizontalAlignment="Center"
                               Text="2" Margin="17,1,17,54" Width="6" />
                    <TextBlock
                               Grid.Column="15"
                               HorizontalAlignment="Center"
                               Text="3" Margin="17,1,17,54" Width="6" />
                    <TextBlock
                               Grid.Column="17"
                               HorizontalAlignment="Center"
                               Text="4" Margin="17,1,17,54" Width="6" />
                    <TextBlock
                               Grid.Column="19"
                               HorizontalAlignment="Center"
                               Text="5" Margin="17,1,17,54" Width="6" />
                    <TextBlock
                               Grid.Column="21"
                               HorizontalAlignment="Center"
                               Text="6" Margin="17,1,17,54" Width="6" />
                    <TextBlock
                               Grid.Column="23"
                               HorizontalAlignment="Center"
                               Text="7" Margin="17,1,17,54" Width="6" />
                    <TextBlock
                               Grid.Column="25"
                               HorizontalAlignment="Center"
                               Text="8" Margin="17,1,17,54" Width="6" />
                    <TextBlock
                               Grid.Column="27"
                               HorizontalAlignment="Center"
                               Text="9" Margin="17,1,17,54" Width="6" />
                    <TextBlock
                               Grid.Column="29"
                               HorizontalAlignment="Center"
                               Text="10" Margin="14,1,14,54" Width="12" />
                    <TextBlock
                               Grid.Column="31"
                               HorizontalAlignment="Center"
                               Text="11" Margin="13,1,13,54" Width="14" />
                    <TextBlock
                               Grid.Column="33"
                               HorizontalAlignment="Center"
                               Text="12" Margin="14,1,14,54" Width="12" />
                    <TextBlock
                               Grid.Column="35"
                               HorizontalAlignment="Center"
                               Text="Красная" Width="45" Margin="13,1,342,54" />
                    <TextBlock
                               Grid.Column="35"
                               HorizontalAlignment="Center"
                               Text="Желтая" Width="40" Margin="63,1,297,54" />
                    <TextBlock
                               Grid.Column="35"
                               HorizontalAlignment="Center"
                               Text="Синяя" Width="33" Margin="108,1,259,54" />
                    <TextBlock
                               Grid.Column="35"
                               HorizontalAlignment="Center"
                               Text="Смешанная" Width="64" Margin="146,1,190,54" />
                    <TextBlock
                               Grid.Column="35"
                               HorizontalAlignment="Center"
                               Text="Релакс" Margin="221,1,135,54" Width="44" />

                    <ComboBox x:Name="UserIdsSubFelingInsert"
                              Grid.Column="0"
                              Width="75"
                              HorizontalAlignment="Left"
                              VerticalAlignment="Top"
                              ItemsSource="{Binding Source={StaticResource GetCodesForInsert}}"
                              SelectedValue="{Binding UserId}" Height="22" Margin="5,29,0,0" Grid.ColumnSpan="2" />
                    <DatePicker x:Name="dateTimeForTest"
                                VerticalAlignment="Top"
                                SelectedDate="{Binding TestDate}" Height="24" HorizontalAlignment="Left" Width="100" Margin="28,29,0,0" Grid.Column="1" />
                    <TextBlock x:Name="TestID"
                                VerticalAlignment="Top"
                               Text="{Binding Id}"
                                Height="24" HorizontalAlignment="Left" Width="100"
                               Visibility="Hidden" Margin="23,46,0,0" Grid.Column="1"/>
                    <!-- Bio1 - 3 -->
                    <ComboBox x:Name="selectorC1in3"
                              Grid.Column="2"
                              SelectedValue="{Binding Color1in3}"
                              ItemsSource="{Binding Source={StaticResource GetShortColorsNumbersList}}" Margin="0,18,0,29" Grid.ColumnSpan="2"
                              />
                    <ComboBox x:Name="selectorC2in3"
                              Grid.Column="5"
                              SelectedValue="{Binding Color2in3}"
                              ItemsSource="{Binding Source={StaticResource GetShortColorsNumbersList}}" Margin="0,18,0,29"
                              />
                    <ComboBox x:Name="selectorC3in3"
                              Grid.Column="7"
                              SelectedValue="{Binding Color3in3}"
                              ItemsSource="{Binding Source={StaticResource GetShortColorsNumbersList}}" Margin="0,18,0,29"
                            />

                    <!-- Bio1 - 12 -->
                    <ComboBox x:Name="selectorC1in12"
                              Grid.Column="11"
                              ItemsSource="{Binding Source={StaticResource GetColorsNumbersList}}"
                              SelectedValue="{Binding Color1in12}" Margin="0,18,0,29" />
                    <ComboBox x:Name="selectorC2in12"
                              Grid.Column="13"
                              ItemsSource="{Binding Source={StaticResource GetColorsNumbersList}}"
                              SelectedValue="{Binding Color2in12}" Margin="0,18,0,29" />
                    <ComboBox x:Name="selectorC3in12"
                              Grid.Column="15"
                              ItemsSource="{Binding Source={StaticResource GetColorsNumbersList}}"
                              SelectedValue="{Binding Color3in12}" Margin="0,18,0,29" />
                    <ComboBox x:Name="selectorC4in12"
                              Grid.Column="17"
                              ItemsSource="{Binding Source={StaticResource GetColorsNumbersList}}"
                              SelectedValue="{Binding Color4in12}" Margin="0,18,0,29" />
                    <ComboBox x:Name="selectorC5in12"
                              Grid.Column="19"
                              ItemsSource="{Binding Source={StaticResource GetColorsNumbersList}}"
                              SelectedValue="{Binding Color5in12}" Margin="0,18,0,29" />
                    <ComboBox x:Name="selectorC6in12"
                              Grid.Column="21"
                              ItemsSource="{Binding Source={StaticResource GetColorsNumbersList}}"
                              SelectedValue="{Binding Color6in12}" Margin="0,18,0,29" />
                    <ComboBox x:Name="selectorC7in12"
                              Grid.Column="23"
                              ItemsSource="{Binding Source={StaticResource GetColorsNumbersList}}"
                              SelectedValue="{Binding Color7in12}" Margin="0,18,0,29" />
                    <ComboBox x:Name="selectorC8in12"
                              Grid.Column="25"
                              ItemsSource="{Binding Source={StaticResource GetColorsNumbersList}}"
                              SelectedValue="{Binding Color8in12}" Margin="0,18,0,29" />
                    <ComboBox x:Name="selectorC9in12"
                              Grid.Column="27"
                              ItemsSource="{Binding Source={StaticResource GetColorsNumbersList}}"
                              SelectedValue="{Binding Color9in12}" Margin="0,18,0,29" />
                    <ComboBox x:Name="selectorC10in12"
                              Grid.Column="29"
                              ItemsSource="{Binding Source={StaticResource GetColorsNumbersList}}"
                              SelectedValue="{Binding Color10in12}" Margin="0,18,0,29" />
                    <ComboBox x:Name="selectorC11in12"
                              Grid.Column="31"
                              ItemsSource="{Binding Source={StaticResource GetColorsNumbersList}}"
                              SelectedValue="{Binding Color11in12}" Margin="0,18,0,29" />
                    <ComboBox x:Name="selectorC12in12"
                              Grid.Column="33"
                              ItemsSource="{Binding Source={StaticResource GetColorsNumbersList}}"
                              SelectedValue="{Binding Color12in12}" Margin="0,18,0,29"/>
                    <!-- Bio1 - Pref -->
                    <RadioButton x:Name="RedStat"
                             Grid.Column="35"
                             GroupName="Pref1" Margin="21,22,349,19"
                             IsChecked="{Binding Preference1Red}"/>
                    <RadioButton x:Name="YellowStat"
                             Grid.Column="35"
                             GroupName="Pref1" Margin="69,22,301,19" 
                             IsChecked="{Binding Preference1Yellow}"/>
                    <RadioButton x:Name="BlueStat"
                             Grid.Column="35"
                             GroupName="Pref1" Margin="111,22,259,19" 
                             IsChecked="{Binding Preference1Blue}"/>
                    <RadioButton x:Name="GrayStat"
                             Grid.Column="35"
                             GroupName="Pref1" Margin="164,22,206,19"
                             IsChecked="{Binding Preference1Grey}"/>
                    <!-- Bio1 - R -->
                    <ComboBox x:Name="selectorRelax1"
                              Grid.Column="35"
                              ItemsSource="{Binding Source={StaticResource GetColorsNumbersList}}"
                              SelectedValue="{Binding ColorRelax1}" Margin="220,18,140,29"/>

                    <!-- Bio2 - 3 -->
                    <ComboBox x:Name="selectorC21in3"
                              Grid.Column="2"
                              SelectedValue="{Binding Color21in3}"
                              ItemsSource="{Binding Source={StaticResource GetShortColorsNumbersList}}" Margin="0,46,0,0" Grid.ColumnSpan="2"
                              />
                    <ComboBox x:Name="selectorC22in3"
                              Grid.Column="5"
                              SelectedValue="{Binding Color22in3}"
                              ItemsSource="{Binding Source={StaticResource GetShortColorsNumbersList}}" Margin="0,46,0,0"
                              />
                    <ComboBox x:Name="selectorC23in3"
                              Grid.Column="7"
                              SelectedValue="{Binding Color23in3}"
                              ItemsSource="{Binding Source={StaticResource GetShortColorsNumbersList}}" Margin="0,46,0,0"
                            />

                    <!-- Bio2 - 12 -->
                    <ComboBox x:Name="selectorC21in12"
                              Grid.Column="11"
                              ItemsSource="{Binding Source={StaticResource GetColorsNumbersList}}"
                              SelectedValue="{Binding Color21in12}" Margin="0,46,0,0" />
                    <ComboBox x:Name="selectorC22in12"
                              Grid.Column="13"
                              ItemsSource="{Binding Source={StaticResource GetColorsNumbersList}}"
                              SelectedValue="{Binding Color22in12}" Margin="0,46,0,0" />
                    <ComboBox x:Name="selectorC23in12"
                              Grid.Column="15"
                              ItemsSource="{Binding Source={StaticResource GetColorsNumbersList}}"
                              SelectedValue="{Binding Color23in12}" Margin="0,46,0,0" />
                    <ComboBox x:Name="selectorC24in12"
                              Grid.Column="17"
                              ItemsSource="{Binding Source={StaticResource GetColorsNumbersList}}"
                              SelectedValue="{Binding Color24in12}" Margin="0,46,0,0" />
                    <ComboBox x:Name="selectorC25in12"
                              Grid.Column="19"
                              ItemsSource="{Binding Source={StaticResource GetColorsNumbersList}}"
                              SelectedValue="{Binding Color25in12}" Margin="0,46,0,0" />
                    <ComboBox x:Name="selectorC26in12"
                              Grid.Column="21"
                              ItemsSource="{Binding Source={StaticResource GetColorsNumbersList}}"
                              SelectedValue="{Binding Color26in12}" Margin="0,46,0,0" />
                    <ComboBox x:Name="selectorC27in12"
                              Grid.Column="23"
                              ItemsSource="{Binding Source={StaticResource GetColorsNumbersList}}"
                              SelectedValue="{Binding Color27in12}" Margin="0,46,0,0" />
                    <ComboBox x:Name="selectorC28in12"
                              Grid.Column="25"
                              ItemsSource="{Binding Source={StaticResource GetColorsNumbersList}}"
                              SelectedValue="{Binding Color28in12}" Margin="0,46,0,0" />
                    <ComboBox x:Name="selectorC29in12"
                              Grid.Column="27"
                              ItemsSource="{Binding Source={StaticResource GetColorsNumbersList}}"
                              SelectedValue="{Binding Color29in12}" Margin="0,46,0,0" />
                    <ComboBox x:Name="selectorC210in12"
                              Grid.Column="29"
                              ItemsSource="{Binding Source={StaticResource GetColorsNumbersList}}"
                              SelectedValue="{Binding Color210in12}" Margin="0,46,0,0" />
                    <ComboBox x:Name="selectorC211in12"
                              Grid.Column="31"
                              ItemsSource="{Binding Source={StaticResource GetColorsNumbersList}}"
                              SelectedValue="{Binding Color211in12}" Margin="0,46,0,0" />
                    <ComboBox x:Name="selectorC212in12"
                              Grid.Column="33"
                              ItemsSource="{Binding Source={StaticResource GetColorsNumbersList}}"
                              SelectedValue="{Binding Color212in12}" Margin="0,46,0,0" />
                    <!-- Bio2 - Pref -->
                    <RadioButton x:Name="Red2Stat"
                             Grid.Column="35"
                             GroupName="Pref2" Margin="21,50,349,-4"
                             IsChecked="{Binding Preference2Red}"/>
                    <RadioButton x:Name="Yellow2Stat"
                             Grid.Column="35"
                             GroupName="Pref2" Margin="69,50,301,-4"
                             IsChecked="{Binding Preference2Yellow}"/>
                    <RadioButton x:Name="Blue2Stat"
                             Grid.Column="35"
                             GroupName="Pref2" Margin="111,50,259,-4" 
                             IsChecked="{Binding Preference2Blue}"/>
                    <RadioButton x:Name="Gray2Stat"
                             Grid.Column="35"
                             GroupName="Pref2" Margin="164,50,206,-4"
                             IsChecked="{Binding Preference2Grey}"/>
                    <!-- Bio2 - R -->
                    <ComboBox x:Name="selectorRelax2"
                              Grid.Column="35"
                              ItemsSource="{Binding Source={StaticResource GetColorsNumbersList}}"
                              SelectedValue="{Binding ColorRelax2}" Margin="220,46,140,0"/>
                    <!-- End -->
                    <Button
                            Grid.Column="35"
                            Margin="0,1,291,22"
                            Visibility="Hidden"
                            Command="{Binding ChangeColors}"
                            Content="Сменить раскраску" />

                    <Button
                            Grid.Column="35"
                            Margin="281,9,10,42"
                            Click="CreatePreferense"
                            Content="Добавить запись" />

                    <Button
                            Grid.Column="35"
                            Margin="281,34,10,16"
                            Click="ResetPreferenceInputs"
                            Content="Сброс выбора"  />
                    <TextBlock
                        HorizontalAlignment="Center"
                        Text="Биоколор 1" Margin="137,24,42,30" Width="71" Grid.Column="1" Grid.ColumnSpan="3" />
                    <TextBlock
                        HorizontalAlignment="Center"
                        Margin="137,50,2,-7" Width="66" Text="Биоколор 2" Grid.Column="1" />
                    <Button x:Name="UpdatePrefernceBtn"
                        Grid.Column="35"
                        Margin="281,60,10,-8"
                        Click="UpdatePreference"
                        Content="Применить"
                        Visibility="Hidden"/>
                </Grid>
            </TabItem>
            <TabItem x:Name="tabItem2" DataContext="{StaticResource subjectiveFeelingVM}" Header="Субъективные ощущения">
                <Grid x:Name="DataFridSubjectiveFeelings" Background="#FFE5E5E5" Margin="0,0,0,31">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="1352" />
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="122" />
                    </Grid.RowDefinitions>
                    <Button
                            Margin="932,37,311,61"
                            Click="AddFeelingPeople"
                            Content="Добавить запись" />
                    <Button
                        x:Name="UpdateSubjectiveFeelingBtn"
                            Margin="1161,37,81,61"
                            Click="UpdateSubjectiveFeeling"
                            Content="Применить" 
                        Visibility="Hidden"/>

                    <TextBlock Grid.Row="0"
                               Grid.Column="0"
                               HorizontalAlignment="Center"
                               Text="Код" Margin="66,17,1266,88" />
                    <TextBlock
                               HorizontalAlignment="Center"
                               Text="Дата" Margin="177,14,1149,83" />
                    <TextBlock
                               HorizontalAlignment="Center"
                               Text="Общая слабость" Margin="279,14,983,83" />
                    <TextBlock
                               HorizontalAlignment="Center"
                               Text="Плохой аппетит" Margin="379,14,885,83" />
                    <TextBlock
                               HorizontalAlignment="Center"
                               Text="Плохой сон" Margin="477,14,810,83" />
                    <TextBlock
                               HorizontalAlignment="Center"
                               Text="Плохое настроение" Margin="551,14,692,83" />
                    <TextBlock
                               HorizontalAlignment="Center"
                               Text="Тяжесть в голове" Margin="669,14,588,83" />
                    <TextBlock
                               HorizontalAlignment="Center"
                               Text="Замедленное мышление" Margin="774,14,441,83" />

                    <ComboBox x:Name="UserIdsPreferenceInsert"
                              Grid.Column="0"
                              Width="80"
                              HorizontalAlignment="Left"
                              VerticalAlignment="Top"
                              ItemsSource="{Binding Source={StaticResource GetCodesForInsert}}"
                              SelectedValue="{Binding UserId}" Margin="36,39,0,0"/>


                    <DatePicker
                                HorizontalAlignment="Left"
                                VerticalAlignment="Top"
                                x:Name="selectedDateInSubjectiveFeeling"
                                SelectedDate="{Binding Date}" Margin="145,37,0,0" />
                    <CheckBox
                              HorizontalAlignment="Center"
                              VerticalAlignment="Center"
                              x:Name="markGeneralWeakness"
                              IsChecked="{Binding GeneralWeaknes}" Margin="316,44,1020,63" />
                    <CheckBox
                              HorizontalAlignment="Center"
                              VerticalAlignment="Center"
                              x:Name="markBadAppetite"
                              IsChecked="{Binding PoorAppetite}" Margin="415,44,921,63" />
                    <CheckBox
                              HorizontalAlignment="Center"
                              VerticalAlignment="Center"
                              x:Name="markBadDream"
                              IsChecked="{Binding PoorSleep}" Margin="501,44,835,63" />
                    <CheckBox
                              HorizontalAlignment="Center"
                              VerticalAlignment="Center"
                              x:Name="markBadMood"
                              IsChecked="{Binding BadMood}" Margin="597,44,739,63" />
                    <CheckBox
                              HorizontalAlignment="Center"
                              VerticalAlignment="Center"
                              x:Name="markHeavyHead"
                              IsChecked="{Binding HeavyHead}" Margin="709,44,627,63" />
                    <CheckBox
                              HorizontalAlignment="Center"
                              VerticalAlignment="Center"
                              x:Name="markSlowThink"
                              IsChecked="{Binding SlowThink}" Margin="834,44,502,63" />

                    <TextBox Text="{Binding Id}"
                             HorizontalAlignment="Center"
                             VerticalAlignment="Center"
                             Visibility="Hidden" Margin="837,57,505,47"/>
                    <Button
                        Margin="1046,37,196,61"
                        Content="Сброс" 
                        Visibility="Visible"/>
                </Grid>
            </TabItem>

            <TabItem x:Name="tabItem3" Header="Биоколор">
                <Grid Background="#FFE5E5E5">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="0*"/>
                        <ColumnDefinition/>
                    </Grid.ColumnDefinitions>
                    <Label  Height="25" VerticalAlignment="Top" Width="150" HorizontalAlignment="Left" Margin="26,10,0,0" Grid.ColumnSpan="2" Content="Дата рождения"/>
                    <DatePicker Height="25" Width="111" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="26,34,0,0" Name="Date"     VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Grid.ColumnSpan="2"/>
                    <Label   Height="25" Width="150" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="161,10,0,0" Grid.ColumnSpan="2" Content="Дата расчета"/>

                    <Button   Height="25" Width="75" VerticalAlignment="Top" HorizontalAlignment="Left" Click = "Prew" Margin="569,34,0,0" Grid.ColumnSpan="2" Content="Назад" />
                    <Button   Height="25" Width="75" VerticalAlignment="Top" HorizontalAlignment="Left" Click = "Next" Margin="658,34,0,0" Grid.ColumnSpan="2" Content="Вперед" />
                    <Button   Height="25" Width="75" VerticalAlignment="Top" HorizontalAlignment="Left" Click = "Menu" Margin="926,26,0,0" Grid.ColumnSpan="2" Visibility="Hidden">Menu</Button>

                    <DatePicker Height="25" Width="102" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="161,34,0,0" Name="DateNow" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" SelectedDate="{x:Static sys:DateTime.Now}" Grid.ColumnSpan="2"/>
                    <Button  Height="25" Width="150" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="379,34,0,0" Click="DrawGraphs" Grid.ColumnSpan="2">Построить графики</Button>
                    <Button  Height="25" Width="150" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="1026,26,0,0" Click="Generate" Grid.ColumnSpan="2" Visibility="Hidden">Создать изображение</Button>
                </Grid>
            </TabItem>
            <TabItem x:Name="ColorSettingsTab" Header="Цвета"/>
        </TabControl>
        <Grid Margin="0" Grid.Row="1">
            <Grid.ColumnDefinitions>
                <ColumnDefinition/>
                <ColumnDefinition MaxWidth="250" Width="250"/>
            </Grid.ColumnDefinitions>

            <DataGrid x:Name="PeopleDataGrid" CanUserAddRows="False" CanUserDeleteRows="False" ItemsSource="{Binding Source={StaticResource GetPeople}}" IsSynchronizedWithCurrentItem="True" AutoGenerateColumns="False" Margin="0,-35,0,-31">
                <DataGrid.Columns>
                    <DataGridTextColumn Binding="{Binding Id}" Visibility="Hidden"/>
                    <DataGridTextColumn Width="auto" Header="Код" Binding="{Binding UserId}"  ClipboardContentBinding="{x:Null}"/>
                    <DataGridTextColumn Width="auto" Header="Имя" Binding="{Binding Lastname}" ClipboardContentBinding="{x:Null}"/>
                    <DataGridTextColumn Width="auto" Header="Фамилия" Binding="{Binding Firstname}" ClipboardContentBinding="{x:Null}"/>
                    <DataGridTextColumn Width="auto" Header="Отчество" Binding="{Binding Middlename}" ClipboardContentBinding="{x:Null}"/>
                    <DataGridTextColumn Width="auto" Header="День рождения" Binding="{Binding Birthday, StringFormat=\{0:d\}}" ClipboardContentBinding="{x:Null}"/>
                    <DataGridTextColumn Width="auto" Header="Профессия" Binding="{Binding Workposition, UpdateSourceTrigger=PropertyChanged}" ClipboardContentBinding="{x:Null}"/>
                    <DataGridTextColumn Width="auto" Header="Експедиция" Binding="{Binding Expedition}" ClipboardContentBinding="{x:Null}"/>
                    <DataGridTextColumn Width="auto" Header="Номер" Binding="{Binding Number}" ClipboardContentBinding="{x:Null}"/>
                    <DataGridTemplateColumn ClipboardContentBinding="{x:Null}">
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>
                                <Button x:Name="EditPersonBtn" Content="&#xE70F;" FontFamily="Segoe MDL2 Assets" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Width="Auto" BorderBrush="White" Background="White" Foreground="Black" FontSize="14" Click="BindPersonInForm" Tag="{Binding Id}"/>
                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>
                    </DataGridTemplateColumn>
                    <DataGridTemplateColumn ClipboardContentBinding="{x:Null}">
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>
                                <Button x:Name="RemovePersonBtn" Content="&#xE107;" FontFamily="Segoe MDL2 Assets" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Width="Auto" BorderBrush="White" Background="White" Foreground="Red" FontSize="14" Click="RemovePerson"/>
                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>
                    </DataGridTemplateColumn>
                </DataGrid.Columns>
            </DataGrid>

            <DataGrid x:Name="PreferencesDataGrid" CanUserAddRows="False" ItemsSource="{Binding Source={StaticResource GetPreferences}}" IsSynchronizedWithCurrentItem="True" AutoGenerateColumns="False" Margin="0,-35,0,-31" Visibility="{Binding IsSelected, Converter={StaticResource BooleanToVisibilityConverter}, ElementName=tabItem1}">
                <DataGrid.Columns>
                    <DataGridTemplateColumn Header="График" Width="auto" ClipboardContentBinding="{x:Null}">
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>
                                <Button
                                Command="{Binding MakeIndividualChartCommand}"
                                Content="&#xE929;"
                                FontFamily="Segoe MDL2 Assets"
                                ToolTip="{x:Static p:Resources.MakeChartToolTip}" Click="Button_Click" />
                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>
                    </DataGridTemplateColumn>
                    <DataGridTextColumn Binding="{Binding Id}" Visibility="Hidden"/>
                    <DataGridTextColumn Header="Код" Width="auto" Binding="{Binding UserId}" ClipboardContentBinding="{x:Null}" FontSize="14"/>
                    <DataGridTextColumn Header="Дата" Width="auto" Binding="{Binding Date, StringFormat=\{0:d\}}" ClipboardContentBinding="{x:Null}"/>
                    <!-- BioColor I START -->
                    <!-- BioColor I (Three) -->
                    <DataGridTemplateColumn Header="Короткий 1" Width="auto" ClipboardContentBinding="{x:Null}"
                                                 Visibility="{Binding Path=IsChecked, Source={x:Reference BioColorIHide}, Converter={StaticResource BooleanToNOTVisibilityConverter}}">
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>
                                <ListView ItemsSource="{Binding ShortOder1, Converter={StaticResource StringToListConverter}}">
                                    <ListView.ItemTemplate>
                                        <DataTemplate>
                                            <Label Content="{Binding}" Foreground="{Binding Content, Converter={StaticResource TextColorNumberToBrushConverter}, RelativeSource={RelativeSource Self}}"  Background="{Binding Content,Converter={StaticResource NameToBrushConverter}, IsAsync=True, NotifyOnTargetUpdated=True, NotifyOnSourceUpdated=True, NotifyOnValidationError=True, RelativeSource={RelativeSource Self}, ValidatesOnNotifyDataErrors=False}" BorderBrush="Black" BorderThickness="1" Width="25" MinWidth="25"></Label>
                                        </DataTemplate>
                                    </ListView.ItemTemplate>
                                    <ListView.ItemsPanel>
                                        <ItemsPanelTemplate>
                                            <StackPanel Orientation="Horizontal"></StackPanel>
                                        </ItemsPanelTemplate>
                                    </ListView.ItemsPanel>
                                </ListView>
                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>
                    </DataGridTemplateColumn>

                    <DataGridTemplateColumn ClipboardContentBinding="{x:Null}"/>
                    <!-- BioColor I (ThreeColor) -->
                    <DataGridTemplateColumn Header="Биоколор 1" Width="auto" ClipboardContentBinding="{x:Null}" MinWidth="280"
                                                 Visibility="{Binding Path=IsChecked, Source={x:Reference BioColorIThree}, Converter={StaticResource BooleanToVisibilityConverter}}">
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>
                                <ListView ItemsSource="{Binding Oder1, Converter={StaticResource StringToListConverter}}" Padding="-4,0,0,0" Margin="0" Width="Auto" HorizontalAlignment="Left" MinWidth="270">
                                    <ListView.ItemTemplate>
                                        <DataTemplate>
                                            <Label Content="{Binding}" Foreground="{Binding Content, Converter={StaticResource TextColorNumberToBrushConverter}, RelativeSource={RelativeSource Self}}" Background="{Binding Content,Converter={StaticResource NameToBrushConverter}, IsAsync=True, NotifyOnTargetUpdated=True, NotifyOnSourceUpdated=True, NotifyOnValidationError=True, RelativeSource={RelativeSource Self}, ValidatesOnNotifyDataErrors=False}" BorderBrush="Black" BorderThickness="1" MinWidth="25"></Label>
                                        </DataTemplate>
                                    </ListView.ItemTemplate>
                                    <ListView.ItemsPanel>
                                        <ItemsPanelTemplate>
                                            <StackPanel Orientation="Horizontal"></StackPanel>
                                        </ItemsPanelTemplate>
                                    </ListView.ItemsPanel>
                                </ListView>
                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>
                    </DataGridTemplateColumn>

                    <!-- BioColor I (TwelveColor) -->
                    <DataGridTemplateColumn Header="Биоколор 2" Width="auto" ClipboardContentBinding="{x:Null}" MinWidth="280"
                                             Visibility="{Binding Path=IsChecked, Source={x:Reference BioColorITwelve}, Converter={StaticResource BooleanToVisibilityConverter}}">
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>
                                <ListView ItemsSource="{Binding Oder1, Converter={StaticResource StringToListConverter}}" Padding="-4,0,0,0" Margin="0" Width="Auto" HorizontalAlignment="Left" MinWidth="270">
                                    <ListView.ItemTemplate>
                                        <DataTemplate>
                                            <Label Content="{Binding}" Foreground="{Binding Content, Converter={StaticResource TextColorNumberToBrushConverter}, RelativeSource={RelativeSource Self}}" 
											Background="{Binding Content,Converter={StaticResource NameToMultiBrushConverter}, IsAsync=True, NotifyOnTargetUpdated=True, NotifyOnSourceUpdated=True, NotifyOnValidationError=True, RelativeSource={RelativeSource Self}, ValidatesOnNotifyDataErrors=False}" BorderBrush="Black" BorderThickness="1" MinWidth="25"></Label>
                                        </DataTemplate>
                                    </ListView.ItemTemplate>
                                    <ListView.ItemsPanel>
                                        <ItemsPanelTemplate>
                                            <StackPanel Orientation="Horizontal"></StackPanel>
                                        </ItemsPanelTemplate>
                                    </ListView.ItemsPanel>
                                </ListView>
                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>
                    </DataGridTemplateColumn>

                    <!-- Preference1 -->
                    <DataGridTextColumn x:Name="Pre1" Header="Преференция 1" Width="auto" Binding="{Binding Preference1}" ClipboardContentBinding="{x:Null}"
                                        Visibility="{Binding Path=IsChecked, Source={x:Reference BioColorIHide}, Converter={StaticResource BooleanToNOTVisibilityConverter}}">
                        <DataGridTextColumn.ElementStyle>
                            <Style TargetType="{x:Type TextBlock}">
                                <Setter Property="Background" Value="{Binding Preference1, Converter={StaticResource PreferenceToBrushConverter}}" />
                                <Setter Property="TextAlignment" Value="Center"></Setter>
                            </Style>
                        </DataGridTextColumn.ElementStyle>
                    </DataGridTextColumn>
                    <!-- BioColor I END -->

                    <DataGridTemplateColumn ClipboardContentBinding="{x:Null}"/>
                    <!-- BioColor II START -->
                    <!-- BioColor II (Three) -->
                    <DataGridTemplateColumn Header="Короткий 2" Width="auto" ClipboardContentBinding="{x:Null}"
                                                 Visibility="{Binding Path=IsChecked, Source={x:Reference BioColorIITwelve}, Converter={StaticResource BooleanToVisibilityConverter}}">
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>
                                <ListView ItemsSource="{Binding ShortOder2, Converter={StaticResource StringToListConverter}}">
                                    <ListView.ItemTemplate>
                                        <DataTemplate>
                                            <Label Content="{Binding}" Foreground="{Binding Content, Converter={StaticResource TextColorNumberToBrushConverter}, RelativeSource={RelativeSource Self}}"  Background="{Binding Content,Converter={StaticResource NameToBrushConverter}, IsAsync=True, NotifyOnTargetUpdated=True, NotifyOnSourceUpdated=True, NotifyOnValidationError=True, RelativeSource={RelativeSource Self}, ValidatesOnNotifyDataErrors=False}" BorderBrush="Black" BorderThickness="1" Width="25" ></Label>
                                        </DataTemplate>
                                    </ListView.ItemTemplate>
                                    <ListView.ItemsPanel>
                                        <ItemsPanelTemplate>
                                            <StackPanel Orientation="Horizontal"></StackPanel>
                                        </ItemsPanelTemplate>
                                    </ListView.ItemsPanel>
                                </ListView>
                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>
                    </DataGridTemplateColumn>

                    <!-- BioColor II (ThreePictures) -->
                    <DataGridTemplateColumn  ClipboardContentBinding="{x:Null}"
                                                 Visibility="{Binding Path=IsChecked, Source={x:Reference BioColorIIPictures}, Converter={StaticResource BooleanToVisibilityConverter}}">
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>
                                <ListView ItemsSource="{Binding ShortOder2, Converter={StaticResource StringToListConverter}}">
                                    <ListView.ItemTemplate>
                                        <DataTemplate>
                                            <Label Content="{Binding}" Foreground="{Binding Content, Converter={StaticResource TextColorNumberToBrushConverter}, RelativeSource={RelativeSource Self}}"  Background="{Binding Content,Converter={StaticResource NameToImageConverter}, IsAsync=True, NotifyOnTargetUpdated=True, NotifyOnSourceUpdated=True, NotifyOnValidationError=True, RelativeSource={RelativeSource Self}, ValidatesOnNotifyDataErrors=False}" BorderBrush="Black" BorderThickness="1" Width="25"></Label>
                                        </DataTemplate>
                                    </ListView.ItemTemplate>
                                    <ListView.ItemsPanel>
                                        <ItemsPanelTemplate>
                                            <StackPanel Orientation="Horizontal"></StackPanel>
                                        </ItemsPanelTemplate>
                                    </ListView.ItemsPanel>
                                </ListView>
                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>
                    </DataGridTemplateColumn>

                    <DataGridTemplateColumn ClipboardContentBinding="{x:Null}"/>
                    <!-- BioColor II (TwelveColor) -->
                    <DataGridTemplateColumn Header="Биоколор 2" Width="auto" ClipboardContentBinding="{x:Null}" MinWidth="280"
                                                 Visibility="{Binding Path=IsChecked, Source={x:Reference BioColorIITwelve}, Converter={StaticResource BooleanToVisibilityConverter}}">
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>
                                <ListView ItemsSource="{Binding Oder2, Converter={StaticResource StringToListConverter}}" Padding="-4,0,0,0" Margin="0" Width="Auto" HorizontalAlignment="Left" MinWidth="270">
                                    <ListView.ItemTemplate>
                                        <DataTemplate>
                                            <Label Content="{Binding}" Foreground="{Binding Content, Converter={StaticResource TextColorNumberToBrushConverter}, RelativeSource={RelativeSource Self}}" Background="{Binding Content,Converter={StaticResource NameToBrushConverter}, IsAsync=True, NotifyOnTargetUpdated=True, NotifyOnSourceUpdated=True, NotifyOnValidationError=True, RelativeSource={RelativeSource Self}, ValidatesOnNotifyDataErrors=False}" BorderBrush="Black" BorderThickness="1" MinWidth="25"></Label>
                                        </DataTemplate>
                                    </ListView.ItemTemplate>
                                    <ListView.ItemsPanel>
                                        <ItemsPanelTemplate>
                                            <StackPanel Orientation="Horizontal"></StackPanel>
                                        </ItemsPanelTemplate>
                                    </ListView.ItemsPanel>
                                </ListView>
                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>
                    </DataGridTemplateColumn>
                    <!-- BioColor II (TwelvePictures) -->
                    <DataGridTemplateColumn Header="Биоколор 2" Width="auto" ClipboardContentBinding="{x:Null}" MinWidth="280"
                                             Visibility="{Binding Path=IsChecked, Source={x:Reference BioColorIIPictures}, Converter={StaticResource BooleanToVisibilityConverter}}">
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>
                                <ListView ItemsSource="{Binding Oder2, Converter={StaticResource StringToListConverter}}" Padding="-4,0,0,0" Margin="0" Width="Auto" HorizontalAlignment="Left" MinWidth="270">
                                    <ListView.ItemTemplate>
                                        <DataTemplate>
                                            <Label Content="{Binding}" Foreground="{Binding Content, Converter={StaticResource TextColorNumberToBrushConverter}, RelativeSource={RelativeSource Self}}" 
											Background="{Binding Content,Converter={StaticResource NameToImageConverter}, IsAsync=True, NotifyOnTargetUpdated=True, NotifyOnSourceUpdated=True, NotifyOnValidationError=True, RelativeSource={RelativeSource Self}, ValidatesOnNotifyDataErrors=False}" BorderBrush="Black" BorderThickness="1" MinWidth="25"></Label>
                                        </DataTemplate>
                                    </ListView.ItemTemplate>
                                    <ListView.ItemsPanel>
                                        <ItemsPanelTemplate>
                                            <StackPanel Orientation="Horizontal"></StackPanel>
                                        </ItemsPanelTemplate>
                                    </ListView.ItemsPanel>
                                </ListView>
                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>
                    </DataGridTemplateColumn>

                    <!-- Preference2 -->
                    <DataGridTextColumn Header="Преференция 2" Width="auto" Binding="{Binding Preference2}" ClipboardContentBinding="{x:Null}"
                                                 Visibility="{Binding Path=IsChecked, Source={x:Reference BioColorIIHide}, Converter={StaticResource BooleanToNOTVisibilityConverter}}">
                        <DataGridTextColumn.ElementStyle>
                            <Style TargetType="{x:Type TextBlock}">
                                <Setter Property="Background" Value="{Binding Preference2, Converter={StaticResource PreferenceToBrushConverter}}" />
                                <Setter Property="TextAlignment" Value="Center"></Setter>
                            </Style>
                        </DataGridTextColumn.ElementStyle>
                    </DataGridTextColumn>
                    <!-- BioColor II END -->

                    <DataGridTemplateColumn ClipboardContentBinding="{x:Null}"/>
                    <DataGridTextColumn 
                        ClipboardContentBinding="{x:Null}"
                        Header="Физическое"
                        Binding="{Binding UserId, Converter={StaticResource DateToSin}, ConverterParameter=23}">
                        <DataGridTextColumn.ElementStyle>
                            <Style>
                                <Setter Property="TextBlock.HorizontalAlignment" Value="Center" />
                                <Setter Property="TextBlock.VerticalAlignment" Value="Center" />
                                <Setter Property="TextBlock.FontSize" Value="20" />
                            </Style>
                        </DataGridTextColumn.ElementStyle>
                    </DataGridTextColumn>
                    <DataGridTextColumn 
                        ClipboardContentBinding="{x:Null}"
                        Header="Эмоциональное"
                        Binding="{Binding UserId, Converter={StaticResource DateToSin}, ConverterParameter=28}">
                        <DataGridTextColumn.ElementStyle>
                            <Style>
                                <Setter Property="TextBlock.HorizontalAlignment" Value="Center" />
                                <Setter Property="TextBlock.VerticalAlignment" Value="Center" />
                                <Setter Property="TextBlock.FontSize" Value="20" />
                            </Style>
                        </DataGridTextColumn.ElementStyle>
                    </DataGridTextColumn>
                    <DataGridTextColumn 
                        ClipboardContentBinding="{x:Null}"
                        Header="Интелектуальное"
                        Binding="{Binding UserId, Converter={StaticResource DateToSin}, ConverterParameter=33}">
                        <DataGridTextColumn.ElementStyle>
                            <Style>
                                <Setter Property="TextBlock.HorizontalAlignment" Value="Center" />
                                <Setter Property="TextBlock.VerticalAlignment" Value="Center" />
                                <Setter Property="TextBlock.FontSize" Value="20" />
                            </Style>
                        </DataGridTextColumn.ElementStyle>
                    </DataGridTextColumn>
                    <DataGridTemplateColumn ClipboardContentBinding="{x:Null}"/>
                    <DataGridTextColumn Header="Преф 1 и Преф 2" Width="auto" Binding="{Binding Compare, Converter={StaticResource BooleanToChecker}}" ClipboardContentBinding="{x:Null}">
                        <DataGridTextColumn.ElementStyle>
                            <Style>
                                <Setter Property="TextBlock.HorizontalAlignment" Value="Center" />
                                <Setter Property="TextBlock.VerticalAlignment" Value="Center" />
                                <Setter Property="TextBlock.FontSize" Value="20" />

                            </Style>
                        </DataGridTextColumn.ElementStyle>
                    </DataGridTextColumn>
                    <DataGridTemplateColumn ClipboardContentBinding="{x:Null}"/>
                    <DataGridTemplateColumn ClipboardContentBinding="{x:Null}" Header="Релакс 1" Width="60">
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>
                                <Image Source="{Binding RelaxTable1, Converter={StaticResource NumberToRelax1Converter}}"/>
                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>
                    </DataGridTemplateColumn>
                    <DataGridTemplateColumn ClipboardContentBinding="{x:Null}" Header="Релакс 2" Width="60">
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>
                                <Image Source="{Binding RelaxTable2, Converter={StaticResource NumberToRelax2Converter}}"/>
                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>
                    </DataGridTemplateColumn>

                    <DataGridTemplateColumn ClipboardContentBinding="{x:Null}"/>
                    <!-- Preference1 -->
                    <DataGridTextColumn Header="Преференция 1" Width="auto" Binding="{Binding Preference1}" ClipboardContentBinding="{x:Null}"
                                        Visibility="{Binding Path=IsChecked, Source={x:Reference BioColorIHide}, Converter={StaticResource BooleanToNOTVisibilityConverter}}">
                        <DataGridTextColumn.ElementStyle>
                            <Style TargetType="{x:Type TextBlock}">
                                <Setter Property="Background" Value="{Binding Preference1, Converter={StaticResource PreferenceToBrushConverter}}" />
                                <Setter Property="TextAlignment" Value="Center"></Setter>
                            </Style>
                        </DataGridTextColumn.ElementStyle>
                    </DataGridTextColumn>

                    <!-- Preference2 -->
                    <DataGridTextColumn Header="Преференция 2" Width="auto" Binding="{Binding Preference2}" ClipboardContentBinding="{x:Null}"
                                        Visibility="{Binding Path=IsChecked, Source={x:Reference BioColorIIHide}, Converter={StaticResource BooleanToNOTVisibilityConverter}}">
                        <DataGridTextColumn.ElementStyle>
                            <Style TargetType="{x:Type TextBlock}">
                                <Setter Property="Background" Value="{Binding Preference2, Converter={StaticResource PreferenceToBrushConverter}}" />
                                <Setter Property="TextAlignment" Value="Center"></Setter>
                            </Style>
                        </DataGridTextColumn.ElementStyle>
                    </DataGridTextColumn>

                    <!-- Compare Pref1 + Relax1-->
                    <DataGridTemplateColumn ClipboardContentBinding="{x:Null}"/>
                    <DataGridTextColumn Header="Преф 1 Релакс2" Width="auto" ClipboardContentBinding="{x:Null}">
                        <DataGridTextColumn.ElementStyle>
                            <Style>
                                <Setter Property="TextBlock.HorizontalAlignment" Value="Center" />
                                <Setter Property="TextBlock.VerticalAlignment" Value="Center" />
                                <Setter Property="TextBlock.FontSize" Value="20"/>
                                <Setter Property="TextBlock.Text">
                                    <Setter.Value>
                                        <MultiBinding Converter="{StaticResource PreferenceSameAsRelax}">
                                            <Binding Path="Preference1"/>
                                            <Binding Path="RelaxTable1"/>
                                        </MultiBinding>
                                    </Setter.Value>
                                </Setter>
                            </Style>
                        </DataGridTextColumn.ElementStyle>
                    </DataGridTextColumn>
                    <!-- Compare Pref2 + Relax2-->
                    <DataGridTextColumn Header="Преф 2 Релакс 2" Width="auto" ClipboardContentBinding="{x:Null}">
                        <DataGridTextColumn.ElementStyle>
                            <Style>
                                <Setter Property="TextBlock.HorizontalAlignment" Value="Center" />
                                <Setter Property="TextBlock.VerticalAlignment" Value="Center" />
                                <Setter Property="TextBlock.FontSize" Value="20"/>
                                <Setter Property="TextBlock.Text">
                                    <Setter.Value>
                                        <MultiBinding Converter="{StaticResource PreferenceSameAsRelax}">
                                            <Binding Path="Preference2"/>
                                            <Binding Path="RelaxTable2"/>
                                        </MultiBinding>
                                    </Setter.Value>
                                </Setter>
                            </Style>
                        </DataGridTextColumn.ElementStyle>
                    </DataGridTextColumn>

                    <DataGridTemplateColumn ClipboardContentBinding="{x:Null}">
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>
                                <Button x:Name="EditPreferenceBtn" Content="&#xE70F;" FontFamily="Segoe MDL2 Assets" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Width="Auto" BorderBrush="White" Background="White" Foreground="Black" FontSize="14" Click="BindPreferenceInForm" Tag="{Binding Id}"/>
                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>
                    </DataGridTemplateColumn>
                    <DataGridTemplateColumn ClipboardContentBinding="{x:Null}">
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>
                                <Button x:Name="RemovePreferenceBtn" Content="&#xE107;" FontFamily="Segoe MDL2 Assets" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Width="Auto" BorderBrush="White" Background="White" Foreground="Red" FontSize="14" Click="RemovePreference"/>
                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>
                    </DataGridTemplateColumn>

                </DataGrid.Columns>
            </DataGrid>

            <DataGrid x:Name="SubjectiveFeelingDataGrid" IsReadOnly="True" CanUserAddRows="False" ItemsSource="{Binding Source={StaticResource GetFeelings}}" IsSynchronizedWithCurrentItem="True" AutoGenerateColumns="False" Margin="0,-35,0,-31" Visibility="{Binding IsSelected, Converter={StaticResource BooleanToVisibilityConverter}, ElementName=tabItem2}">
                <DataGrid.Columns>
                    <DataGridTextColumn Binding="{Binding Id}" Visibility="Hidden" />
                    <DataGridTextColumn Header="Код" Binding="{Binding UserId}" ClipboardContentBinding="{x:Null}"/>
                    <DataGridTextColumn Header="Дата" Binding="{Binding Date, StringFormat=\{0:d\}}" ClipboardContentBinding="{x:Null}"/>
                    <DataGridCheckBoxColumn Width="auto" Header="Общая слабость" Binding="{Binding GeneralWeaknes}" ClipboardContentBinding="{x:Null}"/>
                    <DataGridCheckBoxColumn Width="auto" Header="Плохой апетит" Binding="{Binding PoorAppetite}" ClipboardContentBinding="{x:Null}"/>
                    <DataGridCheckBoxColumn Width="auto" Header="Плохой сон" Binding="{Binding PoorSleep}" ClipboardContentBinding="{x:Null}"/>
                    <DataGridCheckBoxColumn Width="auto" Header="Плохое настроение" Binding="{Binding BadMood}" ClipboardContentBinding="{x:Null}"/>
                    <DataGridCheckBoxColumn Width="auto" Header="Тяжесть в голове" Binding="{Binding HeavyHead}" ClipboardContentBinding="{x:Null}"/>
                    <DataGridCheckBoxColumn Width="auto" Header="Замедленное мышление" Binding="{Binding SlowThink}" ClipboardContentBinding="{x:Null}"/>
                    <DataGridTemplateColumn ClipboardContentBinding="{x:Null}">
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>
                                <Button x:Name="EditFeelingsBtn" Content="&#xE70F;" FontFamily="Segoe MDL2 Assets" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Width="Auto" BorderBrush="White" Background="White" Foreground="Black" FontSize="14" Click="EditFeelingsBtn_Click" Tag="{Binding Id}"/>
                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>
                    </DataGridTemplateColumn>
                    <DataGridTemplateColumn ClipboardContentBinding="{x:Null}">
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>
                                <Button x:Name="RemoveFeelingsBtn" Content="&#xE107;" FontFamily="Segoe MDL2 Assets" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Width="Auto" BorderBrush="White" Background="White" Foreground="Red" FontSize="14" Click="RemoveFeelingsBtn_Click"/>
                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>
                    </DataGridTemplateColumn>
                </DataGrid.Columns>
            </DataGrid>

            <Grid x:Name="BioColorGraph" Background="White" Visibility="{Binding IsSelected, Converter={StaticResource BooleanToVisibilityConverter}, ElementName=tabItem3}" Margin="0,-35,0,-31" Grid.ColumnSpan="2" Panel.ZIndex="1">
                <Grid.RowDefinitions>
                    <RowDefinition/>
                </Grid.RowDefinitions>
            </Grid>

            <Grid x:Name="ColorSettings" Background="White" Visibility="{Binding IsSelected, Converter={StaticResource BooleanToVisibilityConverter}, ElementName=ColorSettingsTab}" Margin="2,-51,-2,-31" Grid.ColumnSpan="2" Panel.ZIndex="2">

                <Image Width="200" Height="200" Margin="25,50,0,0" HorizontalAlignment="Left" VerticalAlignment="Top">
                    <Image.Source>
                        <DrawingImage>
                            <DrawingImage.Drawing>
                                <DrawingGroup>
                                    <GeometryDrawing x:Name="pcb4" Brush="#F603EB">
                                        <GeometryDrawing.Pen>
                                            <Pen Brush="Black"/>
                                        </GeometryDrawing.Pen>
                                        <GeometryDrawing.Geometry>
                                            <PathGeometry>
                                                <PathFigure StartPoint="100,100">
                                                    <PathFigure.Segments>
                                                        <LineSegment Point="200.0,100.0"/>
                                                        <ArcSegment Point="186.6,50.0" SweepDirection="Counterclockwise" Size="100,100"/>
                                                        <LineSegment Point="100,100"/>
                                                    </PathFigure.Segments>
                                                </PathFigure>
                                            </PathGeometry>
                                        </GeometryDrawing.Geometry>
                                    </GeometryDrawing>

                                    <GeometryDrawing x:Name="pcb3" Brush="#FA0006">
                                        <GeometryDrawing.Pen>
                                            <Pen Brush="Black"/>
                                        </GeometryDrawing.Pen>
                                        <GeometryDrawing.Geometry>
                                            <PathGeometry>
                                                <PathFigure StartPoint="100,100">
                                                    <PathFigure.Segments>
                                                        <LineSegment Point="186.6,50.0"/>
                                                        <ArcSegment Point="150.0,13.4" SweepDirection="Counterclockwise" Size="100,100"/>
                                                        <LineSegment Point="100,100"/>
                                                    </PathFigure.Segments>
                                                </PathFigure>
                                            </PathGeometry>
                                        </GeometryDrawing.Geometry>
                                    </GeometryDrawing>

                                    <GeometryDrawing x:Name="pcb2" Brush="#FE280C">
                                        <GeometryDrawing.Pen>
                                            <Pen Brush="Black"/>
                                        </GeometryDrawing.Pen>
                                        <GeometryDrawing.Geometry>
                                            <PathGeometry>
                                                <PathFigure StartPoint="100,100">
                                                    <PathFigure.Segments>
                                                        <LineSegment Point="150.0,13.4"/>
                                                        <ArcSegment Point="100.0,0.0" SweepDirection="Counterclockwise" Size="100,100"/>
                                                        <LineSegment Point="100,100"/>
                                                    </PathFigure.Segments>
                                                </PathFigure>
                                            </PathGeometry>
                                        </GeometryDrawing.Geometry>
                                    </GeometryDrawing>

                                    <GeometryDrawing x:Name="pcb1" Brush="#F96F0A">
                                        <GeometryDrawing.Pen>
                                            <Pen Brush="Black"/>
                                        </GeometryDrawing.Pen>
                                        <GeometryDrawing.Geometry>
                                            <PathGeometry>
                                                <PathFigure StartPoint="100,100">
                                                    <PathFigure.Segments>
                                                        <LineSegment Point="100.0,0.0"/>
                                                        <ArcSegment Point="50.0,13.4" SweepDirection="Counterclockwise" Size="100,100"/>
                                                        <LineSegment Point="100,100"/>
                                                    </PathFigure.Segments>
                                                </PathFigure>
                                            </PathGeometry>
                                        </GeometryDrawing.Geometry>
                                    </GeometryDrawing>

                                    <GeometryDrawing x:Name="ecb4" Brush="#FBBC0C">
                                        <GeometryDrawing.Pen>
                                            <Pen Brush="Black"/>
                                        </GeometryDrawing.Pen>
                                        <GeometryDrawing.Geometry>
                                            <PathGeometry>
                                                <PathFigure StartPoint="100,100">
                                                    <PathFigure.Segments>
                                                        <LineSegment Point="50.0,13.4"/>
                                                        <ArcSegment Point="13.4,50.0" SweepDirection="Counterclockwise" Size="100,100"/>
                                                        <LineSegment Point="100,100"/>
                                                    </PathFigure.Segments>
                                                </PathFigure>
                                            </PathGeometry>
                                        </GeometryDrawing.Geometry>
                                    </GeometryDrawing>

                                    <GeometryDrawing x:Name="ecb3" Brush="#F4FE09">
                                        <GeometryDrawing.Pen>
                                            <Pen Brush="Black"/>
                                        </GeometryDrawing.Pen>
                                        <GeometryDrawing.Geometry>
                                            <PathGeometry>
                                                <PathFigure StartPoint="100,100">
                                                    <PathFigure.Segments>
                                                        <LineSegment Point="13.4,50.0"/>
                                                        <ArcSegment Point="0.0,100.0" SweepDirection="Counterclockwise" Size="100,100"/>
                                                        <LineSegment Point="100,100"/>
                                                    </PathFigure.Segments>
                                                </PathFigure>
                                            </PathGeometry>
                                        </GeometryDrawing.Geometry>
                                    </GeometryDrawing>

                                    <GeometryDrawing x:Name="ecb2" Brush="#7EFE07">
                                        <GeometryDrawing.Pen>
                                            <Pen Brush="Black"/>
                                        </GeometryDrawing.Pen>
                                        <GeometryDrawing.Geometry>
                                            <PathGeometry>
                                                <PathFigure StartPoint="100,100">
                                                    <PathFigure.Segments>
                                                        <LineSegment Point="0.0,100.0"/>
                                                        <ArcSegment Point="13.4,150.0" SweepDirection="Counterclockwise" Size="100,100"/>
                                                        <LineSegment Point="100,100"/>
                                                    </PathFigure.Segments>
                                                </PathFigure>
                                            </PathGeometry>
                                        </GeometryDrawing.Geometry>
                                    </GeometryDrawing>

                                    <GeometryDrawing x:Name="ecb1" Brush="#31F715">
                                        <GeometryDrawing.Pen>
                                            <Pen Brush="Black"/>
                                        </GeometryDrawing.Pen>
                                        <GeometryDrawing.Geometry>
                                            <PathGeometry>
                                                <PathFigure StartPoint="100,100">
                                                    <PathFigure.Segments>
                                                        <LineSegment Point="13.4,150.0"/>
                                                        <ArcSegment Point="50.0,186.6" SweepDirection="Counterclockwise" Size="100,100"/>
                                                        <LineSegment Point="100,100"/>
                                                    </PathFigure.Segments>
                                                </PathFigure>
                                            </PathGeometry>
                                        </GeometryDrawing.Geometry>
                                    </GeometryDrawing>

                                    <GeometryDrawing x:Name="icb4" Brush="#3DDEFB">
                                        <GeometryDrawing.Pen>
                                            <Pen Brush="Black"/>
                                        </GeometryDrawing.Pen>
                                        <GeometryDrawing.Geometry>
                                            <PathGeometry>
                                                <PathFigure StartPoint="100,100">
                                                    <PathFigure.Segments>
                                                        <LineSegment Point="50.0,186.6"/>
                                                        <ArcSegment Point="100.0,200.0" SweepDirection="Counterclockwise" Size="100,100"/>
                                                        <LineSegment Point="100,100"/>
                                                    </PathFigure.Segments>
                                                </PathFigure>
                                            </PathGeometry>
                                        </GeometryDrawing.Geometry>
                                    </GeometryDrawing>

                                    <GeometryDrawing x:Name="icb3" Brush="#1855F7">
                                        <GeometryDrawing.Pen>
                                            <Pen Brush="Black"/>
                                        </GeometryDrawing.Pen>
                                        <GeometryDrawing.Geometry>
                                            <PathGeometry>
                                                <PathFigure StartPoint="100,100">
                                                    <PathFigure.Segments>
                                                        <LineSegment Point="100.0,200.0"/>
                                                        <ArcSegment Point="150.0,186.6" SweepDirection="Counterclockwise" Size="100,100"/>
                                                        <LineSegment Point="100,100"/>
                                                    </PathFigure.Segments>
                                                </PathFigure>
                                            </PathGeometry>
                                        </GeometryDrawing.Geometry>
                                    </GeometryDrawing>

                                    <GeometryDrawing x:Name="icb2" Brush="#0F2BEB">
                                        <GeometryDrawing.Pen>
                                            <Pen Brush="Black"/>
                                        </GeometryDrawing.Pen>
                                        <GeometryDrawing.Geometry>
                                            <PathGeometry>
                                                <PathFigure StartPoint="100,100">
                                                    <PathFigure.Segments>
                                                        <LineSegment Point="150.0,186.6"/>
                                                        <ArcSegment Point="186.6,150.0" SweepDirection="Counterclockwise" Size="100,100"/>
                                                        <LineSegment Point="100,100"/>
                                                    </PathFigure.Segments>
                                                </PathFigure>
                                            </PathGeometry>
                                        </GeometryDrawing.Geometry>
                                    </GeometryDrawing>

                                    <GeometryDrawing x:Name="icb1" Brush="#2317F5">
                                        <GeometryDrawing.Pen>
                                            <Pen Brush="Black"/>
                                        </GeometryDrawing.Pen>
                                        <GeometryDrawing.Geometry>
                                            <PathGeometry>
                                                <PathFigure StartPoint="100,100">
                                                    <PathFigure.Segments>
                                                        <LineSegment Point="186.6,150.0"/>
                                                        <ArcSegment Point="200.0,100.0" SweepDirection="Counterclockwise" Size="100,100"/>
                                                        <LineSegment Point="100,100"/>
                                                    </PathFigure.Segments>
                                                </PathFigure>
                                            </PathGeometry>
                                        </GeometryDrawing.Geometry>
                                    </GeometryDrawing>

                                </DrawingGroup>
                            </DrawingImage.Drawing>
                        </DrawingImage>
                    </Image.Source>
                </Image>


                <TextBlock Width="100" Height="25" Name="pt1" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="250,  0,0,0"  Text="Физическое: [1]"/>
                <TextBlock Width="100" Height="25" Name="pt2" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="250, 25,0,0"  Text="Физическое: [2]"/>
                <TextBlock Width="100" Height="25" Name="pt3" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="250, 50,0,0"  Text="Физическое: [3]"/>
                <TextBlock Width="100" Height="25" Name="pt4" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="250, 75,0,0"  Text="Физическое: [4]"/>

                <TextBlock Width="118" Height="25" Name="et1" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="250,100,0,0"  Text="Эмоциональное: [1]"/>
                <TextBlock Width="118" Height="25" Name="et2" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="250,125,0,0"  Text="Эмоциональное: [2]"/>
                <TextBlock Width="118" Height="25" Name="et3" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="250,150,0,0"  Text="Эмоциональное: [3]"/>
                <TextBlock Width="118" Height="25" Name="et4" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="250,175,0,0"  Text="Эмоциональное: [4]"/>

                <TextBlock Width="118" Height="25" Name="it1" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="250,200,0,0"  Text="Интелекнуальное: [1]"/>
                <TextBlock Width="118" Height="25" Name="it2" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="250,225,0,0"  Text="Интелекнуальное: [2]"/>
                <TextBlock Width="118" Height="25" Name="it3" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="250,250,0,0"  Text="Интелекнуальное: [3]"/>
                <TextBlock Width="118" Height="25" Name="it4" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="250,275,0,0"  Text="Интелекнуальное: [4]"/>



                <TextBox IsReadOnly="True" Width="160" Height="25" Name="pc1" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="382,0,0,0" />
                <TextBox Width="50" Height="25" Name="cpc1" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="607,0,0,0" />
                <TextBox Width="50" Height="25" Name="mpc1" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="657,0,0,0" />
                <TextBox Width="50" Height="25" Name="ypc1" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="707,0,0,0" />
                <TextBox Width="50" Height="25" Name="kpc1" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="757,0,0,0" />
                <TextBox IsReadOnly="True" Width="160" Height="25" Name="pc2" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="382,25,0,0" />
                <TextBox Width="50" Height="25" Name="cpc2" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="607,25,0,0" />
                <TextBox Width="50" Height="25" Name="mpc2" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="657,25,0,0" />
                <TextBox Width="50" Height="25" Name="ypc2" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="707,25,0,0" />
                <TextBox Width="50" Height="25" Name="kpc2" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="757,25,0,0" />
                <TextBox IsReadOnly="True" Width="160" Height="25" Name="pc3" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="382,50,0,0" />
                <TextBox Width="50" Height="25" Name="cpc3" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="607,50,0,0" />
                <TextBox Width="50" Height="25" Name="mpc3" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="657,50,0,0" />
                <TextBox Width="50" Height="25" Name="ypc3" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="707,50,0,0" />
                <TextBox Width="50" Height="25" Name="kpc3" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="757,50,0,0" />
                <TextBox IsReadOnly="True" Width="160" Height="25" Name="pc4" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="382,75,0,0" />
                <TextBox Width="50" Height="25" Name="cpc4" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="607,75,0,0" />
                <TextBox Width="50" Height="25" Name="mpc4" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="657,75,0,0" />
                <TextBox Width="50" Height="25" Name="ypc4" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="707,75,0,0" />
                <TextBox Width="50" Height="25" Name="kpc4" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="757,75,0,0" />
                <TextBox IsReadOnly="True" Width="160" Height="25" Name="ec1" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="382,100,0,0" />
                <TextBox Width="50" Height="25" Name="cec1" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="607,100,0,0" />
                <TextBox Width="50" Height="25" Name="mec1" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="657,100,0,0" />
                <TextBox Width="50" Height="25" Name="yec1" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="707,100,0,0" />
                <TextBox Width="50" Height="25" Name="kec1" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="757,100,0,0" />
                <TextBox IsReadOnly="True" Width="160" Height="25" Name="ec2" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="382,125,0,0" />
                <TextBox Width="50" Height="25" Name="cec2" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="607,125,0,0" />
                <TextBox Width="50" Height="25" Name="mec2" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="657,125,0,0" />
                <TextBox Width="50" Height="25" Name="yec2" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="707,125,0,0" />
                <TextBox Width="50" Height="25" Name="kec2" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="757,125,0,0" />
                <TextBox IsReadOnly="True" Width="160" Height="25" Name="ec3" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="382,150,0,0" />
                <TextBox Width="50" Height="25" Name="cec3" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="607,150,0,0" />
                <TextBox Width="50" Height="25" Name="mec3" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="657,150,0,0" />
                <TextBox Width="50" Height="25" Name="yec3" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="707,150,0,0" />
                <TextBox Width="50" Height="25" Name="kec3" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="757,150,0,0" />
                <TextBox IsReadOnly="True" Width="160" Height="25" Name="ec4" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="382,175,0,0" />
                <TextBox Width="50" Height="25" Name="cec4" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="607,175,0,0" />
                <TextBox Width="50" Height="25" Name="mec4" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="657,175,0,0" />
                <TextBox Width="50" Height="25" Name="yec4" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="707,175,0,0" RenderTransformOrigin="0.98,0.48" />
                <TextBox Width="50" Height="25" Name="kec4" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="757,175,0,0" />
                <TextBox IsReadOnly="True" Width="160" Height="25" Name="ic1" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="382,200,0,0" />
                <TextBox Width="50" Height="25" Name="cic1" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="607,200,0,0" />
                <TextBox Width="50" Height="25" Name="mic1" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="657,200,0,0" />
                <TextBox Width="50" Height="25" Name="yic1" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="707,200,0,0" />
                <TextBox Width="50" Height="25" Name="kic1" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="757,200,0,0" />
                <TextBox IsReadOnly="True" Width="160" Height="25" Name="ic2" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="382,225,0,0" />
                <TextBox Width="50" Height="25" Name="cic2" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="607,225,0,0" />
                <TextBox Width="50" Height="25" Name="mic2" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="657,225,0,0" />
                <TextBox Width="50" Height="25" Name="yic2" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="707,225,0,0" />
                <TextBox Width="50" Height="25" Name="kic2" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="757,225,0,0" />
                <TextBox IsReadOnly="True" Width="160" Height="25" Name="ic3" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="382,250,0,0" />
                <TextBox Width="50" Height="25" Name="cic3" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="607,250,0,0" />
                <TextBox Width="50" Height="25" Name="mic3" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="657,250,0,0" />
                <TextBox Width="50" Height="25" Name="yic3" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="707,250,0,0" />
                <TextBox Width="50" Height="25" Name="kic3" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="757,250,0,0" />
                <TextBox IsReadOnly="True" Width="160" Height="25" Name="ic4" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="382,275,0,0" />
                <TextBox Width="50" Height="25" Name="cic4" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="607,275,0,0" />
                <TextBox Width="50" Height="25" Name="mic4" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="657,275,0,0" />
                <TextBox Width="50" Height="25" Name="yic4" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="707,275,0,0" />
                <TextBox Width="50" Height="25" Name="kic4" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="757,275,0,0" />

                <Button Width="65"  Height="25" Name="pb1" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="542,0,0,0" Click="CMYK2RGB">&lt;--</Button>
                <Button Width="65"  Height="25" Name="pb2" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="542,25,0,0" Click="CMYK2RGB">&lt;--</Button>
                <Button Width="65"  Height="25" Name="pb3" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="542,50,0,0" Click="CMYK2RGB">&lt;--</Button>
                <Button Width="65"  Height="25" Name="pb4" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="542,75,0,0" Click="CMYK2RGB">&lt;--</Button>

                <Button    Width="65"  Height="25" Name="eb1" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="542,100,0,0" Click="CMYK2RGB">&lt;--</Button>
                <Button    Width="65"  Height="25" Name="eb2" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="542,125,0,0" Click="CMYK2RGB">&lt;--</Button>
                <Button    Width="65"  Height="25" Name="eb3" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="542,150,0,0" Click="CMYK2RGB">&lt;--</Button>
                <Button    Width="65"  Height="25" Name="eb4" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="542,175,0,0" Click="CMYK2RGB">&lt;--</Button>

                <Button    Width="65"  Height="25" Name="ib1" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="542,200,0,0" Click="CMYK2RGB">&lt;--</Button>
                <Button    Width="65"  Height="25" Name="ib2" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="542,225,0,0" Click="CMYK2RGB">&lt;--</Button>
                <Button    Width="65"  Height="25" Name="ib3" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="542,250,0,0" Click="CMYK2RGB">&lt;--</Button>
                <Button    Width="65"  Height="25" Name="ib4" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="542,275,0,0" Click="CMYK2RGB">&lt;--</Button>


                <Button Width="89"  Height="25" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="496,326,0,0" Click="ResetColors" Content="Сброс"/>
                <Button Width="89"  Height="25" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="606,326,0,0" Click="RestoreColors" Content="Восстановить" RenderTransformOrigin="0.494,0.64"/>
                <Button Width="89"  Height="25" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="717,326,0,0" Click="SaveColors" Content="Сохранить"/>

            </Grid>
            <Grid Grid.Column="1" ScrollViewer.VerticalScrollBarVisibility="Auto" x:Name="Filter">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition/>
                </Grid.RowDefinitions>

                <Label Content="Фильтры" FontSize="15" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Background="LightGray" Margin="0,-35,0,12"/>

                <Grid Grid.Row="1" Margin="5">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition />
                    </Grid.ColumnDefinitions>
                    <Label Content="Код" 
                        FontWeight="Bold" Margin="0,0,5,0" HorizontalContentAlignment="Center" VerticalContentAlignment="Center"/>
                    <ComboBox
                        x:Name="UserIdsFilterPeopleTab"
                        Grid.Column="1"
                        ItemsSource="{Binding Source={StaticResource GetCodesForFilter}}"
                        SelectedIndex="0" Margin="5"
                        Visibility="{Binding IsSelected, Converter={StaticResource BooleanToVisibilityConverter}, ElementName=tabItem}"
                        />
                    <ComboBox
                        x:Name="UserIdsFilterPreferenceTab"
                        Grid.Column="1"
                        ItemsSource="{Binding Source={StaticResource GetCodesForFilter}}"
                        SelectedIndex="0" Margin="5"
                        Visibility="{Binding IsSelected, Converter={StaticResource BooleanToVisibilityConverter}, ElementName=tabItem1}"
                        />
                    <ComboBox
                        x:Name="UserIdsFilterSubjFeelTab"
                        Grid.Column="1"
                        ItemsSource="{Binding Source={StaticResource GetCodesForFilter}}"
                        SelectedIndex="0" Margin="5"
                        Visibility="{Binding IsSelected, Converter={StaticResource BooleanToVisibilityConverter}, ElementName=tabItem2}"/>
                </Grid>
                <Grid Grid.Row="2" Margin="5">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition />
                        <ColumnDefinition />
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="auto" />
                        <RowDefinition Height="auto" />
                        <RowDefinition Height="auto" />
                        <RowDefinition Height="auto" />
                    </Grid.RowDefinitions>

                    <Label Content="Дата" FontWeight="Bold" Grid.ColumnSpan="2" Margin="0,-6,0,6" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Padding="5,0"/>
                    <Label Content="Начало" Margin="0,4,0,12" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Padding="0" Grid.RowSpan="2"/>
                    <Label Content="Конец" Margin="0,4,0,12" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Grid.Column="1" Padding="0" Grid.RowSpan="2"/>

                    <DatePicker Grid.Row="1"
                                x:Name="DateFromPeopleTab"
                                SelectedDate="{Binding FilterSelectedDateFrom}"  Margin="0,5,5,7" Padding="5,2,2,2" Grid.RowSpan="2" 
                                Visibility="{Binding IsSelected, Converter={StaticResource BooleanToVisibilityConverter}, ElementName=tabItem}"/>
                    <DatePicker Grid.Row="1"
                                x:Name="DateToPeopleTab"
                                Grid.Column="1"
                                SelectedDate="{Binding FilterSelectedDateTo}" Margin="5,0,0,7" VerticalAlignment="Bottom" Padding="2" Grid.RowSpan="2"
                                Visibility="{Binding IsSelected, Converter={StaticResource BooleanToVisibilityConverter}, ElementName=tabItem}"/>
                    <DatePicker Grid.Row="1"
                                x:Name="DateFromPreferenceTab"
                                SelectedDate="{Binding FilterSelectedDateFrom}"  Margin="0,5,5,7" Padding="5,2,2,2" Grid.RowSpan="2" 
                                Visibility="{Binding IsSelected, Converter={StaticResource BooleanToVisibilityConverter}, ElementName=tabItem1}"/>
                    <DatePicker Grid.Row="1"
                                x:Name="DateToPreferenceTab"
                                Grid.Column="1"
                                SelectedDate="{Binding FilterSelectedDateTo}" Margin="5,0,0,7" VerticalAlignment="Bottom" Padding="2" Grid.RowSpan="2" 
                                Visibility="{Binding IsSelected, Converter={StaticResource BooleanToVisibilityConverter}, ElementName=tabItem1}"/>
                    <DatePicker Grid.Row="1"
                                x:Name="DateFromSubjFeelTab"
                                SelectedDate="{Binding FilterSelectedDateFrom}"  Margin="0,5,5,7" Padding="5,2,2,2" Grid.RowSpan="2" 
                                Visibility="{Binding IsSelected, Converter={StaticResource BooleanToVisibilityConverter}, ElementName=tabItem2}"/>
                    <DatePicker Grid.Row="1"
                                x:Name="DateToSubjFeelTab"
                                Grid.Column="1"
                                SelectedDate="{Binding FilterSelectedDateTo}" Margin="5,0,0,7" VerticalAlignment="Bottom" Padding="2" Grid.RowSpan="2" 
                                Visibility="{Binding IsSelected, Converter={StaticResource BooleanToVisibilityConverter}, ElementName=tabItem2}"/>
                    <Grid Grid.ColumnSpan="2" Margin="0" Grid.Row="3" VerticalAlignment="Center" HorizontalAlignment="Center">
                    </Grid>
                </Grid>
                <Grid Visibility="{Binding FilterExpeditionAndNumberVisibility}" Grid.Row="3" Margin="5,0,5,10">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition />
                        <ColumnDefinition />
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition/>
                        <RowDefinition/>
                        <RowDefinition Height="auto" />
                        <RowDefinition Height="auto" />
                        <RowDefinition Height="auto" />
                    </Grid.RowDefinitions>
                    <TextBlock
                                   HorizontalAlignment="Center"
                                   Padding="0"
                                   Text="Экспедиция" Grid.ColumnSpan="2"
                                   FontWeight="Bold" Margin="84,-10,84,10"
                        />
                    <Label Content="Начало" Margin="0,0,0,16" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Padding="0" Grid.RowSpan="2"/>
                    <Label Content="Конец" Margin="0,0,0,16" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Padding="0" Grid.Column="1" Grid.RowSpan="2"/>
                    <ComboBox Grid.Row="1"
                              x:Name="ExpeditionFromPeopleTab"
                                  ItemsSource="{Binding Source={StaticResource GetExpeditionCodes}}"
                                  SelectedIndex="0"
                              HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Margin="0,6,2,0" 
                              Visibility="{Binding IsSelected, Converter={StaticResource BooleanToVisibilityConverter}, ElementName=tabItem}"/>
                    <ComboBox Grid.Row="1"
                              x:Name="ExpeditionToPeopleTab"
                                  Grid.Column="1"
                                  ItemsSource="{Binding Source={StaticResource GetExpeditionCodes}}"
                                  SelectedIndex="0" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Margin="2,6,0,0" 
                              Visibility="{Binding IsSelected, Converter={StaticResource BooleanToVisibilityConverter}, ElementName=tabItem}"/>
                    <ComboBox Grid.Row="1"
                              x:Name="ExpeditionFromPreferenceTab"
                                  ItemsSource="{Binding Source={StaticResource GetExpeditionCodes}}"
                                  SelectedIndex="0"
                              HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Margin="0,6,2,0"
                              Visibility="{Binding IsSelected, Converter={StaticResource BooleanToVisibilityConverter}, ElementName=tabItem1}"/>
                    <ComboBox Grid.Row="1"
                              x:Name="ExpeditionToPreferenceTab"
                                  Grid.Column="1"
                                  ItemsSource="{Binding Source={StaticResource GetExpeditionCodes}}"
                                  SelectedIndex="0" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Margin="2,6,0,0"
                                  Visibility="{Binding IsSelected, Converter={StaticResource BooleanToVisibilityConverter}, ElementName=tabItem1}"/>
                    <ComboBox Grid.Row="1"
                              x:Name="ExpeditionFromSubjFeelTab"
                                  ItemsSource="{Binding Source={StaticResource GetExpeditionCodes}}"
                                 SelectedIndex="0"
                                  HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Margin="0,6,2,0" 
                                  Visibility="{Binding IsSelected, Converter={StaticResource BooleanToVisibilityConverter}, ElementName=tabItem2}"/>
                    <ComboBox Grid.Row="1"
                              x:Name="ExpeditionToSubjFeelTab"
                                  Grid.Column="1"
                                  ItemsSource="{Binding Source={StaticResource GetExpeditionCodes}}"
                                 SelectedIndex="0" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Margin="2,6,0,0" 
                              Visibility="{Binding IsSelected, Converter={StaticResource BooleanToVisibilityConverter}, ElementName=tabItem2}"/>

                    <TextBlock Grid.Row="2"
                                   HorizontalAlignment="Center"
                                   Padding="0"
                                   Text="Номер" Grid.ColumnSpan="2" 
                                    FontWeight="Bold" Margin="100,5,100,14"/>
                    <Label Content="Начало" Margin="0,19,0,48" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Padding="0" Grid.Row="2"/>
                    <Label Content="Конец" Margin="0,18,0,48" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Padding="0" Grid.Row="2" Grid.Column="1"/>
                    <ComboBox Grid.Row="2"
                              x:Name="PeopleFromPeopleTab"
                             SelectedIndex="0"
                              ItemsSource="{Binding Source={StaticResource GetPeopleCodes}}" 
                              HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Margin="0,35,2,23" 
                              Visibility="{Binding IsSelected, Converter={StaticResource BooleanToVisibilityConverter}, ElementName=tabItem}"/>
                    <ComboBox Grid.Row="2"
                              x:Name="PeopleToPeopleTab"
                                  Grid.Column="1"
                                  ItemsSource="{Binding Source={StaticResource GetPeopleCodes}}"
                                  SelectedIndex="0" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Margin="2,35,0,23" 
                              Visibility="{Binding IsSelected, Converter={StaticResource BooleanToVisibilityConverter}, ElementName=tabItem}"/>
                    <ComboBox Grid.Row="2"
                              x:Name="PeopleFromPreferenceTab"
                             SelectedIndex="0"
                              ItemsSource="{Binding Source={StaticResource GetPeopleCodes}}" 
                              HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Margin="0,35,2,23" 
                              Visibility="{Binding IsSelected, Converter={StaticResource BooleanToVisibilityConverter}, ElementName=tabItem1}"/>
                    <ComboBox Grid.Row="2"
                              x:Name="PeopleToPreferenceTab"
                                  Grid.Column="1"
                                  ItemsSource="{Binding Source={StaticResource GetPeopleCodes}}"
                                  SelectedIndex="0" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Margin="2,35,0,23" 
                              Visibility="{Binding IsSelected, Converter={StaticResource BooleanToVisibilityConverter}, ElementName=tabItem1}"/>
                    <ComboBox Grid.Row="2"
                              x:Name="PeopleFromSubjFeelTab"
                              SelectedIndex="0"
                              ItemsSource="{Binding Source={StaticResource GetPeopleCodes}}" 
                              HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Margin="0,35,2,23" 
                              Visibility="{Binding IsSelected, Converter={StaticResource BooleanToVisibilityConverter}, ElementName=tabItem2}"/>
                    <ComboBox Grid.Row="2"
                              x:Name="PeopleToSubjFeelTab"
                                  Grid.Column="1"
                                  ItemsSource="{Binding Source={StaticResource GetPeopleCodes}}"
                                 SelectedIndex="0" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Margin="2,35,0,23" 
                              Visibility="{Binding IsSelected, Converter={StaticResource BooleanToVisibilityConverter}, ElementName=tabItem2}"/>
                    <Label Content="Профессия" FontWeight="Bold" Margin="18,68,15,-11" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Padding="5,0" Grid.Row="2" Grid.RowSpan="4"
                           />
                    <ComboBox Grid.Row="2"
                        x:Name="ProfessionFilterPeopleTab"
                        ItemsSource="{Binding Source={StaticResource GetProfessionsList}}" 
                        SelectedIndex="0" HorizontalContentAlignment="Center" Margin="2,70,2,-11" Grid.RowSpan="4" Grid.Column="1" 
                              Visibility="{Binding IsSelected, Converter={StaticResource BooleanToVisibilityConverter}, ElementName=tabItem}"/>
                    <ComboBox Grid.Row="2"
                        x:Name="ProfessionFilterPreferenceTab"
                        ItemsSource="{Binding Source={StaticResource GetProfessionsList}}" 
                        SelectedIndex="0" HorizontalContentAlignment="Center" Margin="2,70,2,-11" Grid.RowSpan="4" Grid.Column="1"
                              Visibility="{Binding IsSelected, Converter={StaticResource BooleanToVisibilityConverter}, ElementName=tabItem1}"/>
                    <ComboBox Grid.Row="2"
                        x:Name="ProfessionFilterSubjFeelTab"
                        ItemsSource="{Binding Source={StaticResource GetProfessionsList}}" 
                        SelectedIndex="0" HorizontalContentAlignment="Center" Margin="2,70,2,-11" Grid.RowSpan="4" Grid.Column="1"
                              Visibility="{Binding IsSelected, Converter={StaticResource BooleanToVisibilityConverter}, ElementName=tabItem2}"/>
                </Grid>

                <Grid Visibility="{Binding IsSelected, Converter={StaticResource BooleanToVisibilityConverter}, ElementName=tabItem1}" Grid.Row="4" Margin="5" UseLayoutRounding="False">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition />
                        <ColumnDefinition />
                        <ColumnDefinition />
                    </Grid.ColumnDefinitions>

                    <Grid.RowDefinitions>
                        <RowDefinition Height="*" />
                        <RowDefinition Height="auto" />
                    </Grid.RowDefinitions>

                    <TextBlock
                                   Grid.Column="0"
                                   HorizontalAlignment="Center"
                                   Text="1" />
                    <TextBlock
                                   Grid.Column="1"
                                   HorizontalAlignment="Center"
                                   Text="2" />
                    <TextBlock
                                   Grid.Column="2"
                                   HorizontalAlignment="Center"
                                   Text="3" />
                    <TextBox Grid.Row="1"
                             x:Name="PreferenceShortFilter1"
                                 Grid.Column="0"
                                 Width="50"
                                 Height="22"
                                 Text="{Binding Path=C1in3Filter}" />
                    <TextBox Grid.Row="1"
                             x:Name="PreferenceShortFilter2"
                                 Grid.Column="1"
                                 Width="50"
                                 Text="{Binding C2in3Filter}" />
                    <TextBox Grid.Row="1"
                             x:Name="PreferenceShortFilter3"
                                 Grid.Column="2"
                                 Width="50" />
                </Grid>
                <Grid Grid.Row="5" Margin="5" Visibility="{Binding IsSelected, Converter={StaticResource BooleanToVisibilityConverter}, ElementName=tabItem1}">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="auto" />
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="auto" />
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="auto" />
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="auto" />
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="auto" />
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="auto" />
                        <ColumnDefinition Width="Auto" />
                    </Grid.ColumnDefinitions>

                    <Grid.RowDefinitions>
                        <RowDefinition Height="auto" />
                        <RowDefinition Height="auto" />
                    </Grid.RowDefinitions>

                    <TextBlock
                                       Grid.Column="0"
                                       HorizontalAlignment="Center"
                                       Padding="0"
                                       Text="1" VerticalAlignment="Center" />
                    <TextBlock
                                       Grid.Column="1"
                                       HorizontalAlignment="Center"
                                       Padding="0"
                                       Text="2" VerticalAlignment="Center" />
                    <TextBlock
                                       Grid.Column="2"
                                       HorizontalAlignment="Center"
                                       Padding="0"
                                       Text="3" VerticalAlignment="Center" />
                    <TextBlock
                                       Grid.Column="3"
                                       HorizontalAlignment="Center"
                                       Padding="0"
                                       Text="4" VerticalAlignment="Center" />
                    <TextBlock
                                       Grid.Column="4"
                                       HorizontalAlignment="Center"
                                       Padding="0"
                                       Text="5" VerticalAlignment="Center" />
                    <TextBlock
                                       Grid.Column="5"
                                       HorizontalAlignment="Center"
                                       Padding="0"
                                       Text="6" VerticalAlignment="Center" />
                    <TextBlock
                                       Grid.Column="6"
                                       HorizontalAlignment="Center"
                                       Padding="0"
                                       Text="7" VerticalAlignment="Center" />
                    <TextBlock
                                       Grid.Column="7"
                                       HorizontalAlignment="Center"
                                       Padding="0"
                                       Text="8" VerticalAlignment="Center" />
                    <TextBlock
                                       Grid.Column="8"
                                       HorizontalAlignment="Center"
                                       Padding="0"
                                       Text="9" VerticalAlignment="Center" />
                    <TextBlock
                                       Grid.Column="9"
                                       HorizontalAlignment="Center"
                                       Padding="0"
                                       Text="10" VerticalAlignment="Center" />
                    <TextBlock
                                       Grid.Column="10"
                                       HorizontalAlignment="Center"
                                       Padding="0"
                                       Text="11" VerticalAlignment="Center" />
                    <TextBlock
                                       Grid.Column="11"
                                       HorizontalAlignment="Center"
                                       Padding="0"
                                       Text="12" VerticalAlignment="Center" />



                    <TextBox Grid.Row="1"
                                    x:Name="PreferenceFilter1"
                                     Grid.Column="0"
                                     Width="25"
                                     Text="{Binding C1in12Filter}" />
                    <TextBox Grid.Row="1"
                                    x:Name="PreferenceFilter2"
                                     Grid.Column="1"
                                     Width="25"
                                     Text="{Binding C2in12Filter}" />
                    <TextBox Grid.Row="1"
                                    x:Name="PreferenceFilter3"
                                     Grid.Column="2"
                                     Width="25"
                                     Text="{Binding C3in12Filter}" />
                    <TextBox Grid.Row="1"
                                    x:Name="PreferenceFilter4"
                                     Grid.Column="3"
                                     Width="25"
                                     Text="{Binding C4in12Filter}" />
                    <TextBox Grid.Row="1"
                                    x:Name="PreferenceFilter5"
                                     Grid.Column="4"
                                     Width="25"
                                     Text="{Binding C5in12Filter}" />
                    <TextBox Grid.Row="1"
                                    x:Name="PreferenceFilter6"
                                     Grid.Column="5"
                                     Width="25"
                                     Text="{Binding C6in12Filter}" />
                    <TextBox Grid.Row="1"
                                    x:Name="PreferenceFilter7"
                                     Grid.Column="6"
                                     Width="25"
                                     Text="{Binding C7in12Filter}" />
                    <TextBox Grid.Row="1"
                                    x:Name="PreferenceFilter8"
                                     Grid.Column="7"
                                     Width="25"
                                     Text="{Binding C8in12Filter}" />
                    <TextBox Grid.Row="1"
                                    x:Name="PreferenceFilter9"
                                     Grid.Column="8"
                                     Width="25"
                                     Text="{Binding C9in12Filter}" />
                    <TextBox Grid.Row="1"
                                    x:Name="PreferenceFilter10"
                                     Grid.Column="9"
                                     Width="25"
                                     Text="{Binding C10in12Filter}" />
                    <TextBox Grid.Row="1"
                                    x:Name="PreferenceFilter11"
                                     Grid.Column="10"
                                     Width="25"
                                     Text="{Binding C11in12Filter}" />
                    <TextBox Grid.Row="1"
                                    x:Name="PreferenceFilter12"
                                     Grid.Column="11"
                                     Width="25"
                                     Text="{Binding C12in12Filter}" />
                </Grid>

                <Grid Visibility="{Binding IsSelected, Converter={StaticResource BooleanToVisibilityConverter}, ElementName=tabItem2}" Grid.Row="6" Margin="5">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition />
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="auto" />
                        <RowDefinition Height="auto" />
                        <RowDefinition Height="auto" />
                        <RowDefinition Height="auto" />
                        <RowDefinition Height="auto" />
                    </Grid.RowDefinitions>

                    <TextBlock
                                   Grid.Column="0"
                                   Padding="0"
                                   Text="Общая слабость" FontSize="11" VerticalAlignment="Center" HorizontalAlignment="Center" />
                    <TextBlock
                                   Grid.Column="1"
                                   Padding="0"
                                   Text="Плохой аппетит" FontSize="11" VerticalAlignment="Center" HorizontalAlignment="Center" />
                    <TextBlock Grid.Row="2"
                                   Grid.Column="0"
                                   Padding="0"
                                   Text="Плохой сон" FontSize="11" VerticalAlignment="Center" HorizontalAlignment="Center" />
                    <TextBlock Grid.Row="2"
                                   Grid.Column="1"
                                   Padding="0"
                                   Text="Плохое настроение" FontSize="11" VerticalAlignment="Center" HorizontalAlignment="Center" />
                    <TextBlock Grid.Row="4"
                                   Grid.Column="0"
                                   Padding="2,0,0,0"
                                   Text="Тяжесть в голове" FontSize="11" VerticalAlignment="Center" HorizontalAlignment="Center" />
                    <TextBlock Grid.Row="4"
                                   Grid.Column="1"
                                   Padding="0"
                                   Text="Замедленное мышление" FontSize="11" VerticalAlignment="Center" HorizontalAlignment="Center" />

                    <CheckBox Grid.Row="1"
                                  x:Name="generalWeakness"
                                  Grid.Column="0"
                                  HorizontalAlignment="Center"
                                  VerticalAlignment="Center"
                                  IsChecked="{Binding FilterGeneralWeakness}" />
                    <CheckBox Grid.Row="1"
                                  x:Name="poorAppetite"
                                  Grid.Column="1"
                                  HorizontalAlignment="Center"
                                  VerticalAlignment="Center"
                                  IsChecked="{Binding FilterPoorAppetite}" />
                    <CheckBox Grid.Row="3"
                              x:Name="poorSleep"
                                  Grid.Column="0"
                                  HorizontalAlignment="Center"
                                  VerticalAlignment="Center"
                                  IsChecked="{Binding FilterPoorSleep}" />
                    <CheckBox Grid.Row="3"
                              x:Name="badMood"
                                  Grid.Column="1"
                                  HorizontalAlignment="Center"
                                  VerticalAlignment="Center"
                                  IsChecked="{Binding FilterBadMood}" />
                    <CheckBox Grid.Row="5"
                              x:Name="heavyHead"
                                  Grid.Column="0"
                                  HorizontalAlignment="Center"
                                  VerticalAlignment="Center"
                                  IsChecked="{Binding FilterHeavyHead}" />
                    <CheckBox Grid.Row="5"
                              x:Name="slowThink"
                                  Grid.Column="1"
                                  HorizontalAlignment="Center"
                                  VerticalAlignment="Center"
                                  IsChecked="{Binding FilterLowThinking}" />
                </Grid>

                <Grid Visibility="{Binding IsSelected, Converter={StaticResource BooleanToVisibilityConverter}, ElementName=tabItem1}" Grid.Row="7" Margin="5">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition />
                    </Grid.ColumnDefinitions>

                    <Label Content="Преференция" FontWeight="bold" Margin="0" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Padding="5,0"/>

                    <ComboBox Grid.Row="0"
                                  x:Name="PreferenceFilter"
                                  Grid.Column="1"
                                  ItemsSource="{Binding Source={StaticResource GetPreferencesList}}" 
                                  SelectedIndex="0" HorizontalContentAlignment="Center" Margin="2" />
                </Grid>

                <Grid Visibility="{Binding IsSelected, Converter={StaticResource BooleanToVisibilityConverter}, ElementName=tabItem1}" 
                      Grid.Row="6" Margin="5">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="125" />
                        <ColumnDefinition Width="125"  />
                    </Grid.ColumnDefinitions>

                    <ListBox Padding="5,0,0,0" Grid.Column="0">
                        <TextBlock TextAlignment="Center" HorizontalAlignment="Center">Биоколор I</TextBlock>
                        <RadioButton
                            Name="BioColorIHide"
                            Grid.Column="0"
                            HorizontalAlignment="Center">
                            Скрыть
                        </RadioButton>
                        <RadioButton
                            Name="BioColorIThree"
                            Grid.Column="0"
                            HorizontalAlignment="Center"
                            IsChecked="True">
                            3 цвета
                        </RadioButton>
                        <RadioButton
                            Name="BioColorITwelve"
                            Grid.Column="0"
                            HorizontalAlignment="Center">
                            12 цветов
                        </RadioButton>
                    </ListBox>

                    <ListBox Padding="5,0,0,0" Grid.Column="1" Margin="0,0,10,0">
                        <TextBlock TextAlignment="Center" HorizontalAlignment="Center">Биоколор II</TextBlock>
                        <RadioButton
                            Name="BioColorIIHide"
                            Grid.Column="0"
                            HorizontalAlignment="Center">
                            Скрыть
                        </RadioButton>
                        <RadioButton
                            Name="BioColorIITwelve"
                            Grid.Column="0"
                            HorizontalAlignment="Center"
                            IsChecked="True">
                            3 цвета
                        </RadioButton>
                        <RadioButton
                            Name="BioColorIIPictures"
                            Grid.Column="0"
                            HorizontalAlignment="Center">
                            Картинки
                        </RadioButton>
                    </ListBox>
                </Grid>

                <Grid Grid.Row="8" Margin="5,5,5,-27">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition/>
                    </Grid.RowDefinitions>

                    <Grid.ColumnDefinitions>
                        <ColumnDefinition />
                        <ColumnDefinition />
                    </Grid.ColumnDefinitions>

                    <Button Grid.Row="0"
                                Grid.Column="0"
                                Margin="2"
                                Click="ClearFilterPeopleTab"
                                Content="Сбосить фильтр" Padding="0" 
                                Visibility="{Binding IsSelected, Converter={StaticResource BooleanToVisibilityConverter}, ElementName=tabItem}"/>
                    <Button Grid.Row="0"
                                Grid.Column="0"
                                Margin="2"
                                Click="ClearFilterPreferenceTab"
                                Content="Сбосить фильтр" Padding="0" 
                                Visibility="{Binding IsSelected, Converter={StaticResource BooleanToVisibilityConverter}, ElementName=tabItem1}"/>
                    <Button Grid.Row="0"
                                Grid.Column="0"
                                Margin="2"
                                Click="ClearFilterSubjFeelTab"
                                Content="Сбосить фильтр" Padding="0" 
                                Visibility="{Binding IsSelected, Converter={StaticResource BooleanToVisibilityConverter}, ElementName=tabItem2}"/>
                    <Button Grid.Row="0"
                        Grid.Column="1"
                        Margin="2"
                        Click="FilterPeople"
                        Visibility="{Binding IsSelected, Converter={StaticResource BooleanToVisibilityConverter}, ElementName=tabItem}"
                        Content="Применить фильтр" Padding="0" />
                    <Button Grid.Row="0"
                        Grid.Column="1"
                        Margin="2"
                        Click="FilterPreference"
                        Visibility="{Binding IsSelected, Converter={StaticResource BooleanToVisibilityConverter}, ElementName=tabItem1}"
                        Content="Применить фильтр" Padding="0" />
                    <Button Grid.Row="0"
                        Grid.Column="1"
                        Margin="2"
                        Click="FilterSubjectiveFeeling"
                        Visibility="{Binding IsSelected, Converter={StaticResource BooleanToVisibilityConverter}, ElementName=tabItem2}"
                        Content="Применить фильтр" Padding="0" />
                    <Button Grid.Row="1"
                            Click="BildChartOnPreference1"
                            Margin="2"
                            Content="Диаграма преф.1" Padding="0" />
                    <Button Grid.Row="1"
                            Click="BildChartOnPreference2"
                            Margin="2"
                            Content="Диаграма преф.2" Padding="0" Grid.Column="1" />
                    <!--<Button Grid.Row="2"
                        Click="AddData_OnClick"
                        Margin="2"
                        Content="Add" Padding="0" Grid.ColumnSpan="2" /> -->
                </Grid>
            </Grid>
        </Grid>

    </Grid>
</Window>
